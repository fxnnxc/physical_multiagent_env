{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1000, "timers": {"learn_time_ms": 72.891, "learn_throughput": 439.013, "update_time_ms": 3.581}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.6731588244438171, "cur_lr": 0.0005, "mean_q": -0.011249728500843048, "min_q": -0.22232632339000702, "max_q": 0.14969155192375183, "mean_td_error": -0.14361770451068878}}, "num_steps_sampled": 1000, "num_steps_trained": 32, "last_target_update_ts": 1000, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-29-49", "timestamp": 1619872189, "time_this_iter_s": 3.9592437744140625, "time_total_s": 3.9592437744140625, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4683b70>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3.9592437744140625, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.466666666666665, "ram_util_percent": 56.73333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 2000, "timers": {"learn_time_ms": 18.276, "learn_throughput": 1750.916, "update_time_ms": 2.272}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.019097954034805298, "cur_lr": 0.0005, "mean_q": 0.3930854797363281, "min_q": 0.23315779864788055, "max_q": 0.48452749848365784, "mean_td_error": 0.02648583985865116}}, "num_steps_sampled": 2000, "num_steps_trained": 8032, "last_target_update_ts": 1504, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-30-03", "timestamp": 1619872203, "time_this_iter_s": 13.350437879562378, "time_total_s": 17.30968165397644, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46438c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f44149710d0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 17.30968165397644, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.700000000000003, "ram_util_percent": 57.66842105263158}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.9985, "episode_reward_min": -1.0, "episode_reward_mean": -0.9997, "episode_len_mean": 593.4, "episodes_this_iter": 5, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.9985}, "policy_reward_mean": {"pol": -0.9997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.5048547730132842, "mean_raw_obs_processing_ms": 1.5069047278938432, "mean_inference_ms": 1.9377372694666959, "mean_action_processing_ms": 0.06704741976571774}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 3000, "timers": {"learn_time_ms": 19.294, "learn_throughput": 1658.506, "update_time_ms": 2.278}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007786917965859175, "cur_lr": 0.0005, "mean_q": 0.30603039264678955, "min_q": 0.1653883159160614, "max_q": 0.3800073564052582, "mean_td_error": -0.009181380271911621}}, "num_steps_sampled": 3000, "num_steps_trained": 16032, "last_target_update_ts": 2512, "num_target_updates": 4}, "done": false, "episodes_total": 5, "training_iteration": 3, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-30-16", "timestamp": 1619872216, "time_this_iter_s": 13.552651643753052, "time_total_s": 30.862333297729492, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643f28>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 30.862333297729492, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.325000000000003, "ram_util_percent": 57.885000000000005}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.9985, "episode_reward_min": -1.0, "episode_reward_mean": -0.99975, "episode_len_mean": 592.8333333333334, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.9985}, "policy_reward_mean": {"pol": -0.99975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [590, 2587, 76, 79, 124, 101], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.5160949249197613, "mean_raw_obs_processing_ms": 1.5200245476651, "mean_inference_ms": 1.9504384449197703, "mean_action_processing_ms": 0.06742084625774909}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4000, "timers": {"learn_time_ms": 16.367, "learn_throughput": 1955.196, "update_time_ms": 2.732}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0035415377933532, "cur_lr": 0.0005, "mean_q": 0.3386528193950653, "min_q": 0.19482693076133728, "max_q": 0.41571420431137085, "mean_td_error": -0.0006415462121367455}}, "num_steps_sampled": 4000, "num_steps_trained": 24032, "last_target_update_ts": 3520, "num_target_updates": 6}, "done": false, "episodes_total": 6, "training_iteration": 4, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-30-30", "timestamp": 1619872230, "time_this_iter_s": 13.38166618347168, "time_total_s": 44.24399948120117, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4615620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46159d8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 44.24399948120117, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.142105263157895, "ram_util_percent": 57.90526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9985357142857143, "episode_len_mean": 711.5714285714286, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9985357142857143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99125, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1424, 2587, 76, 79, 124, 101, 590], "policy_pol_reward": [-0.99125, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.529680779277861, "mean_raw_obs_processing_ms": 1.5326069787180148, "mean_inference_ms": 1.9650490858647724, "mean_action_processing_ms": 0.06784303239620519}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 5000, "timers": {"learn_time_ms": 18.697, "learn_throughput": 1711.483, "update_time_ms": 3.032}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007623250130563974, "cur_lr": 0.0005, "mean_q": 0.2580552101135254, "min_q": 0.03561727702617645, "max_q": 0.37556859850883484, "mean_td_error": 0.01566120982170105}}, "num_steps_sampled": 5000, "num_steps_trained": 32032, "last_target_update_ts": 4528, "num_target_updates": 8}, "done": false, "episodes_total": 7, "training_iteration": 5, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-30-43", "timestamp": 1619872243, "time_this_iter_s": 13.469885349273682, "time_total_s": 57.71388483047485, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 57.71388483047485, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.421052631578945, "ram_util_percent": 57.89473684210526}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.99871875, "episode_len_mean": 689.0, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.99871875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125], "episode_lengths": [531, 2587, 76, 79, 124, 101, 590, 1424], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125]}, "sampler_perf": {"mean_env_wait_ms": 1.5424787426880116, "mean_raw_obs_processing_ms": 1.5468223800451888, "mean_inference_ms": 1.9794165890265871, "mean_action_processing_ms": 0.06824467410247978}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 6000, "timers": {"learn_time_ms": 18.003, "learn_throughput": 1777.45, "update_time_ms": 2.608}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.012190666049718857, "cur_lr": 0.0005, "mean_q": 0.2651386559009552, "min_q": 0.0024180859327316284, "max_q": 0.3624943196773529, "mean_td_error": 0.04799830913543701}}, "num_steps_sampled": 6000, "num_steps_trained": 40032, "last_target_update_ts": 5536, "num_target_updates": 10}, "done": false, "episodes_total": 8, "training_iteration": 6, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-30-57", "timestamp": 1619872257, "time_this_iter_s": 13.628178596496582, "time_total_s": 71.34206342697144, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 71.34206342697144, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.65263157894737, "ram_util_percent": 57.968421052631584}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9988611111111112, "episode_len_mean": 728.1111111111111, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9988611111111112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0], "episode_lengths": [1041, 2587, 76, 79, 124, 101, 590, 1424, 531], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.5544661924761622, "mean_raw_obs_processing_ms": 1.5603676576868901, "mean_inference_ms": 1.9931861986919996, "mean_action_processing_ms": 0.06863364724349505}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 7000, "timers": {"learn_time_ms": 20.798, "learn_throughput": 1538.594, "update_time_ms": 2.452}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004113480448722839, "cur_lr": 0.0005, "mean_q": 0.3045180141925812, "min_q": -0.051120005548000336, "max_q": 0.353396475315094, "mean_td_error": 0.026423413306474686}}, "num_steps_sampled": 7000, "num_steps_trained": 48032, "last_target_update_ts": 6544, "num_target_updates": 12}, "done": false, "episodes_total": 9, "training_iteration": 7, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-31-10", "timestamp": 1619872270, "time_this_iter_s": 13.399404287338257, "time_total_s": 84.74146771430969, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a9d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f44a4aec6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 84.74146771430969, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.375000000000004, "ram_util_percent": 57.85}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991458333333334, "episode_len_mean": 628.9166666666666, "episodes_this_iter": 3, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991458333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0], "episode_lengths": [835, 137, 22, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.5830034820376406, "mean_raw_obs_processing_ms": 1.5924067364015428, "mean_inference_ms": 2.026437389930963, "mean_action_processing_ms": 0.0695924177181051}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 8000, "timers": {"learn_time_ms": 17.445, "learn_throughput": 1834.305, "update_time_ms": 2.119}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019811319652944803, "cur_lr": 0.0005, "mean_q": 0.3344062566757202, "min_q": 0.19281524419784546, "max_q": 0.38522201776504517, "mean_td_error": -0.009103359654545784}}, "num_steps_sampled": 8000, "num_steps_trained": 56032, "last_target_update_ts": 7552, "num_target_updates": 14}, "done": false, "episodes_total": 12, "training_iteration": 8, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-31-24", "timestamp": 1619872284, "time_this_iter_s": 13.672457695007324, "time_total_s": 98.41392540931702, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 98.41392540931702, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 57.968421052631584}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991458333333334, "episode_len_mean": 628.9166666666666, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991458333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.5830034820376404, "mean_raw_obs_processing_ms": 1.5924067364015426, "mean_inference_ms": 2.026437389930963, "mean_action_processing_ms": 0.06959241771810509}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 9000, "timers": {"learn_time_ms": 18.663, "learn_throughput": 1714.655, "update_time_ms": 2.388}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002978962380439043, "cur_lr": 0.0005, "mean_q": 0.2893780767917633, "min_q": 0.1443813443183899, "max_q": 0.3444806933403015, "mean_td_error": -0.009950550273060799}}, "num_steps_sampled": 9000, "num_steps_trained": 64032, "last_target_update_ts": 8560, "num_target_updates": 16}, "done": false, "episodes_total": 12, "training_iteration": 9, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-31-38", "timestamp": 1619872298, "time_this_iter_s": 13.54967212677002, "time_total_s": 111.96359753608704, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 111.96359753608704, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.847368421052632, "ram_util_percent": 57.90526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9990384615384615, "episode_len_mean": 692.3846153846154, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9990384615384615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99775, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1454, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22], "policy_pol_reward": [-0.99775, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.590581838152977, "mean_raw_obs_processing_ms": 1.602462905982363, "mean_inference_ms": 2.0357562072985007, "mean_action_processing_ms": 0.06989939412819292}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 10000, "timers": {"learn_time_ms": 18.544, "learn_throughput": 1725.605, "update_time_ms": 2.177}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002868863521143794, "cur_lr": 0.0005, "mean_q": 0.28939688205718994, "min_q": 0.10659217089414597, "max_q": 0.3515002727508545, "mean_td_error": -0.01511300727725029}}, "num_steps_sampled": 10000, "num_steps_trained": 72032, "last_target_update_ts": 9568, "num_target_updates": 18}, "done": false, "episodes_total": 13, "training_iteration": 10, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-31-51", "timestamp": 1619872311, "time_this_iter_s": 13.505809307098389, "time_total_s": 125.46940684318542, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a8d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a86a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 125.46940684318542, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.349999999999998, "ram_util_percent": 57.86500000000001}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991071428571429, "episode_len_mean": 746.2142857142857, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991071428571429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775], "episode_lengths": [1446, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775]}, "sampler_perf": {"mean_env_wait_ms": 1.5970623843516822, "mean_raw_obs_processing_ms": 1.611601889237352, "mean_inference_ms": 2.043711430002101, "mean_action_processing_ms": 0.07015794397680872}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 11000, "timers": {"learn_time_ms": 18.347, "learn_throughput": 1744.159, "update_time_ms": 2.341}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004344073589891195, "cur_lr": 0.0005, "mean_q": 0.26862633228302, "min_q": 0.09197433292865753, "max_q": 0.3758085072040558, "mean_td_error": -0.021254947409033775}}, "num_steps_sampled": 11000, "num_steps_trained": 80032, "last_target_update_ts": 10576, "num_target_updates": 20}, "done": false, "episodes_total": 14, "training_iteration": 11, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-32-04", "timestamp": 1619872324, "time_this_iter_s": 13.009385824203491, "time_total_s": 138.47879266738892, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 138.47879266738892, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.944444444444443, "ram_util_percent": 57.900000000000006}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991666666666668, "episode_len_mean": 757.5333333333333, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0], "episode_lengths": [916, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6027816948521978, "mean_raw_obs_processing_ms": 1.6174090215521209, "mean_inference_ms": 2.0507100079572402, "mean_action_processing_ms": 0.07037445079465197}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"learn_time_ms": 17.062, "learn_throughput": 1875.458, "update_time_ms": 2.382}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005714920815080404, "cur_lr": 0.0005, "mean_q": 0.24307994544506073, "min_q": 0.05676876753568649, "max_q": 0.3151112198829651, "mean_td_error": 0.011160876601934433}}, "num_steps_sampled": 12000, "num_steps_trained": 88032, "last_target_update_ts": 11584, "num_target_updates": 22}, "done": false, "episodes_total": 15, "training_iteration": 12, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-32-17", "timestamp": 1619872337, "time_this_iter_s": 12.383244037628174, "time_total_s": 150.8620367050171, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46439d8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 150.8620367050171, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.37222222222222, "ram_util_percent": 57.900000000000006}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991666666666668, "episode_len_mean": 757.5333333333333, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6027816948521978, "mean_raw_obs_processing_ms": 1.6174090215521209, "mean_inference_ms": 2.0507100079572402, "mean_action_processing_ms": 0.07037445079465197}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 13000, "timers": {"learn_time_ms": 17.648, "learn_throughput": 1813.263, "update_time_ms": 2.291}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007116588763892651, "cur_lr": 0.0005, "mean_q": 0.26072654128074646, "min_q": 0.09510409832000732, "max_q": 0.3185745179653168, "mean_td_error": 0.07497835159301758}}, "num_steps_sampled": 13000, "num_steps_trained": 96032, "last_target_update_ts": 12592, "num_target_updates": 24}, "done": false, "episodes_total": 15, "training_iteration": 13, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-32-30", "timestamp": 1619872350, "time_this_iter_s": 12.874639749526978, "time_total_s": 163.73667645454407, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ea0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 163.73667645454407, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.93888888888889, "ram_util_percent": 57.97222222222222}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9991666666666668, "episode_len_mean": 757.5333333333333, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9991666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6027816948521978, "mean_raw_obs_processing_ms": 1.6174090215521209, "mean_inference_ms": 2.0507100079572402, "mean_action_processing_ms": 0.07037445079465197}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 14000, "timers": {"learn_time_ms": 18.333, "learn_throughput": 1745.468, "update_time_ms": 2.311}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0030738599598407745, "cur_lr": 0.0005, "mean_q": 0.25118470191955566, "min_q": -0.04882335662841797, "max_q": 0.3137577772140503, "mean_td_error": 0.02297251485288143}}, "num_steps_sampled": 14000, "num_steps_trained": 104032, "last_target_update_ts": 13600, "num_target_updates": 26}, "done": false, "episodes_total": 15, "training_iteration": 14, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-32-42", "timestamp": 1619872362, "time_this_iter_s": 12.624890565872192, "time_total_s": 176.36156702041626, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 176.36156702041626, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.93888888888889, "ram_util_percent": 57.92222222222222}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9988382352941175, "episode_len_mean": 877.8235294117648, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9988382352941175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99275, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0], "episode_lengths": [3345, 215, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916], "policy_pol_reward": [-0.99275, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6115381326358482, "mean_raw_obs_processing_ms": 1.623731993980511, "mean_inference_ms": 2.0604071968029345, "mean_action_processing_ms": 0.07065032144684447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 15000, "timers": {"learn_time_ms": 18.337, "learn_throughput": 1745.07, "update_time_ms": 2.261}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0038156379014253616, "cur_lr": 0.0005, "mean_q": 0.24612930417060852, "min_q": 0.030546076595783234, "max_q": 0.36928266286849976, "mean_td_error": 0.029576679691672325}}, "num_steps_sampled": 15000, "num_steps_trained": 112032, "last_target_update_ts": 14608, "num_target_updates": 28}, "done": false, "episodes_total": 17, "training_iteration": 15, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-32-54", "timestamp": 1619872374, "time_this_iter_s": 11.49065613746643, "time_total_s": 187.8522231578827, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 187.8522231578827, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.01764705882353, "ram_util_percent": 57.94117647058823}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9988382352941175, "episode_len_mean": 877.8235294117648, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9988382352941175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6115381326358484, "mean_raw_obs_processing_ms": 1.623731993980511, "mean_inference_ms": 2.060407196802934, "mean_action_processing_ms": 0.07065032144684447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timers": {"learn_time_ms": 17.475, "learn_throughput": 1831.221, "update_time_ms": 2.443}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005321251228451729, "cur_lr": 0.0005, "mean_q": 0.2619383931159973, "min_q": 0.09733788669109344, "max_q": 0.3191874623298645, "mean_td_error": 0.016888223588466644}}, "num_steps_sampled": 16000, "num_steps_trained": 120032, "last_target_update_ts": 15616, "num_target_updates": 30}, "done": false, "episodes_total": 17, "training_iteration": 16, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-33-06", "timestamp": 1619872386, "time_this_iter_s": 12.54858660697937, "time_total_s": 200.40080976486206, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b56a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 200.40080976486206, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.805555555555557, "ram_util_percent": 57.888888888888886}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9988382352941175, "episode_len_mean": 877.8235294117648, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9988382352941175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6115381326358484, "mean_raw_obs_processing_ms": 1.623731993980511, "mean_inference_ms": 2.060407196802934, "mean_action_processing_ms": 0.07065032144684447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 17000, "timers": {"learn_time_ms": 15.683, "learn_throughput": 2040.416, "update_time_ms": 2.256}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018988404190167785, "cur_lr": 0.0005, "mean_q": 0.258232057094574, "min_q": 0.030000798404216766, "max_q": 0.31884437799453735, "mean_td_error": -0.0010074246674776077}}, "num_steps_sampled": 17000, "num_steps_trained": 128032, "last_target_update_ts": 16624, "num_target_updates": 32}, "done": false, "episodes_total": 17, "training_iteration": 17, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-33-19", "timestamp": 1619872399, "time_this_iter_s": 12.394995212554932, "time_total_s": 212.795804977417, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5f28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b36a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 212.795804977417, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.444444444444443, "ram_util_percent": 57.99444444444444}, "trial_id": "dfed9_00000"}
{"episode_reward_max": -0.99125, "episode_reward_min": -1.0, "episode_reward_mean": -0.9988382352941175, "episode_len_mean": 877.8235294117648, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": -0.99125}, "policy_reward_mean": {"pol": -0.9988382352941175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6115381326358484, "mean_raw_obs_processing_ms": 1.623731993980511, "mean_inference_ms": 2.060407196802934, "mean_action_processing_ms": 0.07065032144684447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 18000, "timers": {"learn_time_ms": 17.46, "learn_throughput": 1832.747, "update_time_ms": 2.186}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004466048441827297, "cur_lr": 0.0005, "mean_q": 0.23070433735847473, "min_q": 0.12170624732971191, "max_q": 0.27791738510131836, "mean_td_error": 0.03450465574860573}}, "num_steps_sampled": 18000, "num_steps_trained": 136032, "last_target_update_ts": 17632, "num_target_updates": 34}, "done": false, "episodes_total": 17, "training_iteration": 18, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-33-31", "timestamp": 1619872411, "time_this_iter_s": 12.381603479385376, "time_total_s": 225.17740845680237, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643a60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643950>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 225.17740845680237, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.052941176470586, "ram_util_percent": 57.87647058823529}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9429166666666666, "episode_len_mean": 1051.388888888889, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9429166666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007750000000000005, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215], "policy_pol_reward": [0.007750000000000005, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.615240976231068, "mean_raw_obs_processing_ms": 1.6249620514513825, "mean_inference_ms": 2.0641665889088716, "mean_action_processing_ms": 0.07075818001611439}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 19000, "timers": {"learn_time_ms": 19.843, "learn_throughput": 1612.676, "update_time_ms": 3.16}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0035538130905479193, "cur_lr": 0.0005, "mean_q": 0.23360860347747803, "min_q": 0.009691819548606873, "max_q": 0.3182356059551239, "mean_td_error": 0.02443360723555088}}, "num_steps_sampled": 19000, "num_steps_trained": 144032, "last_target_update_ts": 18640, "num_target_updates": 36}, "done": false, "episodes_total": 18, "training_iteration": 19, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-33-45", "timestamp": 1619872425, "time_this_iter_s": 13.31047248840332, "time_total_s": 238.4878809452057, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b3950>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 238.4878809452057, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.057894736842105, "ram_util_percent": 57.96315789473684}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9429166666666665, "episode_len_mean": 1051.388888888889, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9429166666666665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005]}, "sampler_perf": {"mean_env_wait_ms": 1.6152409762310682, "mean_raw_obs_processing_ms": 1.6249620514513827, "mean_inference_ms": 2.064166588908871, "mean_action_processing_ms": 0.07075818001611439}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20000, "timers": {"learn_time_ms": 18.705, "learn_throughput": 1710.802, "update_time_ms": 2.46}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004664133302867413, "cur_lr": 0.0005, "mean_q": 0.22609542310237885, "min_q": -1.4394521713256836e-05, "max_q": 0.31693947315216064, "mean_td_error": 0.02516717091202736}}, "num_steps_sampled": 20000, "num_steps_trained": 152032, "last_target_update_ts": 19648, "num_target_updates": 38}, "done": false, "episodes_total": 18, "training_iteration": 20, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-33-57", "timestamp": 1619872437, "time_this_iter_s": 12.84810733795166, "time_total_s": 251.33598828315735, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149710d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a46a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 251.33598828315735, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.752631578947373, "ram_util_percent": 57.89473684210526}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.945921052631579, "episode_len_mean": 1061.6315789473683, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.945921052631579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005], "episode_lengths": [1246, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005]}, "sampler_perf": {"mean_env_wait_ms": 1.6186938888871178, "mean_raw_obs_processing_ms": 1.6255657397397811, "mean_inference_ms": 2.067581456024329, "mean_action_processing_ms": 0.07085330064651614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 21000, "timers": {"learn_time_ms": 18.429, "learn_throughput": 1736.415, "update_time_ms": 2.252}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019578917417675257, "cur_lr": 0.0005, "mean_q": 0.21843330562114716, "min_q": 0.12352533638477325, "max_q": 0.309861421585083, "mean_td_error": 0.023783814162015915}}, "num_steps_sampled": 21000, "num_steps_trained": 160032, "last_target_update_ts": 20656, "num_target_updates": 40}, "done": false, "episodes_total": 19, "training_iteration": 21, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-34-10", "timestamp": 1619872450, "time_this_iter_s": 12.645073413848877, "time_total_s": 263.9810616970062, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 263.9810616970062, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 22.62222222222222, "ram_util_percent": 58.00555555555555}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9459210526315788, "episode_len_mean": 1061.6315789473683, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9459210526315788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6186938888871178, "mean_raw_obs_processing_ms": 1.6255657397397811, "mean_inference_ms": 2.0675814560243286, "mean_action_processing_ms": 0.07085330064651614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 22000, "timers": {"learn_time_ms": 18.494, "learn_throughput": 1730.286, "update_time_ms": 2.865}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0025520548224449158, "cur_lr": 0.0005, "mean_q": 0.196165531873703, "min_q": -0.22050181031227112, "max_q": 0.3148023784160614, "mean_td_error": -0.005883295089006424}}, "num_steps_sampled": 22000, "num_steps_trained": 168032, "last_target_update_ts": 21664, "num_target_updates": 42}, "done": false, "episodes_total": 19, "training_iteration": 22, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-34-22", "timestamp": 1619872462, "time_this_iter_s": 12.121630907058716, "time_total_s": 276.10269260406494, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a4d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a4048>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 276.10269260406494, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.941176470588236, "ram_util_percent": 57.98823529411764}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9459210526315788, "episode_len_mean": 1061.6315789473683, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9459210526315788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6186938888871178, "mean_raw_obs_processing_ms": 1.6255657397397811, "mean_inference_ms": 2.0675814560243286, "mean_action_processing_ms": 0.07085330064651614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 23000, "timers": {"learn_time_ms": 18.191, "learn_throughput": 1759.132, "update_time_ms": 2.323}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013949989806860685, "cur_lr": 0.0005, "mean_q": 0.2116757333278656, "min_q": 0.0635494664311409, "max_q": 0.3077733814716339, "mean_td_error": 0.00011213356629014015}}, "num_steps_sampled": 23000, "num_steps_trained": 176032, "last_target_update_ts": 22672, "num_target_updates": 44}, "done": false, "episodes_total": 19, "training_iteration": 23, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-34-35", "timestamp": 1619872475, "time_this_iter_s": 12.560037851333618, "time_total_s": 288.66273045539856, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 288.66273045539856, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.31111111111111, "ram_util_percent": 57.92777777777778}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9459210526315788, "episode_len_mean": 1061.6315789473683, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9459210526315788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6186938888871178, "mean_raw_obs_processing_ms": 1.6255657397397811, "mean_inference_ms": 2.0675814560243286, "mean_action_processing_ms": 0.07085330064651614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"learn_time_ms": 18.05, "learn_throughput": 1772.829, "update_time_ms": 2.509}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013705859892070293, "cur_lr": 0.0005, "mean_q": 0.20569643378257751, "min_q": 0.03798943758010864, "max_q": 0.30869513750076294, "mean_td_error": -0.0010537505149841309}}, "num_steps_sampled": 24000, "num_steps_trained": 184032, "last_target_update_ts": 23680, "num_target_updates": 46}, "done": false, "episodes_total": 19, "training_iteration": 24, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-34-48", "timestamp": 1619872488, "time_this_iter_s": 12.783401489257812, "time_total_s": 301.4461319446564, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46436a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643b70>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 301.4461319446564, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.90555555555555, "ram_util_percent": 58.03333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9484124999999999, "episode_len_mean": 1203.55, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9484124999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99575, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0], "episode_lengths": [3900, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246], "policy_pol_reward": [-0.99575, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.62187011452134, "mean_raw_obs_processing_ms": 1.624992131765491, "mean_inference_ms": 2.0707938346109858, "mean_action_processing_ms": 0.07093710369557328}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 25000, "timers": {"learn_time_ms": 17.904, "learn_throughput": 1787.356, "update_time_ms": 2.558}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0026847869157791138, "cur_lr": 0.0005, "mean_q": 0.2001011073589325, "min_q": -0.15054917335510254, "max_q": 0.27717792987823486, "mean_td_error": -0.013381678611040115}}, "num_steps_sampled": 25000, "num_steps_trained": 192032, "last_target_update_ts": 24688, "num_target_updates": 48}, "done": false, "episodes_total": 20, "training_iteration": 25, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-35-01", "timestamp": 1619872501, "time_this_iter_s": 12.849233388900757, "time_total_s": 314.29536533355713, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 314.29536533355713, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 57.915789473684214}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9484124999999999, "episode_len_mean": 1203.55, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9484124999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.62187011452134, "mean_raw_obs_processing_ms": 1.6249921317654912, "mean_inference_ms": 2.0707938346109858, "mean_action_processing_ms": 0.0709371036955733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 26000, "timers": {"learn_time_ms": 19.812, "learn_throughput": 1615.166, "update_time_ms": 2.257}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.000996913411654532, "cur_lr": 0.0005, "mean_q": 0.20560811460018158, "min_q": 0.10111444443464279, "max_q": 0.2955559194087982, "mean_td_error": -0.003617561422288418}}, "num_steps_sampled": 26000, "num_steps_trained": 200032, "last_target_update_ts": 25696, "num_target_updates": 50}, "done": false, "episodes_total": 20, "training_iteration": 26, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-35-13", "timestamp": 1619872513, "time_this_iter_s": 12.31816577911377, "time_total_s": 326.6135311126709, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149710d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 326.6135311126709, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.435294117647057, "ram_util_percent": 58.04117647058824}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9484124999999999, "episode_len_mean": 1203.55, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9484124999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.62187011452134, "mean_raw_obs_processing_ms": 1.6249921317654912, "mean_inference_ms": 2.0707938346109858, "mean_action_processing_ms": 0.0709371036955733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 27000, "timers": {"learn_time_ms": 18.139, "learn_throughput": 1764.152, "update_time_ms": 2.184}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002734046895056963, "cur_lr": 0.0005, "mean_q": 0.20840084552764893, "min_q": 0.012372791767120361, "max_q": 0.28212496638298035, "mean_td_error": 0.0015370941255241632}}, "num_steps_sampled": 27000, "num_steps_trained": 208032, "last_target_update_ts": 26704, "num_target_updates": 52}, "done": false, "episodes_total": 20, "training_iteration": 27, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-35-26", "timestamp": 1619872526, "time_this_iter_s": 12.505881309509277, "time_total_s": 339.1194124221802, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 339.1194124221802, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.12222222222222, "ram_util_percent": 57.90555555555555}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9484124999999999, "episode_len_mean": 1203.55, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9484124999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.62187011452134, "mean_raw_obs_processing_ms": 1.6249921317654912, "mean_inference_ms": 2.0707938346109858, "mean_action_processing_ms": 0.0709371036955733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28000, "timers": {"learn_time_ms": 18.403, "learn_throughput": 1738.891, "update_time_ms": 2.331}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036121413577347994, "cur_lr": 0.0005, "mean_q": 0.18518829345703125, "min_q": -0.007677525281906128, "max_q": 0.2567268908023834, "mean_td_error": 0.01788688264787197}}, "num_steps_sampled": 28000, "num_steps_trained": 216032, "last_target_update_ts": 27712, "num_target_updates": 54}, "done": false, "episodes_total": 20, "training_iteration": 28, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-35-38", "timestamp": 1619872538, "time_this_iter_s": 12.621408700942993, "time_total_s": 351.74082112312317, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b16a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 351.74082112312317, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.116666666666667, "ram_util_percent": 58.016666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9075454545454545, "episode_len_mean": 1293.909090909091, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9075454545454545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0022500000000000003, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575], "episode_lengths": [4002, 393, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900], "policy_pol_reward": [0.0022500000000000003, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.6279284531233522, "mean_raw_obs_processing_ms": 1.6217500246868943, "mean_inference_ms": 2.076706031390116, "mean_action_processing_ms": 0.07109019745907616}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 29000, "timers": {"learn_time_ms": 19.017, "learn_throughput": 1682.667, "update_time_ms": 2.48}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005802221596240997, "cur_lr": 0.0005, "mean_q": 0.2044457495212555, "min_q": -0.08060041069984436, "max_q": 0.30429160594940186, "mean_td_error": 0.009536984376609325}}, "num_steps_sampled": 29000, "num_steps_trained": 224032, "last_target_update_ts": 28720, "num_target_updates": 56}, "done": false, "episodes_total": 22, "training_iteration": 29, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-35-52", "timestamp": 1619872552, "time_this_iter_s": 13.277163028717041, "time_total_s": 365.0179841518402, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 365.0179841518402, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.38947368421053, "ram_util_percent": 57.93684210526315}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9075454545454544, "episode_len_mean": 1293.909090909091, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9075454545454544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6279284531233527, "mean_raw_obs_processing_ms": 1.6217500246868943, "mean_inference_ms": 2.0767060313901156, "mean_action_processing_ms": 0.07109019745907616}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 30000, "timers": {"learn_time_ms": 16.029, "learn_throughput": 1996.414, "update_time_ms": 2.227}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0008740846533328295, "cur_lr": 0.0005, "mean_q": 0.22179949283599854, "min_q": 0.184209406375885, "max_q": 0.28928419947624207, "mean_td_error": 0.002406919375061989}}, "num_steps_sampled": 30000, "num_steps_trained": 232032, "last_target_update_ts": 29728, "num_target_updates": 58}, "done": false, "episodes_total": 22, "training_iteration": 30, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-36-05", "timestamp": 1619872565, "time_this_iter_s": 12.994024515151978, "time_total_s": 378.0120086669922, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46437b8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 378.0120086669922, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.089473684210525, "ram_util_percent": 57.978947368421046}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9075454545454544, "episode_len_mean": 1293.909090909091, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9075454545454544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6279284531233527, "mean_raw_obs_processing_ms": 1.6217500246868943, "mean_inference_ms": 2.0767060313901156, "mean_action_processing_ms": 0.07109019745907616}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 31000, "timers": {"learn_time_ms": 18.763, "learn_throughput": 1705.441, "update_time_ms": 2.276}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0035589446779340506, "cur_lr": 0.0005, "mean_q": 0.18905168771743774, "min_q": -0.19304834306240082, "max_q": 0.2763001620769501, "mean_td_error": 0.008617263287305832}}, "num_steps_sampled": 31000, "num_steps_trained": 240032, "last_target_update_ts": 30736, "num_target_updates": 60}, "done": false, "episodes_total": 22, "training_iteration": 31, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-36-18", "timestamp": 1619872578, "time_this_iter_s": 13.102693557739258, "time_total_s": 391.11470222473145, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ea0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 391.11470222473145, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.18421052631579, "ram_util_percent": 58.021052631578954}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.9075454545454544, "episode_len_mean": 1293.909090909091, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.9075454545454544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6279284531233527, "mean_raw_obs_processing_ms": 1.6217500246868943, "mean_inference_ms": 2.0767060313901156, "mean_action_processing_ms": 0.07109019745907616}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timers": {"learn_time_ms": 14.265, "learn_throughput": 2243.273, "update_time_ms": 2.35}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004960357677191496, "cur_lr": 0.0005, "mean_q": 0.19628459215164185, "min_q": -0.09183216840028763, "max_q": 0.2436905950307846, "mean_td_error": 0.031177114695310593}}, "num_steps_sampled": 32000, "num_steps_trained": 248032, "last_target_update_ts": 31744, "num_target_updates": 62}, "done": false, "episodes_total": 22, "training_iteration": 32, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-36-31", "timestamp": 1619872591, "time_this_iter_s": 12.650996685028076, "time_total_s": 403.7656989097595, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149710d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 403.7656989097595, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.944444444444443, "ram_util_percent": 57.92222222222222}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8680217391304348, "episode_len_mean": 1411.6521739130435, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8680217391304348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0015, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393], "policy_pol_reward": [0.0015, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6309103449205542, "mean_raw_obs_processing_ms": 1.619426011400824, "mean_inference_ms": 2.0797951788225677, "mean_action_processing_ms": 0.07117335123738204}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 33000, "timers": {"learn_time_ms": 20.17, "learn_throughput": 1586.547, "update_time_ms": 2.434}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0031467522494494915, "cur_lr": 0.0005, "mean_q": 0.20392075181007385, "min_q": 0.029105380177497864, "max_q": 0.25040873885154724, "mean_td_error": -0.009081616997718811}}, "num_steps_sampled": 33000, "num_steps_trained": 256032, "last_target_update_ts": 32752, "num_target_updates": 64}, "done": false, "episodes_total": 23, "training_iteration": 33, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-36-43", "timestamp": 1619872603, "time_this_iter_s": 12.814432621002197, "time_total_s": 416.5801315307617, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 416.5801315307617, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.96666666666667, "ram_util_percent": 58.04999999999999}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8680217391304347, "episode_len_mean": 1411.6521739130435, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8680217391304347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015]}, "sampler_perf": {"mean_env_wait_ms": 1.6309103449205546, "mean_raw_obs_processing_ms": 1.619426011400824, "mean_inference_ms": 2.0797951788225677, "mean_action_processing_ms": 0.07117335123738204}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 34000, "timers": {"learn_time_ms": 19.863, "learn_throughput": 1611.07, "update_time_ms": 2.36}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0051215034909546375, "cur_lr": 0.0005, "mean_q": 0.1982302963733673, "min_q": -0.01551588624715805, "max_q": 0.30095428228378296, "mean_td_error": 0.02988394722342491}}, "num_steps_sampled": 34000, "num_steps_trained": 264032, "last_target_update_ts": 33760, "num_target_updates": 66}, "done": false, "episodes_total": 23, "training_iteration": 34, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-36-56", "timestamp": 1619872616, "time_this_iter_s": 12.501510858535767, "time_total_s": 429.0816423892975, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b16a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 429.0816423892975, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.311111111111114, "ram_util_percent": 58.03333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8832211538461537, "episode_len_mean": 1321.6153846153845, "episodes_this_iter": 3, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8832211538461537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015], "episode_lengths": [1625, 211, 58, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002], "policy_pol_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015]}, "sampler_perf": {"mean_env_wait_ms": 1.638372199157902, "mean_raw_obs_processing_ms": 1.6131455905205578, "mean_inference_ms": 2.0876131214729523, "mean_action_processing_ms": 0.07137940185447303}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 35000, "timers": {"learn_time_ms": 17.728, "learn_throughput": 1805.035, "update_time_ms": 2.591}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0025008278898894787, "cur_lr": 0.0005, "mean_q": 0.20337778329849243, "min_q": 0.16317406296730042, "max_q": 0.26874274015426636, "mean_td_error": 0.004178786650300026}}, "num_steps_sampled": 35000, "num_steps_trained": 272032, "last_target_update_ts": 34768, "num_target_updates": 68}, "done": false, "episodes_total": 26, "training_iteration": 35, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-37-09", "timestamp": 1619872629, "time_this_iter_s": 13.100195407867432, "time_total_s": 442.1818377971649, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4474d06378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 442.1818377971649, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.231578947368423, "ram_util_percent": 57.95263157894736}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8832211538461539, "episode_len_mean": 1321.6153846153845, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8832211538461539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925]}, "sampler_perf": {"mean_env_wait_ms": 1.638372199157902, "mean_raw_obs_processing_ms": 1.6131455905205583, "mean_inference_ms": 2.0876131214729523, "mean_action_processing_ms": 0.07137940185447303}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"learn_time_ms": 18.365, "learn_throughput": 1742.418, "update_time_ms": 2.345}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007549474947154522, "cur_lr": 0.0005, "mean_q": 0.20557036995887756, "min_q": 0.17058008909225464, "max_q": 0.28632688522338867, "mean_td_error": 0.044338591396808624}}, "num_steps_sampled": 36000, "num_steps_trained": 280032, "last_target_update_ts": 35776, "num_target_updates": 70}, "done": false, "episodes_total": 26, "training_iteration": 36, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-37-22", "timestamp": 1619872642, "time_this_iter_s": 13.138118982315063, "time_total_s": 455.31995677948, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 455.31995677948, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.377777777777776, "ram_util_percent": 57.99444444444444}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8874907407407407, "episode_len_mean": 1356.888888888889, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8874907407407407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925], "episode_lengths": [2274, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58], "policy_pol_reward": [-0.9985, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925]}, "sampler_perf": {"mean_env_wait_ms": 1.6405242499585118, "mean_raw_obs_processing_ms": 1.61132924632232, "mean_inference_ms": 2.0898988815892308, "mean_action_processing_ms": 0.07144274213976677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 37000, "timers": {"learn_time_ms": 18.54, "learn_throughput": 1726.018, "update_time_ms": 2.201}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004295122344046831, "cur_lr": 0.0005, "mean_q": 0.17937977612018585, "min_q": -0.024023965001106262, "max_q": 0.24064455926418304, "mean_td_error": -0.01095045916736126}}, "num_steps_sampled": 37000, "num_steps_trained": 288032, "last_target_update_ts": 36784, "num_target_updates": 72}, "done": false, "episodes_total": 27, "training_iteration": 37, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-37-35", "timestamp": 1619872655, "time_this_iter_s": 12.773661375045776, "time_total_s": 468.09361815452576, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 468.09361815452576, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 22.30526315789474, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8874907407407407, "episode_len_mean": 1356.888888888889, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8874907407407407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985]}, "sampler_perf": {"mean_env_wait_ms": 1.6405242499585115, "mean_raw_obs_processing_ms": 1.61132924632232, "mean_inference_ms": 2.089898881589231, "mean_action_processing_ms": 0.07144274213976677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 38000, "timers": {"learn_time_ms": 16.979, "learn_throughput": 1884.678, "update_time_ms": 2.299}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005330907646566629, "cur_lr": 0.0005, "mean_q": 0.1689358502626419, "min_q": -0.009767293930053711, "max_q": 0.24465312063694, "mean_td_error": -0.017819322645664215}}, "num_steps_sampled": 38000, "num_steps_trained": 296032, "last_target_update_ts": 37792, "num_target_updates": 74}, "done": false, "episodes_total": 27, "training_iteration": 38, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-37-47", "timestamp": 1619872667, "time_this_iter_s": 12.14194107055664, "time_total_s": 480.2355592250824, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149710d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 480.2355592250824, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.07058823529412, "ram_util_percent": 57.976470588235294}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8874907407407407, "episode_len_mean": 1356.888888888889, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8874907407407407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985]}, "sampler_perf": {"mean_env_wait_ms": 1.6405242499585115, "mean_raw_obs_processing_ms": 1.61132924632232, "mean_inference_ms": 2.089898881589231, "mean_action_processing_ms": 0.07144274213976677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 39000, "timers": {"learn_time_ms": 17.098, "learn_throughput": 1871.601, "update_time_ms": 2.334}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002332658041268587, "cur_lr": 0.0005, "mean_q": 0.18157127499580383, "min_q": -0.057026155292987823, "max_q": 0.24380677938461304, "mean_td_error": -0.00922499317675829}}, "num_steps_sampled": 39000, "num_steps_trained": 304032, "last_target_update_ts": 38800, "num_target_updates": 76}, "done": false, "episodes_total": 27, "training_iteration": 39, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-38-00", "timestamp": 1619872680, "time_this_iter_s": 12.797142505645752, "time_total_s": 493.03270173072815, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 493.03270173072815, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.37222222222222, "ram_util_percent": 58.02777777777778}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915089285714286, "episode_len_mean": 1400.8214285714287, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8915089285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985], "episode_lengths": [2587, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985]}, "sampler_perf": {"mean_env_wait_ms": 1.6426101701099685, "mean_raw_obs_processing_ms": 1.6092264971484593, "mean_inference_ms": 2.0920643812307778, "mean_action_processing_ms": 0.0715023796050851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 40000, "timers": {"learn_time_ms": 20.405, "learn_throughput": 1568.226, "update_time_ms": 2.337}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0024364879354834557, "cur_lr": 0.0005, "mean_q": 0.17638057470321655, "min_q": 0.12959758937358856, "max_q": 0.21335408091545105, "mean_td_error": 0.0038662035949528217}}, "num_steps_sampled": 40000, "num_steps_trained": 312032, "last_target_update_ts": 39808, "num_target_updates": 78}, "done": false, "episodes_total": 28, "training_iteration": 40, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-38-14", "timestamp": 1619872694, "time_this_iter_s": 13.277331829071045, "time_total_s": 506.3100335597992, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b16a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 506.3100335597992, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.28421052631579, "ram_util_percent": 58.01578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915089285714286, "episode_len_mean": 1400.8214285714287, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8915089285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.642610170109968, "mean_raw_obs_processing_ms": 1.6092264971484593, "mean_inference_ms": 2.092064381230778, "mean_action_processing_ms": 0.0715023796050851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 41000, "timers": {"learn_time_ms": 18.569, "learn_throughput": 1723.305, "update_time_ms": 2.418}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0012668516719713807, "cur_lr": 0.0005, "mean_q": 0.14621956646442413, "min_q": -0.12952128052711487, "max_q": 0.24658432602882385, "mean_td_error": -0.007814418524503708}}, "num_steps_sampled": 41000, "num_steps_trained": 320032, "last_target_update_ts": 40816, "num_target_updates": 80}, "done": false, "episodes_total": 28, "training_iteration": 41, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-38-27", "timestamp": 1619872707, "time_this_iter_s": 13.49812936782837, "time_total_s": 519.8081629276276, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 519.8081629276276, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.574999999999996, "ram_util_percent": 58.004999999999995}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915089285714286, "episode_len_mean": 1400.8214285714287, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8915089285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.642610170109968, "mean_raw_obs_processing_ms": 1.6092264971484593, "mean_inference_ms": 2.092064381230778, "mean_action_processing_ms": 0.0715023796050851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 42000, "timers": {"learn_time_ms": 19.885, "learn_throughput": 1609.265, "update_time_ms": 2.363}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004382267594337463, "cur_lr": 0.0005, "mean_q": 0.16019773483276367, "min_q": -0.15542298555374146, "max_q": 0.219954714179039, "mean_td_error": 0.013727601617574692}}, "num_steps_sampled": 42000, "num_steps_trained": 328032, "last_target_update_ts": 41824, "num_target_updates": 82}, "done": false, "episodes_total": 28, "training_iteration": 42, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-38-40", "timestamp": 1619872720, "time_this_iter_s": 12.79720687866211, "time_total_s": 532.6053698062897, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 532.6053698062897, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.850000000000005, "ram_util_percent": 57.97222222222222}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915089285714286, "episode_len_mean": 1400.8214285714287, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8915089285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.642610170109968, "mean_raw_obs_processing_ms": 1.6092264971484593, "mean_inference_ms": 2.092064381230778, "mean_action_processing_ms": 0.0715023796050851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 43000, "timers": {"learn_time_ms": 21.064, "learn_throughput": 1519.189, "update_time_ms": 2.663}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002559599233791232, "cur_lr": 0.0005, "mean_q": 0.14405348896980286, "min_q": -0.12580719590187073, "max_q": 0.2305012345314026, "mean_td_error": -0.006264612544327974}}, "num_steps_sampled": 43000, "num_steps_trained": 336032, "last_target_update_ts": 42832, "num_target_updates": 84}, "done": false, "episodes_total": 28, "training_iteration": 43, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-38-53", "timestamp": 1619872733, "time_this_iter_s": 12.852063179016113, "time_total_s": 545.4574329853058, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ea0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 545.4574329853058, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.79444444444444, "ram_util_percent": 57.91111111111112}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8652083333333334, "episode_len_mean": 1457.2, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8652083333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006000000000000004, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0], "episode_lengths": [4002, 491, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587], "policy_pol_reward": [0.006000000000000004, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6464925581056202, "mean_raw_obs_processing_ms": 1.6056635394445251, "mean_inference_ms": 2.0961155508070184, "mean_action_processing_ms": 0.0716186459582166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44000, "timers": {"learn_time_ms": 20.378, "learn_throughput": 1570.338, "update_time_ms": 2.516}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004266215953975916, "cur_lr": 0.0005, "mean_q": 0.12751631438732147, "min_q": -0.16101889312267303, "max_q": 0.20242942869663239, "mean_td_error": -0.025276659056544304}}, "num_steps_sampled": 44000, "num_steps_trained": 344032, "last_target_update_ts": 43840, "num_target_updates": 86}, "done": false, "episodes_total": 30, "training_iteration": 44, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-39-06", "timestamp": 1619872746, "time_this_iter_s": 13.18356442451477, "time_total_s": 558.6409974098206, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149710d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 558.6409974098206, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.447368421052637, "ram_util_percent": 57.99473684210527}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8652083333333334, "episode_len_mean": 1457.2, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8652083333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.64649255810562, "mean_raw_obs_processing_ms": 1.6056635394445251, "mean_inference_ms": 2.096115550807019, "mean_action_processing_ms": 0.0716186459582166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 45000, "timers": {"learn_time_ms": 19.744, "learn_throughput": 1620.762, "update_time_ms": 2.621}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036224948707967997, "cur_lr": 0.0005, "mean_q": 0.15602928400039673, "min_q": -0.10635747015476227, "max_q": 0.21719089150428772, "mean_td_error": 0.02251085266470909}}, "num_steps_sampled": 45000, "num_steps_trained": 352032, "last_target_update_ts": 44848, "num_target_updates": 88}, "done": false, "episodes_total": 30, "training_iteration": 45, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-39-20", "timestamp": 1619872760, "time_this_iter_s": 13.571041107177734, "time_total_s": 572.2120385169983, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 572.2120385169983, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.54, "ram_util_percent": 58.06500000000001}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8695403225806451, "episode_len_mean": 1454.1290322580646, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8695403225806451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9995, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0], "episode_lengths": [1362, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491], "policy_pol_reward": [-0.9995, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.648302961812251, "mean_raw_obs_processing_ms": 1.6040817737424726, "mean_inference_ms": 2.0980459552608797, "mean_action_processing_ms": 0.07168065107005034}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 46000, "timers": {"learn_time_ms": 19.823, "learn_throughput": 1614.255, "update_time_ms": 2.787}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0034076799638569355, "cur_lr": 0.0005, "mean_q": 0.15281996130943298, "min_q": -0.05349196493625641, "max_q": 0.2087590992450714, "mean_td_error": 0.02057972177863121}}, "num_steps_sampled": 46000, "num_steps_trained": 360032, "last_target_update_ts": 45856, "num_target_updates": 90}, "done": false, "episodes_total": 31, "training_iteration": 46, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-39-33", "timestamp": 1619872773, "time_this_iter_s": 13.06752347946167, "time_total_s": 585.27956199646, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465fae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 585.27956199646, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.37777777777778, "ram_util_percent": 57.977777777777774}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8695403225806452, "episode_len_mean": 1454.1290322580646, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8695403225806452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995]}, "sampler_perf": {"mean_env_wait_ms": 1.6483029618122507, "mean_raw_obs_processing_ms": 1.6040817737424726, "mean_inference_ms": 2.0980459552608797, "mean_action_processing_ms": 0.07168065107005034}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 47000, "timers": {"learn_time_ms": 19.736, "learn_throughput": 1621.435, "update_time_ms": 2.42}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0015240367501974106, "cur_lr": 0.0005, "mean_q": 0.15416854619979858, "min_q": -0.03483983129262924, "max_q": 0.2019178569316864, "mean_td_error": -0.007358841132372618}}, "num_steps_sampled": 47000, "num_steps_trained": 368032, "last_target_update_ts": 46864, "num_target_updates": 92}, "done": false, "episodes_total": 31, "training_iteration": 47, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-39-46", "timestamp": 1619872786, "time_this_iter_s": 12.98929500579834, "time_total_s": 598.2688570022583, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 598.2688570022583, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.589473684210525, "ram_util_percent": 58.078947368421055}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8695403225806452, "episode_len_mean": 1454.1290322580646, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8695403225806452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995]}, "sampler_perf": {"mean_env_wait_ms": 1.6483029618122507, "mean_raw_obs_processing_ms": 1.6040817737424726, "mean_inference_ms": 2.0980459552608797, "mean_action_processing_ms": 0.07168065107005034}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"learn_time_ms": 19.804, "learn_throughput": 1615.843, "update_time_ms": 2.508}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002059126505628228, "cur_lr": 0.0005, "mean_q": 0.16625025868415833, "min_q": 0.11915715038776398, "max_q": 0.1893903911113739, "mean_td_error": -0.005393706727772951}}, "num_steps_sampled": 48000, "num_steps_trained": 376032, "last_target_update_ts": 47872, "num_target_updates": 94}, "done": false, "episodes_total": 31, "training_iteration": 48, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-39-59", "timestamp": 1619872799, "time_this_iter_s": 13.093241453170776, "time_total_s": 611.3620984554291, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1620>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 611.3620984554291, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.105555555555554, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8736171875, "episode_len_mean": 1512.84375, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8736171875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995], "episode_lengths": [3333, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995]}, "sampler_perf": {"mean_env_wait_ms": 1.6500728190088785, "mean_raw_obs_processing_ms": 1.6025573495546834, "mean_inference_ms": 2.099897487044215, "mean_action_processing_ms": 0.07174109878643231}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 49000, "timers": {"learn_time_ms": 19.975, "learn_throughput": 1602.022, "update_time_ms": 2.503}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001359738176688552, "cur_lr": 0.0005, "mean_q": 0.15603001415729523, "min_q": 0.005822598934173584, "max_q": 0.17859260737895966, "mean_td_error": -0.00786527618765831}}, "num_steps_sampled": 49000, "num_steps_trained": 384032, "last_target_update_ts": 48880, "num_target_updates": 96}, "done": false, "episodes_total": 32, "training_iteration": 49, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-40-12", "timestamp": 1619872812, "time_this_iter_s": 13.265969514846802, "time_total_s": 624.6280679702759, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 624.6280679702759, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 20.678947368421053, "ram_util_percent": 58.01052631578946}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8736171875, "episode_len_mean": 1512.84375, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8736171875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6500728190088783, "mean_raw_obs_processing_ms": 1.6025573495546834, "mean_inference_ms": 2.099897487044215, "mean_action_processing_ms": 0.07174109878643228}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 50000, "timers": {"learn_time_ms": 20.733, "learn_throughput": 1543.458, "update_time_ms": 2.434}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0029245533514767885, "cur_lr": 0.0005, "mean_q": 0.16988810896873474, "min_q": 0.12154622375965118, "max_q": 0.19858086109161377, "mean_td_error": 0.004508764948695898}}, "num_steps_sampled": 50000, "num_steps_trained": 392032, "last_target_update_ts": 49888, "num_target_updates": 98}, "done": false, "episodes_total": 32, "training_iteration": 50, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-40-26", "timestamp": 1619872826, "time_this_iter_s": 13.710570812225342, "time_total_s": 638.3386387825012, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149712f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 638.3386387825012, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.43, "ram_util_percent": 58.045}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8736171875, "episode_len_mean": 1512.84375, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8736171875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6500728190088783, "mean_raw_obs_processing_ms": 1.6025573495546834, "mean_inference_ms": 2.099897487044215, "mean_action_processing_ms": 0.07174109878643228}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 51000, "timers": {"learn_time_ms": 16.368, "learn_throughput": 1955.019, "update_time_ms": 2.702}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002464800840243697, "cur_lr": 0.0005, "mean_q": 0.153702050447464, "min_q": 0.005885235965251923, "max_q": 0.1928129643201828, "mean_td_error": -0.008674319833517075}}, "num_steps_sampled": 51000, "num_steps_trained": 400032, "last_target_update_ts": 50896, "num_target_updates": 100}, "done": false, "episodes_total": 32, "training_iteration": 51, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-40-40", "timestamp": 1619872840, "time_this_iter_s": 13.553910493850708, "time_total_s": 651.8925492763519, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b92f0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 651.8925492763519, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 21.726315789473684, "ram_util_percent": 58.01052631578948}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8736171875, "episode_len_mean": 1512.84375, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8736171875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6500728190088783, "mean_raw_obs_processing_ms": 1.6025573495546834, "mean_inference_ms": 2.099897487044215, "mean_action_processing_ms": 0.07174109878643228}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timers": {"learn_time_ms": 20.323, "learn_throughput": 1574.566, "update_time_ms": 2.295}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005668024066835642, "cur_lr": 0.0005, "mean_q": 0.12917232513427734, "min_q": -0.08495807647705078, "max_q": 0.18095754086971283, "mean_td_error": 0.012697767466306686}}, "num_steps_sampled": 52000, "num_steps_trained": 408032, "last_target_update_ts": 51904, "num_target_updates": 102}, "done": false, "episodes_total": 32, "training_iteration": 52, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-40-53", "timestamp": 1619872853, "time_this_iter_s": 13.182523727416992, "time_total_s": 665.0750730037689, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b16a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 665.0750730037689, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.436842105263157, "ram_util_percent": 57.752631578947366}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8471439393939394, "episode_len_mean": 1588.2727272727273, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8471439393939394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333], "policy_pol_reward": [0.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.65187604526943, "mean_raw_obs_processing_ms": 1.6011558868673699, "mean_inference_ms": 2.1019120434454983, "mean_action_processing_ms": 0.07180716815141597}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 53000, "timers": {"learn_time_ms": 17.789, "learn_throughput": 1798.828, "update_time_ms": 2.307}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0021233721636235714, "cur_lr": 0.0005, "mean_q": 0.15680724382400513, "min_q": 0.06906053423881531, "max_q": 0.1856568157672882, "mean_td_error": -0.006465937942266464}}, "num_steps_sampled": 53000, "num_steps_trained": 416032, "last_target_update_ts": 52912, "num_target_updates": 104}, "done": false, "episodes_total": 33, "training_iteration": 53, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-41-06", "timestamp": 1619872866, "time_this_iter_s": 13.263959169387817, "time_total_s": 678.3390321731567, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643f28>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 678.3390321731567, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 29.057894736842105, "ram_util_percent": 55.15263157894737}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8516397058823529, "episode_len_mean": 1572.0294117647059, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8516397058823529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0], "episode_lengths": [1036, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6535530006482955, "mean_raw_obs_processing_ms": 1.5997492794066777, "mean_inference_ms": 2.103779906226046, "mean_action_processing_ms": 0.07186792387408204}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 54000, "timers": {"learn_time_ms": 16.548, "learn_throughput": 1933.739, "update_time_ms": 2.253}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003044036915525794, "cur_lr": 0.0005, "mean_q": 0.15604473650455475, "min_q": 0.044641848653554916, "max_q": 0.18622776865959167, "mean_td_error": -0.007060336880385876}}, "num_steps_sampled": 54000, "num_steps_trained": 424032, "last_target_update_ts": 53920, "num_target_updates": 106}, "done": false, "episodes_total": 34, "training_iteration": 54, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-41-19", "timestamp": 1619872879, "time_this_iter_s": 12.580910682678223, "time_total_s": 690.919942855835, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643e18>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1c80>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 690.919942855835, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.872222222222224, "ram_util_percent": 57.75}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8516397058823529, "episode_len_mean": 1572.0294117647059, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8516397058823529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6535530006482952, "mean_raw_obs_processing_ms": 1.5997492794066777, "mean_inference_ms": 2.103779906226046, "mean_action_processing_ms": 0.07186792387408203}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 55000, "timers": {"learn_time_ms": 17.547, "learn_throughput": 1823.65, "update_time_ms": 2.212}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0041585988365113735, "cur_lr": 0.0005, "mean_q": 0.128904789686203, "min_q": -0.09241746366024017, "max_q": 0.17594298720359802, "mean_td_error": 0.04104328528046608}}, "num_steps_sampled": 55000, "num_steps_trained": 432032, "last_target_update_ts": 54928, "num_target_updates": 108}, "done": false, "episodes_total": 34, "training_iteration": 55, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-41-32", "timestamp": 1619872892, "time_this_iter_s": 12.59229040145874, "time_total_s": 703.5122332572937, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b90d0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 703.5122332572937, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 21.438888888888886, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8597916666666667, "episode_len_mean": 1539.5277777777778, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8597916666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9995, -0.99725, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0], "episode_lengths": [1878, 96, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036], "policy_pol_reward": [-0.9995, -0.99725, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6566962750435863, "mean_raw_obs_processing_ms": 1.5969891370014813, "mean_inference_ms": 2.1071946784773066, "mean_action_processing_ms": 0.0719792018693462}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 56000, "timers": {"learn_time_ms": 18.919, "learn_throughput": 1691.397, "update_time_ms": 2.159}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0040776534005999565, "cur_lr": 0.0005, "mean_q": 0.12973149120807648, "min_q": -0.07209882885217667, "max_q": 0.16471174359321594, "mean_td_error": -0.017502211034297943}}, "num_steps_sampled": 56000, "num_steps_trained": 440032, "last_target_update_ts": 55936, "num_target_updates": 110}, "done": false, "episodes_total": 36, "training_iteration": 56, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-41-44", "timestamp": 1619872904, "time_this_iter_s": 12.785689353942871, "time_total_s": 716.2979226112366, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971158>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b96a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 716.2979226112366, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.263157894736842, "ram_util_percent": 57.95789473684211}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8635135135135135, "episode_len_mean": 1533.2162162162163, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8635135135135135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9975, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725], "episode_lengths": [1306, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96], "policy_pol_reward": [-0.9975, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725]}, "sampler_perf": {"mean_env_wait_ms": 1.6581601430503674, "mean_raw_obs_processing_ms": 1.5958131274123954, "mean_inference_ms": 2.1087797405716073, "mean_action_processing_ms": 0.07203052684802684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 57000, "timers": {"learn_time_ms": 16.858, "learn_throughput": 1898.232, "update_time_ms": 2.293}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016954515594989061, "cur_lr": 0.0005, "mean_q": 0.1414434164762497, "min_q": -0.10984082520008087, "max_q": 0.17270627617835999, "mean_td_error": -0.008736800402402878}}, "num_steps_sampled": 57000, "num_steps_trained": 448032, "last_target_update_ts": 56944, "num_target_updates": 112}, "done": false, "episodes_total": 37, "training_iteration": 57, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-41-58", "timestamp": 1619872918, "time_this_iter_s": 13.443002462387085, "time_total_s": 729.7409250736237, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 729.7409250736237, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 20.347368421052632, "ram_util_percent": 57.97894736842106}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8635135135135135, "episode_len_mean": 1533.2162162162163, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8635135135135135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975]}, "sampler_perf": {"mean_env_wait_ms": 1.6581601430503672, "mean_raw_obs_processing_ms": 1.5958131274123954, "mean_inference_ms": 2.108779740571607, "mean_action_processing_ms": 0.07203052684802684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 58000, "timers": {"learn_time_ms": 16.996, "learn_throughput": 1882.796, "update_time_ms": 2.316}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0039744568057358265, "cur_lr": 0.0005, "mean_q": 0.1629648208618164, "min_q": 0.13617846369743347, "max_q": 0.1797318160533905, "mean_td_error": 0.007013545837253332}}, "num_steps_sampled": 58000, "num_steps_trained": 456032, "last_target_update_ts": 57952, "num_target_updates": 114}, "done": false, "episodes_total": 37, "training_iteration": 58, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-42-11", "timestamp": 1619872931, "time_this_iter_s": 13.053154706954956, "time_total_s": 742.7940797805786, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46439d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 742.7940797805786, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.588888888888892, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8635135135135135, "episode_len_mean": 1533.2162162162163, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8635135135135135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975]}, "sampler_perf": {"mean_env_wait_ms": 1.6581601430503672, "mean_raw_obs_processing_ms": 1.5958131274123954, "mean_inference_ms": 2.108779740571607, "mean_action_processing_ms": 0.07203052684802684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 59000, "timers": {"learn_time_ms": 18.426, "learn_throughput": 1736.72, "update_time_ms": 2.844}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0034945032093673944, "cur_lr": 0.0005, "mean_q": 0.13104240596294403, "min_q": -0.1473451405763626, "max_q": 0.1698761284351349, "mean_td_error": -0.006044596433639526}}, "num_steps_sampled": 59000, "num_steps_trained": 464032, "last_target_update_ts": 58960, "num_target_updates": 116}, "done": false, "episodes_total": 37, "training_iteration": 59, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-42-24", "timestamp": 1619872944, "time_this_iter_s": 12.63565182685852, "time_total_s": 755.4297316074371, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 755.4297316074371, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.57222222222222, "ram_util_percent": 58.02222222222221}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8635135135135135, "episode_len_mean": 1533.2162162162163, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8635135135135135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975]}, "sampler_perf": {"mean_env_wait_ms": 1.6581601430503672, "mean_raw_obs_processing_ms": 1.5958131274123954, "mean_inference_ms": 2.108779740571607, "mean_action_processing_ms": 0.07203052684802684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"learn_time_ms": 17.211, "learn_throughput": 1859.291, "update_time_ms": 2.254}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007477145176380873, "cur_lr": 0.0005, "mean_q": 0.13401123881340027, "min_q": 0.029000669717788696, "max_q": 0.16270990669727325, "mean_td_error": 0.03627500310540199}}, "num_steps_sampled": 60000, "num_steps_trained": 472032, "last_target_update_ts": 59968, "num_target_updates": 118}, "done": false, "episodes_total": 37, "training_iteration": 60, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-42-37", "timestamp": 1619872957, "time_this_iter_s": 13.140746593475342, "time_total_s": 768.5704782009125, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b56a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 768.5704782009125, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.663157894736845, "ram_util_percent": 58.03684210526316}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8671052631578948, "episode_len_mean": 1592.2105263157894, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8671052631578948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975], "episode_lengths": [3775, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975]}, "sampler_perf": {"mean_env_wait_ms": 1.659620068211234, "mean_raw_obs_processing_ms": 1.594633664146057, "mean_inference_ms": 2.1103402200061407, "mean_action_processing_ms": 0.07208013112282759}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 61000, "timers": {"learn_time_ms": 21.35, "learn_throughput": 1498.815, "update_time_ms": 2.411}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004894221667200327, "cur_lr": 0.0005, "mean_q": 0.11520609259605408, "min_q": -0.19109800457954407, "max_q": 0.1509152352809906, "mean_td_error": 0.026021240279078484}}, "num_steps_sampled": 61000, "num_steps_trained": 480032, "last_target_update_ts": 60976, "num_target_updates": 120}, "done": false, "episodes_total": 38, "training_iteration": 61, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-42-50", "timestamp": 1619872970, "time_this_iter_s": 13.305588722229004, "time_total_s": 781.8760669231415, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 781.8760669231415, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 20.13684210526316, "ram_util_percent": 57.98947368421052}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8671052631578948, "episode_len_mean": 1592.2105263157894, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8671052631578948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.659620068211234, "mean_raw_obs_processing_ms": 1.594633664146057, "mean_inference_ms": 2.1103402200061407, "mean_action_processing_ms": 0.07208013112282759}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 62000, "timers": {"learn_time_ms": 19.466, "learn_throughput": 1643.88, "update_time_ms": 2.385}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019315114477649331, "cur_lr": 0.0005, "mean_q": 0.11111870408058167, "min_q": -0.07924490422010422, "max_q": 0.13601435720920563, "mean_td_error": -0.008079945109784603}}, "num_steps_sampled": 62000, "num_steps_trained": 488032, "last_target_update_ts": 61984, "num_target_updates": 122}, "done": false, "episodes_total": 38, "training_iteration": 62, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-43-03", "timestamp": 1619872983, "time_this_iter_s": 12.998662233352661, "time_total_s": 794.8747291564941, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971158>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46437b8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 794.8747291564941, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 20.605263157894736, "ram_util_percent": 57.994736842105254}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8671052631578948, "episode_len_mean": 1592.2105263157894, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8671052631578948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.659620068211234, "mean_raw_obs_processing_ms": 1.594633664146057, "mean_inference_ms": 2.1103402200061407, "mean_action_processing_ms": 0.07208013112282759}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 63000, "timers": {"learn_time_ms": 17.949, "learn_throughput": 1782.85, "update_time_ms": 2.314}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005375330336391926, "cur_lr": 0.0005, "mean_q": 0.10774733126163483, "min_q": -0.023881271481513977, "max_q": 0.12779152393341064, "mean_td_error": 0.061446573585271835}}, "num_steps_sampled": 63000, "num_steps_trained": 496032, "last_target_update_ts": 62992, "num_target_updates": 124}, "done": false, "episodes_total": 38, "training_iteration": 63, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-43-17", "timestamp": 1619872997, "time_this_iter_s": 13.431067943572998, "time_total_s": 808.3057971000671, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b96a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 808.3057971000671, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.778947368421058, "ram_util_percent": 58.06315789473683}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8671052631578948, "episode_len_mean": 1592.2105263157894, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8671052631578948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.659620068211234, "mean_raw_obs_processing_ms": 1.594633664146057, "mean_inference_ms": 2.1103402200061407, "mean_action_processing_ms": 0.07208013112282759}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 64000, "timers": {"learn_time_ms": 19.842, "learn_throughput": 1612.75, "update_time_ms": 2.514}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005010402295738459, "cur_lr": 0.0005, "mean_q": 0.0849781408905983, "min_q": -0.2251424342393875, "max_q": 0.11334199458360672, "mean_td_error": -0.01945880800485611}}, "num_steps_sampled": 64000, "num_steps_trained": 504032, "last_target_update_ts": 64000, "num_target_updates": 126}, "done": false, "episodes_total": 38, "training_iteration": 64, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-43-30", "timestamp": 1619873010, "time_this_iter_s": 13.393434286117554, "time_total_s": 821.6992313861847, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bd510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 821.6992313861847, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.26842105263158, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8447179487179488, "episode_len_mean": 1654.0, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8447179487179488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006000000000000004, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775], "policy_pol_reward": [0.006000000000000004, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.661038579013571, "mean_raw_obs_processing_ms": 1.5935367913895127, "mean_inference_ms": 2.1119390648124794, "mean_action_processing_ms": 0.07213089109874479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 65000, "timers": {"learn_time_ms": 20.85, "learn_throughput": 1534.785, "update_time_ms": 2.967}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002103391569107771, "cur_lr": 0.0005, "mean_q": 0.08564507961273193, "min_q": -0.13843144476413727, "max_q": 0.11802960932254791, "mean_td_error": -0.006858488079160452}}, "num_steps_sampled": 65000, "num_steps_trained": 512032, "last_target_update_ts": 64504, "num_target_updates": 127}, "done": false, "episodes_total": 39, "training_iteration": 65, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-43-43", "timestamp": 1619873023, "time_this_iter_s": 13.142795324325562, "time_total_s": 834.8420267105103, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46439d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46436a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 834.8420267105103, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.873684210526317, "ram_util_percent": 57.968421052631584}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8447179487179488, "episode_len_mean": 1654.0, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8447179487179488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004]}, "sampler_perf": {"mean_env_wait_ms": 1.6610385790135707, "mean_raw_obs_processing_ms": 1.5935367913895124, "mean_inference_ms": 2.11193906481248, "mean_action_processing_ms": 0.07213089109874479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 66000, "timers": {"learn_time_ms": 17.808, "learn_throughput": 1796.896, "update_time_ms": 2.308}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003420600900426507, "cur_lr": 0.0005, "mean_q": 0.09637384116649628, "min_q": 0.07409922778606415, "max_q": 0.11416925489902496, "mean_td_error": 0.034204937517642975}}, "num_steps_sampled": 66000, "num_steps_trained": 520032, "last_target_update_ts": 65512, "num_target_updates": 129}, "done": false, "episodes_total": 39, "training_iteration": 66, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-43-57", "timestamp": 1619873037, "time_this_iter_s": 13.17107105255127, "time_total_s": 848.0130977630615, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bdd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bd6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 848.0130977630615, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 20.55263157894737, "ram_util_percent": 58.136842105263156}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8447179487179488, "episode_len_mean": 1654.0, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8447179487179488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004]}, "sampler_perf": {"mean_env_wait_ms": 1.6610385790135707, "mean_raw_obs_processing_ms": 1.5935367913895124, "mean_inference_ms": 2.11193906481248, "mean_action_processing_ms": 0.07213089109874479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 67000, "timers": {"learn_time_ms": 17.597, "learn_throughput": 1818.452, "update_time_ms": 2.978}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0035021889489144087, "cur_lr": 0.0005, "mean_q": 0.05617596209049225, "min_q": -0.1208437830209732, "max_q": 0.0949757918715477, "mean_td_error": 0.009592784568667412}}, "num_steps_sampled": 67000, "num_steps_trained": 528032, "last_target_update_ts": 66520, "num_target_updates": 131}, "done": false, "episodes_total": 39, "training_iteration": 67, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-44-11", "timestamp": 1619873051, "time_this_iter_s": 13.857914924621582, "time_total_s": 861.8710126876831, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 861.8710126876831, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.955, "ram_util_percent": 58.07499999999999}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8484624999999999, "episode_len_mean": 1686.125, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8484624999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9945, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004], "episode_lengths": [2939, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002], "policy_pol_reward": [-0.9945, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004]}, "sampler_perf": {"mean_env_wait_ms": 1.6624244150695329, "mean_raw_obs_processing_ms": 1.592653801095952, "mean_inference_ms": 2.113499475346741, "mean_action_processing_ms": 0.07218036409138502}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 68000, "timers": {"learn_time_ms": 18.747, "learn_throughput": 1706.912, "update_time_ms": 2.201}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00460166297852993, "cur_lr": 0.0005, "mean_q": 0.07199669629335403, "min_q": -0.17194093763828278, "max_q": 0.09820792824029922, "mean_td_error": 0.019402746111154556}}, "num_steps_sampled": 68000, "num_steps_trained": 536032, "last_target_update_ts": 67528, "num_target_updates": 133}, "done": false, "episodes_total": 40, "training_iteration": 68, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-44-24", "timestamp": 1619873064, "time_this_iter_s": 13.223953485488892, "time_total_s": 875.094966173172, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d08>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 875.094966173172, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.294736842105266, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8484625000000001, "episode_len_mean": 1686.125, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8484625000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6624244150695329, "mean_raw_obs_processing_ms": 1.592653801095952, "mean_inference_ms": 2.113499475346741, "mean_action_processing_ms": 0.07218036409138502}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 69000, "timers": {"learn_time_ms": 18.657, "learn_throughput": 1715.133, "update_time_ms": 2.248}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004639450926333666, "cur_lr": 0.0005, "mean_q": 0.06145244836807251, "min_q": -0.11293423175811768, "max_q": 0.09192284196615219, "mean_td_error": 0.019413964822888374}}, "num_steps_sampled": 69000, "num_steps_trained": 544032, "last_target_update_ts": 68536, "num_target_updates": 135}, "done": false, "episodes_total": 40, "training_iteration": 69, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-44-37", "timestamp": 1619873077, "time_this_iter_s": 12.966537475585938, "time_total_s": 888.0615036487579, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 888.0615036487579, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 21.183333333333334, "ram_util_percent": 58.01111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8484625000000001, "episode_len_mean": 1686.125, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8484625000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6624244150695329, "mean_raw_obs_processing_ms": 1.592653801095952, "mean_inference_ms": 2.113499475346741, "mean_action_processing_ms": 0.07218036409138502}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 70000, "timers": {"learn_time_ms": 17.918, "learn_throughput": 1785.891, "update_time_ms": 2.733}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027200228068977594, "cur_lr": 0.0005, "mean_q": 0.06506213545799255, "min_q": -0.1026543527841568, "max_q": 0.08870627731084824, "mean_td_error": -0.012326822616159916}}, "num_steps_sampled": 70000, "num_steps_trained": 552032, "last_target_update_ts": 69544, "num_target_updates": 137}, "done": false, "episodes_total": 40, "training_iteration": 70, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-44-50", "timestamp": 1619873090, "time_this_iter_s": 13.005975246429443, "time_total_s": 901.0674788951874, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b6510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 901.0674788951874, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.589473684210525, "ram_util_percent": 58.07368421052631}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.007750000000000005, "episode_reward_min": -1.0, "episode_reward_mean": -0.8484625000000001, "episode_len_mean": 1686.125, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.007750000000000005}, "policy_reward_mean": {"pol": -0.8484625000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6624244150695329, "mean_raw_obs_processing_ms": 1.592653801095952, "mean_inference_ms": 2.113499475346741, "mean_action_processing_ms": 0.07218036409138502}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 71000, "timers": {"learn_time_ms": 14.434, "learn_throughput": 2216.928, "update_time_ms": 1.966}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.000504727300722152, "cur_lr": 0.0005, "mean_q": 0.0766725242137909, "min_q": 0.04055313020944595, "max_q": 0.09811156988143921, "mean_td_error": 0.0006674558389931917}}, "num_steps_sampled": 71000, "num_steps_trained": 560032, "last_target_update_ts": 70552, "num_target_updates": 139}, "done": false, "episodes_total": 40, "training_iteration": 71, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-45-03", "timestamp": 1619873103, "time_this_iter_s": 13.28847861289978, "time_total_s": 914.3559575080872, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643f28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643c80>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 914.3559575080872, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 20.884210526315787, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8275121951219513, "episode_len_mean": 1742.6097560975609, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8275121951219513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.010500000000000008, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939], "policy_pol_reward": [0.010500000000000008, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.663757579972712, "mean_raw_obs_processing_ms": 1.5918945229252022, "mean_inference_ms": 2.115019734137427, "mean_action_processing_ms": 0.0722278012336331}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"learn_time_ms": 17.749, "learn_throughput": 1802.911, "update_time_ms": 2.465}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001238959957845509, "cur_lr": 0.0005, "mean_q": 0.07531996071338654, "min_q": -0.03251500427722931, "max_q": 0.10042500495910645, "mean_td_error": 0.0009353610221296549}}, "num_steps_sampled": 72000, "num_steps_trained": 568032, "last_target_update_ts": 71560, "num_target_updates": 141}, "done": false, "episodes_total": 41, "training_iteration": 72, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-45-17", "timestamp": 1619873117, "time_this_iter_s": 13.272031545639038, "time_total_s": 927.6279890537262, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b6d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b66a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 927.6279890537262, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.963157894736838, "ram_util_percent": 58.005263157894746}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8275121951219513, "episode_len_mean": 1742.6097560975609, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8275121951219513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008]}, "sampler_perf": {"mean_env_wait_ms": 1.663757579972712, "mean_raw_obs_processing_ms": 1.5918945229252022, "mean_inference_ms": 2.1150197341374275, "mean_action_processing_ms": 0.0722278012336331}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 73000, "timers": {"learn_time_ms": 18.279, "learn_throughput": 1750.686, "update_time_ms": 2.256}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003991679288446903, "cur_lr": 0.0005, "mean_q": 0.055229898542165756, "min_q": -0.19504815340042114, "max_q": 0.08191061019897461, "mean_td_error": 0.023619504645466805}}, "num_steps_sampled": 73000, "num_steps_trained": 576032, "last_target_update_ts": 72568, "num_target_updates": 143}, "done": false, "episodes_total": 41, "training_iteration": 73, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-45-29", "timestamp": 1619873129, "time_this_iter_s": 12.221796035766602, "time_total_s": 939.8497850894928, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 939.8497850894928, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.04705882352941, "ram_util_percent": 58.08823529411765}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8275121951219513, "episode_len_mean": 1742.6097560975609, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8275121951219513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008]}, "sampler_perf": {"mean_env_wait_ms": 1.663757579972712, "mean_raw_obs_processing_ms": 1.5918945229252022, "mean_inference_ms": 2.1150197341374275, "mean_action_processing_ms": 0.0722278012336331}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 74000, "timers": {"learn_time_ms": 18.063, "learn_throughput": 1771.552, "update_time_ms": 2.323}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00562638184055686, "cur_lr": 0.0005, "mean_q": 0.059350721538066864, "min_q": -0.2400713860988617, "max_q": 0.09052310883998871, "mean_td_error": 0.028271257877349854}}, "num_steps_sampled": 74000, "num_steps_trained": 584032, "last_target_update_ts": 73576, "num_target_updates": 145}, "done": false, "episodes_total": 41, "training_iteration": 74, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-45-41", "timestamp": 1619873141, "time_this_iter_s": 12.393184900283813, "time_total_s": 952.2429699897766, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 952.2429699897766, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.794444444444444, "ram_util_percent": 58.03888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8275121951219513, "episode_len_mean": 1742.6097560975609, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8275121951219513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008]}, "sampler_perf": {"mean_env_wait_ms": 1.663757579972712, "mean_raw_obs_processing_ms": 1.5918945229252022, "mean_inference_ms": 2.1150197341374275, "mean_action_processing_ms": 0.0722278012336331}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 75000, "timers": {"learn_time_ms": 18.435, "learn_throughput": 1735.822, "update_time_ms": 2.177}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0034181755036115646, "cur_lr": 0.0005, "mean_q": 0.057953521609306335, "min_q": -0.28236737847328186, "max_q": 0.0848359763622284, "mean_td_error": -0.010272050276398659}}, "num_steps_sampled": 75000, "num_steps_trained": 592032, "last_target_update_ts": 74584, "num_target_updates": 147}, "done": false, "episodes_total": 41, "training_iteration": 75, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-45-54", "timestamp": 1619873154, "time_this_iter_s": 12.934065580368042, "time_total_s": 965.1770355701447, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 965.1770355701447, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.794444444444444, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8121918604651165, "episode_len_mean": 1762.5116279069769, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8121918604651165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0037500000000000016, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008], "episode_lengths": [4002, 339, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002], "policy_pol_reward": [0.0037500000000000016, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008]}, "sampler_perf": {"mean_env_wait_ms": 1.6661635384876972, "mean_raw_obs_processing_ms": 1.590495320061988, "mean_inference_ms": 2.1177432397323717, "mean_action_processing_ms": 0.07231288987040434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76000, "timers": {"learn_time_ms": 18.774, "learn_throughput": 1704.499, "update_time_ms": 2.322}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011459154775366187, "cur_lr": 0.0005, "mean_q": 0.06283815205097198, "min_q": 0.038479819893836975, "max_q": 0.08472272753715515, "mean_td_error": -0.0010732626542448997}}, "num_steps_sampled": 76000, "num_steps_trained": 600032, "last_target_update_ts": 75592, "num_target_updates": 149}, "done": false, "episodes_total": 43, "training_iteration": 76, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-46-07", "timestamp": 1619873167, "time_this_iter_s": 12.754879236221313, "time_total_s": 977.931914806366, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b6510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 977.931914806366, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 25.015789473684208, "ram_util_percent": 57.82631578947369}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8121918604651165, "episode_len_mean": 1762.5116279069769, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8121918604651165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6661635384876972, "mean_raw_obs_processing_ms": 1.5904953200619885, "mean_inference_ms": 2.117743239732372, "mean_action_processing_ms": 0.07231288987040434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 77000, "timers": {"learn_time_ms": 20.413, "learn_throughput": 1567.636, "update_time_ms": 2.815}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017833411693572998, "cur_lr": 0.0005, "mean_q": 0.06093410402536392, "min_q": -0.1317514330148697, "max_q": 0.08273179084062576, "mean_td_error": 0.025479014962911606}}, "num_steps_sampled": 77000, "num_steps_trained": 608032, "last_target_update_ts": 76600, "num_target_updates": 151}, "done": false, "episodes_total": 43, "training_iteration": 77, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-46-20", "timestamp": 1619873180, "time_this_iter_s": 12.76466155052185, "time_total_s": 990.6965763568878, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 990.6965763568878, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.90555555555555, "ram_util_percent": 58.050000000000004}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8121918604651165, "episode_len_mean": 1762.5116279069769, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8121918604651165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6661635384876972, "mean_raw_obs_processing_ms": 1.5904953200619885, "mean_inference_ms": 2.117743239732372, "mean_action_processing_ms": 0.07231288987040434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 78000, "timers": {"learn_time_ms": 18.626, "learn_throughput": 1718.037, "update_time_ms": 2.761}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002338023856282234, "cur_lr": 0.0005, "mean_q": 0.06382858008146286, "min_q": 0.02429799921810627, "max_q": 0.11204476654529572, "mean_td_error": -0.0071339476853609085}}, "num_steps_sampled": 78000, "num_steps_trained": 616032, "last_target_update_ts": 77608, "num_target_updates": 153}, "done": false, "episodes_total": 43, "training_iteration": 78, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-46-33", "timestamp": 1619873193, "time_this_iter_s": 13.088321208953857, "time_total_s": 1003.7848975658417, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b6d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b66a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1003.7848975658417, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.6421052631579, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8164602272727275, "episode_len_mean": 1779.5681818181818, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8164602272727275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0], "episode_lengths": [2513, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6672836684628152, "mean_raw_obs_processing_ms": 1.5897792732341862, "mean_inference_ms": 2.119007075901345, "mean_action_processing_ms": 0.0723517748916405}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 79000, "timers": {"learn_time_ms": 18.95, "learn_throughput": 1688.664, "update_time_ms": 2.847}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00033167924266308546, "cur_lr": 0.0005, "mean_q": 0.06580565869808197, "min_q": 0.016675079241394997, "max_q": 0.08604545891284943, "mean_td_error": -0.0014211991801857948}}, "num_steps_sampled": 79000, "num_steps_trained": 624032, "last_target_update_ts": 78616, "num_target_updates": 155}, "done": false, "episodes_total": 44, "training_iteration": 79, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-46-46", "timestamp": 1619873206, "time_this_iter_s": 12.864672183990479, "time_total_s": 1016.6495697498322, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1016.6495697498322, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 20.5, "ram_util_percent": 57.90555555555555}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8164602272727275, "episode_len_mean": 1779.5681818181818, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8164602272727275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.667283668462815, "mean_raw_obs_processing_ms": 1.5897792732341864, "mean_inference_ms": 2.1190070759013455, "mean_action_processing_ms": 0.0723517748916405}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 80000, "timers": {"learn_time_ms": 14.765, "learn_throughput": 2167.34, "update_time_ms": 3.04}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002472949679940939, "cur_lr": 0.0005, "mean_q": 0.05306923761963844, "min_q": -0.16138967871665955, "max_q": 0.09219454973936081, "mean_td_error": -0.002891410607844591}}, "num_steps_sampled": 80000, "num_steps_trained": 632032, "last_target_update_ts": 79624, "num_target_updates": 157}, "done": false, "episodes_total": 44, "training_iteration": 80, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-47-00", "timestamp": 1619873220, "time_this_iter_s": 13.56373643875122, "time_total_s": 1030.2133061885834, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643ea0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1030.2133061885834, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 19.157894736842103, "ram_util_percent": 58.08947368421053}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8204222222222223, "episode_len_mean": 1794.8, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8204222222222223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99475, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0], "episode_lengths": [2465, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513], "policy_pol_reward": [-0.99475, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.668359751617344, "mean_raw_obs_processing_ms": 1.5891953522151814, "mean_inference_ms": 2.1202184582260766, "mean_action_processing_ms": 0.07238898801340764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 81000, "timers": {"learn_time_ms": 19.065, "learn_throughput": 1678.433, "update_time_ms": 2.26}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0015434498200193048, "cur_lr": 0.0005, "mean_q": 0.05916529893875122, "min_q": -0.13771913945674896, "max_q": 0.09015091508626938, "mean_td_error": -0.002770251128822565}}, "num_steps_sampled": 81000, "num_steps_trained": 640032, "last_target_update_ts": 80632, "num_target_updates": 159}, "done": false, "episodes_total": 45, "training_iteration": 81, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-47-13", "timestamp": 1619873233, "time_this_iter_s": 12.986715316772461, "time_total_s": 1043.2000215053558, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1043.2000215053558, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 19.99473684210526, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8204222222222225, "episode_len_mean": 1794.8, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8204222222222225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475]}, "sampler_perf": {"mean_env_wait_ms": 1.6683597516173436, "mean_raw_obs_processing_ms": 1.5891953522151814, "mean_inference_ms": 2.120218458226077, "mean_action_processing_ms": 0.07238898801340764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 82000, "timers": {"learn_time_ms": 21.119, "learn_throughput": 1515.201, "update_time_ms": 2.618}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0022210096940398216, "cur_lr": 0.0005, "mean_q": 0.06073341891169548, "min_q": -0.20135276019573212, "max_q": 0.09352178871631622, "mean_td_error": -0.003429481526836753}}, "num_steps_sampled": 82000, "num_steps_trained": 648032, "last_target_update_ts": 81640, "num_target_updates": 161}, "done": false, "episodes_total": 45, "training_iteration": 82, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-47-26", "timestamp": 1619873246, "time_this_iter_s": 13.480530738830566, "time_total_s": 1056.6805522441864, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b6510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1056.6805522441864, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 20.310526315789474, "ram_util_percent": 57.999999999999986}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8204222222222225, "episode_len_mean": 1794.8, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8204222222222225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475]}, "sampler_perf": {"mean_env_wait_ms": 1.6683597516173436, "mean_raw_obs_processing_ms": 1.5891953522151814, "mean_inference_ms": 2.120218458226077, "mean_action_processing_ms": 0.07238898801340764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 83000, "timers": {"learn_time_ms": 19.95, "learn_throughput": 1604.036, "update_time_ms": 2.515}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.000839127809740603, "cur_lr": 0.0005, "mean_q": 0.06458605825901031, "min_q": 0.03216952085494995, "max_q": 0.09080895036458969, "mean_td_error": 0.0019445245852693915}}, "num_steps_sampled": 83000, "num_steps_trained": 656032, "last_target_update_ts": 82648, "num_target_updates": 163}, "done": false, "episodes_total": 45, "training_iteration": 83, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-47-39", "timestamp": 1619873259, "time_this_iter_s": 12.582566738128662, "time_total_s": 1069.263118982315, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1069.263118982315, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.694444444444446, "ram_util_percent": 58.03333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8204222222222225, "episode_len_mean": 1794.8, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8204222222222225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475]}, "sampler_perf": {"mean_env_wait_ms": 1.6683597516173436, "mean_raw_obs_processing_ms": 1.5891953522151814, "mean_inference_ms": 2.120218458226077, "mean_action_processing_ms": 0.07238898801340764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"learn_time_ms": 18.196, "learn_throughput": 1758.648, "update_time_ms": 2.216}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016554631292819977, "cur_lr": 0.0005, "mean_q": 0.058409836143255234, "min_q": 0.016619015485048294, "max_q": 0.0852612555027008, "mean_td_error": -0.0025093592703342438}}, "num_steps_sampled": 84000, "num_steps_trained": 664032, "last_target_update_ts": 83656, "num_target_updates": 165}, "done": false, "episodes_total": 45, "training_iteration": 84, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-47-52", "timestamp": 1619873272, "time_this_iter_s": 12.880882978439331, "time_total_s": 1082.1440019607544, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b6d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b66a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1082.1440019607544, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.100000000000005, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8241141304347828, "episode_len_mean": 1832.0434782608695, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8241141304347828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99025, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475], "episode_lengths": [3508, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465], "policy_pol_reward": [-0.99025, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475]}, "sampler_perf": {"mean_env_wait_ms": 1.6693795047327746, "mean_raw_obs_processing_ms": 1.588702281230112, "mean_inference_ms": 2.121354924791032, "mean_action_processing_ms": 0.07242339180659317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 85000, "timers": {"learn_time_ms": 21.054, "learn_throughput": 1519.899, "update_time_ms": 2.735}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0006218997878022492, "cur_lr": 0.0005, "mean_q": 0.04239395260810852, "min_q": -0.10782083868980408, "max_q": 0.06750553101301193, "mean_td_error": -0.004521654918789864}}, "num_steps_sampled": 85000, "num_steps_trained": 672032, "last_target_update_ts": 84664, "num_target_updates": 167}, "done": false, "episodes_total": 46, "training_iteration": 85, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-48-05", "timestamp": 1619873285, "time_this_iter_s": 12.690380811691284, "time_total_s": 1094.8343827724457, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1094.8343827724457, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.849999999999998, "ram_util_percent": 57.916666666666664}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8241141304347829, "episode_len_mean": 1832.0434782608695, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8241141304347829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025]}, "sampler_perf": {"mean_env_wait_ms": 1.6693795047327746, "mean_raw_obs_processing_ms": 1.5887022812301124, "mean_inference_ms": 2.1213549247910324, "mean_action_processing_ms": 0.07242339180659317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 86000, "timers": {"learn_time_ms": 18.283, "learn_throughput": 1750.3, "update_time_ms": 2.542}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0038665286265313625, "cur_lr": 0.0005, "mean_q": 0.04575861990451813, "min_q": -0.08323050290346146, "max_q": 0.07784194499254227, "mean_td_error": 0.02962562069296837}}, "num_steps_sampled": 86000, "num_steps_trained": 680032, "last_target_update_ts": 85672, "num_target_updates": 169}, "done": false, "episodes_total": 46, "training_iteration": 86, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-48-18", "timestamp": 1619873298, "time_this_iter_s": 13.712852716445923, "time_total_s": 1108.5472354888916, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46436a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1108.5472354888916, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 20.57, "ram_util_percent": 58.07000000000001}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8241141304347829, "episode_len_mean": 1832.0434782608695, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8241141304347829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025]}, "sampler_perf": {"mean_env_wait_ms": 1.6693795047327746, "mean_raw_obs_processing_ms": 1.5887022812301124, "mean_inference_ms": 2.1213549247910324, "mean_action_processing_ms": 0.07242339180659317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 87000, "timers": {"learn_time_ms": 19.13, "learn_throughput": 1672.776, "update_time_ms": 2.443}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003897489747032523, "cur_lr": 0.0005, "mean_q": 0.037229787558317184, "min_q": -0.1580989509820938, "max_q": 0.06916250288486481, "mean_td_error": -0.012078562751412392}}, "num_steps_sampled": 87000, "num_steps_trained": 688032, "last_target_update_ts": 86680, "num_target_updates": 171}, "done": false, "episodes_total": 46, "training_iteration": 87, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-48-31", "timestamp": 1619873311, "time_this_iter_s": 12.461553812026978, "time_total_s": 1121.0087893009186, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b86a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1121.0087893009186, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 20.641176470588235, "ram_util_percent": 58.029411764705884}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8472830188679248, "episode_len_mean": 1648.1698113207547, "episodes_this_iter": 7, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8472830188679248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025], "episode_lengths": [2974, 18, 17, 17, 19, 17, 17, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508], "policy_pol_reward": [-0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025]}, "sampler_perf": {"mean_env_wait_ms": 1.6752405785275006, "mean_raw_obs_processing_ms": 1.5863215603100733, "mean_inference_ms": 2.1279716252044256, "mean_action_processing_ms": 0.07262174342918258}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 88000, "timers": {"learn_time_ms": 20.273, "learn_throughput": 1578.442, "update_time_ms": 2.8}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001925347256474197, "cur_lr": 0.0005, "mean_q": 0.0380355641245842, "min_q": -0.11787503957748413, "max_q": 0.08341702818870544, "mean_td_error": 0.02255363203585148}}, "num_steps_sampled": 88000, "num_steps_trained": 696032, "last_target_update_ts": 87688, "num_target_updates": 173}, "done": false, "episodes_total": 53, "training_iteration": 88, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-48-44", "timestamp": 1619873324, "time_this_iter_s": 13.005145788192749, "time_total_s": 1134.0139350891113, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46436a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1134.0139350891113, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 20.452631578947365, "ram_util_percent": 58.01052631578948}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8500601851851852, "episode_len_mean": 1647.7592592592594, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8500601851851852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99725, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1626, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17], "policy_pol_reward": [-0.99725, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6759535233985021, "mean_raw_obs_processing_ms": 1.5860279025844308, "mean_inference_ms": 2.1287688967350173, "mean_action_processing_ms": 0.07264551367628276}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 89000, "timers": {"learn_time_ms": 19.91, "learn_throughput": 1607.223, "update_time_ms": 2.587}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020541155245155096, "cur_lr": 0.0005, "mean_q": 0.044785644859075546, "min_q": -0.030030129477381706, "max_q": 0.06747128814458847, "mean_td_error": -0.0065208375453948975}}, "num_steps_sampled": 89000, "num_steps_trained": 704032, "last_target_update_ts": 88696, "num_target_updates": 175}, "done": false, "episodes_total": 54, "training_iteration": 89, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-48-57", "timestamp": 1619873337, "time_this_iter_s": 12.790576219558716, "time_total_s": 1146.80451130867, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643c80>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1146.80451130867, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 20.96666666666667, "ram_util_percent": 57.977777777777774}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8500601851851852, "episode_len_mean": 1647.7592592592594, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8500601851851852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725]}, "sampler_perf": {"mean_env_wait_ms": 1.6759535233985021, "mean_raw_obs_processing_ms": 1.5860279025844304, "mean_inference_ms": 2.1287688967350173, "mean_action_processing_ms": 0.07264551367628277}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 90000, "timers": {"learn_time_ms": 15.209, "learn_throughput": 2104.033, "update_time_ms": 2.067}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003327936166897416, "cur_lr": 0.0005, "mean_q": 0.05165008455514908, "min_q": -0.12200852483510971, "max_q": 0.07946670800447464, "mean_td_error": 0.0016481527127325535}}, "num_steps_sampled": 90000, "num_steps_trained": 712032, "last_target_update_ts": 89704, "num_target_updates": 177}, "done": false, "episodes_total": 54, "training_iteration": 90, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-49-09", "timestamp": 1619873349, "time_this_iter_s": 12.469638347625732, "time_total_s": 1159.2741496562958, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1159.2741496562958, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 19.244444444444447, "ram_util_percent": 58.016666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8500601851851852, "episode_len_mean": 1647.7592592592594, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8500601851851852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725]}, "sampler_perf": {"mean_env_wait_ms": 1.6759535233985021, "mean_raw_obs_processing_ms": 1.5860279025844304, "mean_inference_ms": 2.1287688967350173, "mean_action_processing_ms": 0.07264551367628277}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 91000, "timers": {"learn_time_ms": 18.917, "learn_throughput": 1691.64, "update_time_ms": 2.244}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002055020770058036, "cur_lr": 0.0005, "mean_q": 0.05235319584608078, "min_q": 0.028567759320139885, "max_q": 0.07148828357458115, "mean_td_error": 0.0032723713666200638}}, "num_steps_sampled": 91000, "num_steps_trained": 720032, "last_target_update_ts": 90712, "num_target_updates": 179}, "done": false, "episodes_total": 54, "training_iteration": 91, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-49-22", "timestamp": 1619873362, "time_this_iter_s": 12.652711629867554, "time_total_s": 1171.9268612861633, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c0510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1171.9268612861633, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.833333333333332, "ram_util_percent": 58.09444444444445}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8500601851851852, "episode_len_mean": 1647.7592592592594, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8500601851851852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725]}, "sampler_perf": {"mean_env_wait_ms": 1.6759535233985021, "mean_raw_obs_processing_ms": 1.5860279025844304, "mean_inference_ms": 2.1287688967350173, "mean_action_processing_ms": 0.07264551367628277}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92000, "timers": {"learn_time_ms": 17.94, "learn_throughput": 1783.75, "update_time_ms": 2.307}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0047701625153422356, "cur_lr": 0.0005, "mean_q": 0.040074169635772705, "min_q": -0.13682448863983154, "max_q": 0.08244844526052475, "mean_td_error": -0.015059228986501694}}, "num_steps_sampled": 92000, "num_steps_trained": 728032, "last_target_update_ts": 91720, "num_target_updates": 181}, "done": false, "episodes_total": 54, "training_iteration": 92, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-49-35", "timestamp": 1619873375, "time_this_iter_s": 12.759830474853516, "time_total_s": 1184.6866917610168, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643e18>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1184.6866917610168, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 21.299999999999997, "ram_util_percent": 57.9388888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8344727272727273, "episode_len_mean": 1690.5636363636363, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8344727272727273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007250000000000005, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626], "policy_pol_reward": [0.007250000000000005, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725]}, "sampler_perf": {"mean_env_wait_ms": 1.6766045676578374, "mean_raw_obs_processing_ms": 1.5857958302693884, "mean_inference_ms": 2.1294852750422, "mean_action_processing_ms": 0.07266640605183311}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 93000, "timers": {"learn_time_ms": 17.497, "learn_throughput": 1828.853, "update_time_ms": 2.382}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002072923583909869, "cur_lr": 0.0005, "mean_q": 0.045397840440273285, "min_q": -0.10729296505451202, "max_q": 0.07411511242389679, "mean_td_error": 0.0006396791432052851}}, "num_steps_sampled": 93000, "num_steps_trained": 736032, "last_target_update_ts": 92728, "num_target_updates": 183}, "done": false, "episodes_total": 55, "training_iteration": 93, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-49-48", "timestamp": 1619873388, "time_this_iter_s": 13.228307485580444, "time_total_s": 1197.9149992465973, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1197.9149992465973, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.742105263157896, "ram_util_percent": 58.09473684210526}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8344727272727273, "episode_len_mean": 1690.5636363636363, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8344727272727273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005]}, "sampler_perf": {"mean_env_wait_ms": 1.6766045676578372, "mean_raw_obs_processing_ms": 1.585795830269388, "mean_inference_ms": 2.1294852750422004, "mean_action_processing_ms": 0.07266640605183311}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 94000, "timers": {"learn_time_ms": 17.597, "learn_throughput": 1818.503, "update_time_ms": 2.131}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0008894567145034671, "cur_lr": 0.0005, "mean_q": 0.027736429125070572, "min_q": -0.1325966715812683, "max_q": 0.0554467998445034, "mean_td_error": -0.0061659119091928005}}, "num_steps_sampled": 94000, "num_steps_trained": 744032, "last_target_update_ts": 93736, "num_target_updates": 185}, "done": false, "episodes_total": 55, "training_iteration": 94, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-50-01", "timestamp": 1619873401, "time_this_iter_s": 13.34291410446167, "time_total_s": 1211.257913351059, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa464b9d8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1211.257913351059, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 21.02631578947369, "ram_util_percent": 58.03684210526315}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8373839285714286, "episode_len_mean": 1692.5892857142858, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8373839285714286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9975, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005], "episode_lengths": [1804, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002], "policy_pol_reward": [-0.9975, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005]}, "sampler_perf": {"mean_env_wait_ms": 1.6772342673215952, "mean_raw_obs_processing_ms": 1.5856350364334244, "mean_inference_ms": 2.130186479810086, "mean_action_processing_ms": 0.07268690080115223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 95000, "timers": {"learn_time_ms": 18.065, "learn_throughput": 1771.341, "update_time_ms": 2.728}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002477300586178899, "cur_lr": 0.0005, "mean_q": 0.014754878357052803, "min_q": -0.14118720591068268, "max_q": 0.043588992208242416, "mean_td_error": 0.046451225876808167}}, "num_steps_sampled": 95000, "num_steps_trained": 752032, "last_target_update_ts": 94744, "num_target_updates": 187}, "done": false, "episodes_total": 56, "training_iteration": 95, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-50-15", "timestamp": 1619873415, "time_this_iter_s": 13.337041139602661, "time_total_s": 1224.5949544906616, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa464b730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1224.5949544906616, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.23684210526316, "ram_util_percent": 58.01052631578946}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8402368421052632, "episode_len_mean": 1683.719298245614, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8402368421052632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975], "episode_lengths": [1187, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975]}, "sampler_perf": {"mean_env_wait_ms": 1.6778416735477102, "mean_raw_obs_processing_ms": 1.5855051872932995, "mean_inference_ms": 2.1308626151234304, "mean_action_processing_ms": 0.07270666786074491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"learn_time_ms": 19.272, "learn_throughput": 1660.432, "update_time_ms": 2.622}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0014329982222989202, "cur_lr": 0.0005, "mean_q": 0.013568613678216934, "min_q": -0.16979166865348816, "max_q": 0.04817758873105049, "mean_td_error": -0.007667395286262035}}, "num_steps_sampled": 96000, "num_steps_trained": 760032, "last_target_update_ts": 95752, "num_target_updates": 189}, "done": false, "episodes_total": 57, "training_iteration": 96, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-50-28", "timestamp": 1619873428, "time_this_iter_s": 13.35212779045105, "time_total_s": 1237.9470822811127, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465fae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1237.9470822811127, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.8, "ram_util_percent": 58.05}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8402368421052631, "episode_len_mean": 1683.719298245614, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8402368421052631}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.67784167354771, "mean_raw_obs_processing_ms": 1.5855051872932993, "mean_inference_ms": 2.1308626151234304, "mean_action_processing_ms": 0.07270666786074491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 97000, "timers": {"learn_time_ms": 18.622, "learn_throughput": 1718.367, "update_time_ms": 2.232}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0023249418009072542, "cur_lr": 0.0005, "mean_q": 0.018002495169639587, "min_q": -0.2534182369709015, "max_q": 0.04776408150792122, "mean_td_error": -0.010519975796341896}}, "num_steps_sampled": 97000, "num_steps_trained": 768032, "last_target_update_ts": 96760, "num_target_updates": 191}, "done": false, "episodes_total": 57, "training_iteration": 97, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-50-41", "timestamp": 1619873441, "time_this_iter_s": 13.125108003616333, "time_total_s": 1251.072190284729, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a3b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3268>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1251.072190284729, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.511111111111106, "ram_util_percent": 58.07777777777778}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8429741379310346, "episode_len_mean": 1680.3275862068965, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8429741379310346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.999, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0], "episode_lengths": [1487, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187], "policy_pol_reward": [-0.999, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6784243092732465, "mean_raw_obs_processing_ms": 1.585390364395204, "mean_inference_ms": 2.1315148364540732, "mean_action_processing_ms": 0.0727257163208566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 98000, "timers": {"learn_time_ms": 18.791, "learn_throughput": 1702.912, "update_time_ms": 2.366}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.006011120975017548, "cur_lr": 0.0005, "mean_q": 0.041054412722587585, "min_q": -0.07175008952617645, "max_q": 0.07407825440168381, "mean_td_error": 0.009973643347620964}}, "num_steps_sampled": 98000, "num_steps_trained": 776032, "last_target_update_ts": 97768, "num_target_updates": 193}, "done": false, "episodes_total": 58, "training_iteration": 98, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-50-54", "timestamp": 1619873454, "time_this_iter_s": 12.65356731414795, "time_total_s": 1263.725757598877, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4474d06378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa464bea0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1263.725757598877, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 20.46666666666667, "ram_util_percent": 58.08888888888888}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8456355932203391, "episode_len_mean": 1674.1694915254238, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8456355932203391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999], "episode_lengths": [1317, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999]}, "sampler_perf": {"mean_env_wait_ms": 1.6789897044492457, "mean_raw_obs_processing_ms": 1.585326233540995, "mean_inference_ms": 2.132148908302381, "mean_action_processing_ms": 0.07274421887871778}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 99000, "timers": {"learn_time_ms": 18.445, "learn_throughput": 1734.9, "update_time_ms": 2.368}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005357172340154648, "cur_lr": 0.0005, "mean_q": 0.046280086040496826, "min_q": -0.03534328565001488, "max_q": 0.06811289489269257, "mean_td_error": 0.030383262783288956}}, "num_steps_sampled": 99000, "num_steps_trained": 784032, "last_target_update_ts": 98776, "num_target_updates": 195}, "done": false, "episodes_total": 59, "training_iteration": 99, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-51-08", "timestamp": 1619873468, "time_this_iter_s": 13.351783752441406, "time_total_s": 1277.0775413513184, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643b70>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1277.0775413513184, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 21.490000000000002, "ram_util_percent": 57.964999999999996}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.845635593220339, "episode_len_mean": 1674.1694915254238, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.845635593220339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6789897044492457, "mean_raw_obs_processing_ms": 1.5853262335409948, "mean_inference_ms": 2.1321489083023804, "mean_action_processing_ms": 0.07274421887871779}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100000, "timers": {"learn_time_ms": 17.593, "learn_throughput": 1818.888, "update_time_ms": 2.355}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0043599302880465984, "cur_lr": 0.0005, "mean_q": 0.028091901913285255, "min_q": -0.21490469574928284, "max_q": 0.058084938675165176, "mean_td_error": 0.020601391792297363}}, "num_steps_sampled": 100000, "num_steps_trained": 792032, "last_target_update_ts": 99784, "num_target_updates": 197}, "done": false, "episodes_total": 59, "training_iteration": 100, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-51-21", "timestamp": 1619873481, "time_this_iter_s": 12.98973536491394, "time_total_s": 1290.0672767162323, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa464b730>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1290.0672767162323, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.938888888888886, "ram_util_percent": 58.016666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.845635593220339, "episode_len_mean": 1674.1694915254238, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.845635593220339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6789897044492457, "mean_raw_obs_processing_ms": 1.5853262335409948, "mean_inference_ms": 2.1321489083023804, "mean_action_processing_ms": 0.07274421887871779}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 101000, "timers": {"learn_time_ms": 18.186, "learn_throughput": 1759.561, "update_time_ms": 2.211}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0070348517037928104, "cur_lr": 0.0005, "mean_q": 0.04321777820587158, "min_q": -0.04794049635529518, "max_q": 0.06848961114883423, "mean_td_error": 0.03340582177042961}}, "num_steps_sampled": 101000, "num_steps_trained": 800032, "last_target_update_ts": 100792, "num_target_updates": 199}, "done": false, "episodes_total": 59, "training_iteration": 101, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-51-34", "timestamp": 1619873494, "time_this_iter_s": 13.316739559173584, "time_total_s": 1303.3840162754059, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa464b950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1303.3840162754059, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.878947368421052, "ram_util_percent": 58.01052631578948}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.845635593220339, "episode_len_mean": 1674.1694915254238, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.845635593220339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6789897044492457, "mean_raw_obs_processing_ms": 1.5853262335409948, "mean_inference_ms": 2.1321489083023804, "mean_action_processing_ms": 0.07274421887871779}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 102000, "timers": {"learn_time_ms": 16.789, "learn_throughput": 1905.968, "update_time_ms": 2.237}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00210575177334249, "cur_lr": 0.0005, "mean_q": 0.02911573462188244, "min_q": -0.12357760965824127, "max_q": 0.04380255192518234, "mean_td_error": -0.005916015710681677}}, "num_steps_sampled": 102000, "num_steps_trained": 808032, "last_target_update_ts": 101800, "num_target_updates": 201}, "done": false, "episodes_total": 59, "training_iteration": 102, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-51-47", "timestamp": 1619873507, "time_this_iter_s": 12.91059684753418, "time_total_s": 1316.29461312294, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1316.29461312294, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 18.36842105263158, "ram_util_percent": 57.98421052631579}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8343032786885247, "episode_len_mean": 1685.8360655737704, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8343032786885247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0], "episode_lengths": [4002, 58, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317], "policy_pol_reward": [0.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6800913785949159, "mean_raw_obs_processing_ms": 1.585008984019155, "mean_inference_ms": 2.1333499254010913, "mean_action_processing_ms": 0.07277921024776855}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 103000, "timers": {"learn_time_ms": 15.099, "learn_throughput": 2119.322, "update_time_ms": 2.032}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004233822226524353, "cur_lr": 0.0005, "mean_q": 0.019391590729355812, "min_q": -0.06716941297054291, "max_q": 0.04581860825419426, "mean_td_error": 0.028775284066796303}}, "num_steps_sampled": 103000, "num_steps_trained": 816032, "last_target_update_ts": 102808, "num_target_updates": 203}, "done": false, "episodes_total": 61, "training_iteration": 103, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-51-59", "timestamp": 1619873519, "time_this_iter_s": 11.976185083389282, "time_total_s": 1328.2707982063293, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7620>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1328.2707982063293, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.888235294117646, "ram_util_percent": 57.976470588235294}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8343032786885246, "episode_len_mean": 1685.8360655737704, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8343032786885246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6800913785949159, "mean_raw_obs_processing_ms": 1.5850089840191548, "mean_inference_ms": 2.1333499254010913, "mean_action_processing_ms": 0.07277921024776857}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timers": {"learn_time_ms": 19.102, "learn_throughput": 1675.221, "update_time_ms": 2.33}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036842143163084984, "cur_lr": 0.0005, "mean_q": 0.011530226096510887, "min_q": -0.06986447423696518, "max_q": 0.03333111107349396, "mean_td_error": 0.026988433673977852}}, "num_steps_sampled": 104000, "num_steps_trained": 824032, "last_target_update_ts": 103816, "num_target_updates": 205}, "done": false, "episodes_total": 61, "training_iteration": 104, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-52-12", "timestamp": 1619873532, "time_this_iter_s": 12.519322156906128, "time_total_s": 1340.7901203632355, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1340.7901203632355, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.28333333333333, "ram_util_percent": 58.06666666666667}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8343032786885246, "episode_len_mean": 1685.8360655737704, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8343032786885246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6800913785949159, "mean_raw_obs_processing_ms": 1.5850089840191548, "mean_inference_ms": 2.1333499254010913, "mean_action_processing_ms": 0.07277921024776857}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 105000, "timers": {"learn_time_ms": 18.462, "learn_throughput": 1733.257, "update_time_ms": 2.445}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002162752440199256, "cur_lr": 0.0005, "mean_q": -0.014242570847272873, "min_q": -0.23914694786071777, "max_q": 0.02887818217277527, "mean_td_error": 0.013033214025199413}}, "num_steps_sampled": 105000, "num_steps_trained": 832032, "last_target_update_ts": 104824, "num_target_updates": 207}, "done": false, "episodes_total": 61, "training_iteration": 105, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-52-25", "timestamp": 1619873545, "time_this_iter_s": 13.145902872085571, "time_total_s": 1353.936023235321, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46439d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643620>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1353.936023235321, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 16.88947368421053, "ram_util_percent": 58.01578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8343032786885246, "episode_len_mean": 1685.8360655737704, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8343032786885246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6800913785949159, "mean_raw_obs_processing_ms": 1.5850089840191548, "mean_inference_ms": 2.1333499254010913, "mean_action_processing_ms": 0.07277921024776857}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 106000, "timers": {"learn_time_ms": 17.436, "learn_throughput": 1835.283, "update_time_ms": 2.31}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013941703364253044, "cur_lr": 0.0005, "mean_q": -0.008074654266238213, "min_q": -0.16211123764514923, "max_q": 0.015288857743144035, "mean_td_error": -0.003980058711022139}}, "num_steps_sampled": 106000, "num_steps_trained": 840032, "last_target_update_ts": 105832, "num_target_updates": 209}, "done": false, "episodes_total": 61, "training_iteration": 106, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-52-38", "timestamp": 1619873558, "time_this_iter_s": 12.899162530899048, "time_total_s": 1366.83518576622, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465fae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1366.83518576622, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 18.555555555555557, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8394880952380953, "episode_len_mean": 1697.126984126984, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8394880952380953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99525, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0], "episode_lengths": [3324, 759, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58], "policy_pol_reward": [-0.99525, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.681118792375795, "mean_raw_obs_processing_ms": 1.5848019712975723, "mean_inference_ms": 2.134444759503014, "mean_action_processing_ms": 0.07281033506185965}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 107000, "timers": {"learn_time_ms": 16.359, "learn_throughput": 1956.167, "update_time_ms": 2.258}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.000678703305311501, "cur_lr": 0.0005, "mean_q": -0.010281587019562721, "min_q": -0.09866601228713989, "max_q": 0.010500526987016201, "mean_td_error": -0.003210306167602539}}, "num_steps_sampled": 107000, "num_steps_trained": 848032, "last_target_update_ts": 106840, "num_target_updates": 211}, "done": false, "episodes_total": 63, "training_iteration": 107, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-52-51", "timestamp": 1619873571, "time_this_iter_s": 13.321348905563354, "time_total_s": 1380.1565346717834, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b58c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1380.1565346717834, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 18.105263157894733, "ram_util_percent": 58.047368421052624}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8394880952380952, "episode_len_mean": 1697.126984126984, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8394880952380952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.681118792375795, "mean_raw_obs_processing_ms": 1.5848019712975725, "mean_inference_ms": 2.134444759503015, "mean_action_processing_ms": 0.07281033506185965}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"learn_time_ms": 18.946, "learn_throughput": 1689.004, "update_time_ms": 2.433}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001935928943566978, "cur_lr": 0.0005, "mean_q": -0.0012313402257859707, "min_q": -0.19309468567371368, "max_q": 0.021723030135035515, "mean_td_error": -0.003046436235308647}}, "num_steps_sampled": 108000, "num_steps_trained": 856032, "last_target_update_ts": 107848, "num_target_updates": 213}, "done": false, "episodes_total": 63, "training_iteration": 108, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-53-04", "timestamp": 1619873584, "time_this_iter_s": 12.926976442337036, "time_total_s": 1393.0835111141205, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46436a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46438c8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1393.0835111141205, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 21.30526315789474, "ram_util_percent": 58.084210526315786}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.84199609375, "episode_len_mean": 1698.5, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.84199609375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0], "episode_lengths": [1785, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6816135803766288, "mean_raw_obs_processing_ms": 1.5847022571239586, "mean_inference_ms": 2.134973223020668, "mean_action_processing_ms": 0.07282519529772702}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 109000, "timers": {"learn_time_ms": 17.058, "learn_throughput": 1875.901, "update_time_ms": 2.227}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0010895247105509043, "cur_lr": 0.0005, "mean_q": 0.017480026930570602, "min_q": 0.0014128684997558594, "max_q": 0.03209807723760605, "mean_td_error": 0.003591592889279127}}, "num_steps_sampled": 109000, "num_steps_trained": 864032, "last_target_update_ts": 108856, "num_target_updates": 215}, "done": false, "episodes_total": 64, "training_iteration": 109, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-53-17", "timestamp": 1619873597, "time_this_iter_s": 12.928082704544067, "time_total_s": 1406.0115938186646, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1406.0115938186646, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 21.027777777777775, "ram_util_percent": 58.01111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.84199609375, "episode_len_mean": 1698.5, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.84199609375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6816135803766288, "mean_raw_obs_processing_ms": 1.5847022571239586, "mean_inference_ms": 2.134973223020668, "mean_action_processing_ms": 0.07282519529772702}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 110000, "timers": {"learn_time_ms": 16.9, "learn_throughput": 1893.46, "update_time_ms": 2.441}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0008788093691691756, "cur_lr": 0.0005, "mean_q": 0.014348715543746948, "min_q": -0.08789943158626556, "max_q": 0.030393870547413826, "mean_td_error": -0.0033361362293362617}}, "num_steps_sampled": 110000, "num_steps_trained": 872032, "last_target_update_ts": 109864, "num_target_updates": 217}, "done": false, "episodes_total": 64, "training_iteration": 110, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-53-30", "timestamp": 1619873610, "time_this_iter_s": 13.1095130443573, "time_total_s": 1419.1211068630219, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b4510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1419.1211068630219, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 19.40526315789474, "ram_util_percent": 58.10526315789474}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.84199609375, "episode_len_mean": 1698.5, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.84199609375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6816135803766288, "mean_raw_obs_processing_ms": 1.5847022571239586, "mean_inference_ms": 2.134973223020668, "mean_action_processing_ms": 0.07282519529772702}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 111000, "timers": {"learn_time_ms": 18.63, "learn_throughput": 1717.631, "update_time_ms": 2.241}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.000697816489264369, "cur_lr": 0.0005, "mean_q": 0.00518941693007946, "min_q": -0.014808299019932747, "max_q": 0.019704999402165413, "mean_td_error": 0.0012377204839140177}}, "num_steps_sampled": 111000, "num_steps_trained": 880032, "last_target_update_ts": 110872, "num_target_updates": 219}, "done": false, "episodes_total": 64, "training_iteration": 111, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-53-43", "timestamp": 1619873623, "time_this_iter_s": 12.860602378845215, "time_total_s": 1431.981709241867, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46436a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1431.981709241867, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 23.944444444444443, "ram_util_percent": 58.083333333333336}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8443615384615384, "episode_len_mean": 1714.323076923077, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8443615384615384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99575, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0], "episode_lengths": [2727, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785], "policy_pol_reward": [-0.99575, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6821138903659665, "mean_raw_obs_processing_ms": 1.5846138859215377, "mean_inference_ms": 2.135508501310495, "mean_action_processing_ms": 0.07284016633319647}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 112000, "timers": {"learn_time_ms": 17.733, "learn_throughput": 1804.53, "update_time_ms": 2.273}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002358392346650362, "cur_lr": 0.0005, "mean_q": -0.020594444125890732, "min_q": -0.16682517528533936, "max_q": 0.005158956162631512, "mean_td_error": 0.01502112578600645}}, "num_steps_sampled": 112000, "num_steps_trained": 888032, "last_target_update_ts": 111880, "num_target_updates": 221}, "done": false, "episodes_total": 65, "training_iteration": 112, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-53-57", "timestamp": 1619873637, "time_this_iter_s": 13.486873626708984, "time_total_s": 1445.468582868576, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b4d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b4488>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1445.468582868576, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 19.547368421052635, "ram_util_percent": 58.23157894736841}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8443615384615384, "episode_len_mean": 1714.323076923077, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8443615384615384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.6821138903659667, "mean_raw_obs_processing_ms": 1.584613885921538, "mean_inference_ms": 2.135508501310495, "mean_action_processing_ms": 0.07284016633319645}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 113000, "timers": {"learn_time_ms": 17.992, "learn_throughput": 1778.559, "update_time_ms": 2.276}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0007742929738014936, "cur_lr": 0.0005, "mean_q": 0.001480049453675747, "min_q": -0.019900169223546982, "max_q": 0.015798434615135193, "mean_td_error": -8.969046757556498e-05}}, "num_steps_sampled": 113000, "num_steps_trained": 896032, "last_target_update_ts": 112888, "num_target_updates": 223}, "done": false, "episodes_total": 65, "training_iteration": 113, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-54-10", "timestamp": 1619873650, "time_this_iter_s": 13.408543586730957, "time_total_s": 1458.877126455307, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1458.877126455307, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 19.415, "ram_util_percent": 58.235000000000014}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8489552238805971, "episode_len_mean": 1698.0746268656717, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8489552238805971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9965, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575], "episode_lengths": [2322, 18, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727], "policy_pol_reward": [-0.9965, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.6830614512914346, "mean_raw_obs_processing_ms": 1.5845524712693895, "mean_inference_ms": 2.1365245906307138, "mean_action_processing_ms": 0.07286831971642094}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 114000, "timers": {"learn_time_ms": 18.819, "learn_throughput": 1700.39, "update_time_ms": 2.889}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011691858526319265, "cur_lr": 0.0005, "mean_q": 0.0013599644880741835, "min_q": -0.12078098207712173, "max_q": 0.025386814028024673, "mean_td_error": -0.003804434323683381}}, "num_steps_sampled": 114000, "num_steps_trained": 904032, "last_target_update_ts": 113896, "num_target_updates": 225}, "done": false, "episodes_total": 67, "training_iteration": 114, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-54-23", "timestamp": 1619873663, "time_this_iter_s": 13.13382601737976, "time_total_s": 1472.0109524726868, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1472.0109524726868, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 20.916666666666668, "ram_util_percent": 58.24444444444444}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8511764705882352, "episode_len_mean": 1688.7794117647059, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8511764705882352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0], "episode_lengths": [1066, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6835186793727608, "mean_raw_obs_processing_ms": 1.5845315502372423, "mean_inference_ms": 2.137014315315692, "mean_action_processing_ms": 0.07288193520774168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 115000, "timers": {"learn_time_ms": 18.552, "learn_throughput": 1724.842, "update_time_ms": 3.088}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002763503696769476, "cur_lr": 0.0005, "mean_q": -0.009485393762588501, "min_q": -0.13478824496269226, "max_q": 0.012771625071763992, "mean_td_error": -0.013552272692322731}}, "num_steps_sampled": 115000, "num_steps_trained": 912032, "last_target_update_ts": 114904, "num_target_updates": 227}, "done": false, "episodes_total": 68, "training_iteration": 115, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-54-37", "timestamp": 1619873677, "time_this_iter_s": 13.31354284286499, "time_total_s": 1485.3244953155518, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45c1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1488>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1485.3244953155518, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 20.789473684210527, "ram_util_percent": 58.252631578947366}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8511764705882352, "episode_len_mean": 1688.7794117647059, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8511764705882352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.683518679372761, "mean_raw_obs_processing_ms": 1.5845315502372423, "mean_inference_ms": 2.137014315315692, "mean_action_processing_ms": 0.07288193520774167}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 116000, "timers": {"learn_time_ms": 17.331, "learn_throughput": 1846.351, "update_time_ms": 2.373}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004282854031771421, "cur_lr": 0.0005, "mean_q": 0.00399938877671957, "min_q": -0.1420406550168991, "max_q": 0.02704385295510292, "mean_td_error": 0.02659284695982933}}, "num_steps_sampled": 116000, "num_steps_trained": 920032, "last_target_update_ts": 115912, "num_target_updates": 229}, "done": false, "episodes_total": 68, "training_iteration": 116, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-54-50", "timestamp": 1619873690, "time_this_iter_s": 13.46550726890564, "time_total_s": 1498.7900025844574, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45c18c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1498.7900025844574, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 19.725, "ram_util_percent": 58.32000000000001}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8532789855072463, "episode_len_mean": 1693.1304347826087, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8532789855072463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99625, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0], "episode_lengths": [1989, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066], "policy_pol_reward": [-0.99625, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6839741036803757, "mean_raw_obs_processing_ms": 1.584507073565728, "mean_inference_ms": 2.1375081820506345, "mean_action_processing_ms": 0.07289570844255386}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 117000, "timers": {"learn_time_ms": 16.783, "learn_throughput": 1906.675, "update_time_ms": 2.222}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0031701812986284494, "cur_lr": 0.0005, "mean_q": -0.002514465944841504, "min_q": -0.03004385344684124, "max_q": 0.018147151917219162, "mean_td_error": -0.005632135085761547}}, "num_steps_sampled": 117000, "num_steps_trained": 928032, "last_target_update_ts": 116920, "num_target_updates": 231}, "done": false, "episodes_total": 69, "training_iteration": 117, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-55-04", "timestamp": 1619873704, "time_this_iter_s": 13.577915906906128, "time_total_s": 1512.3679184913635, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46437b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643950>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1512.3679184913635, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 19.39473684210526, "ram_util_percent": 58.23684210526316}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.855375, "episode_len_mean": 1675.7, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.855375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625], "episode_lengths": [473, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625]}, "sampler_perf": {"mean_env_wait_ms": 1.684405788704335, "mean_raw_obs_processing_ms": 1.5844712874136595, "mean_inference_ms": 2.1379763384999224, "mean_action_processing_ms": 0.0729087513406633}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 118000, "timers": {"learn_time_ms": 18.2, "learn_throughput": 1758.268, "update_time_ms": 2.612}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002546026138588786, "cur_lr": 0.0005, "mean_q": -0.00391707057133317, "min_q": -0.176853746175766, "max_q": 0.01270337775349617, "mean_td_error": 0.0008866754360496998}}, "num_steps_sampled": 118000, "num_steps_trained": 936032, "last_target_update_ts": 117928, "num_target_updates": 233}, "done": false, "episodes_total": 70, "training_iteration": 118, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-55-16", "timestamp": 1619873716, "time_this_iter_s": 12.474128484725952, "time_total_s": 1524.8420469760895, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1524.8420469760895, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 22.08888888888889, "ram_util_percent": 58.28333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.855375, "episode_len_mean": 1675.7, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.855375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6844057887043353, "mean_raw_obs_processing_ms": 1.5844712874136597, "mean_inference_ms": 2.1379763384999224, "mean_action_processing_ms": 0.07290875134066328}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 119000, "timers": {"learn_time_ms": 18.26, "learn_throughput": 1752.489, "update_time_ms": 2.357}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003141565015539527, "cur_lr": 0.0005, "mean_q": -0.023682910948991776, "min_q": -0.26230695843696594, "max_q": 0.015598263591527939, "mean_td_error": -0.01506100781261921}}, "num_steps_sampled": 119000, "num_steps_trained": 944032, "last_target_update_ts": 118936, "num_target_updates": 235}, "done": false, "episodes_total": 70, "training_iteration": 119, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-55-30", "timestamp": 1619873730, "time_this_iter_s": 13.155689001083374, "time_total_s": 1537.9977359771729, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1537.9977359771729, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.85789473684211, "ram_util_percent": 58.357894736842105}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.855375, "episode_len_mean": 1675.7, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.855375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6844057887043353, "mean_raw_obs_processing_ms": 1.5844712874136597, "mean_inference_ms": 2.1379763384999224, "mean_action_processing_ms": 0.07290875134066328}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"learn_time_ms": 18.897, "learn_throughput": 1693.368, "update_time_ms": 2.621}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004399533849209547, "cur_lr": 0.0005, "mean_q": -0.022248249500989914, "min_q": -0.19275958836078644, "max_q": -0.001961156725883484, "mean_td_error": 0.024538123980164528}}, "num_steps_sampled": 120000, "num_steps_trained": 952032, "last_target_update_ts": 119944, "num_target_updates": 237}, "done": false, "episodes_total": 70, "training_iteration": 120, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-55-42", "timestamp": 1619873742, "time_this_iter_s": 12.771661281585693, "time_total_s": 1550.7693972587585, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1550.7693972587585, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.177777777777777, "ram_util_percent": 58.388888888888886}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8574119718309859, "episode_len_mean": 1691.0704225352113, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8574119718309859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0], "episode_lengths": [2767, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.68484034174842, "mean_raw_obs_processing_ms": 1.584367615595044, "mean_inference_ms": 2.1384518938795885, "mean_action_processing_ms": 0.072921994428478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 121000, "timers": {"learn_time_ms": 20.577, "learn_throughput": 1555.109, "update_time_ms": 2.753}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0024441969580948353, "cur_lr": 0.0005, "mean_q": -0.015111935324966908, "min_q": -0.17774996161460876, "max_q": 0.004505716264247894, "mean_td_error": -0.0010117993224412203}}, "num_steps_sampled": 121000, "num_steps_trained": 960032, "last_target_update_ts": 120952, "num_target_updates": 239}, "done": false, "episodes_total": 71, "training_iteration": 121, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-55-56", "timestamp": 1619873756, "time_this_iter_s": 13.324173212051392, "time_total_s": 1564.09357047081, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf488>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1564.09357047081, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 20.74736842105263, "ram_util_percent": 58.273684210526305}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8593923611111111, "episode_len_mean": 1685.4444444444443, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8593923611111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0], "episode_lengths": [1286, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6852654477626245, "mean_raw_obs_processing_ms": 1.5842615285436814, "mean_inference_ms": 2.138920816499942, "mean_action_processing_ms": 0.07293547885280531}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 122000, "timers": {"learn_time_ms": 11.605, "learn_throughput": 2757.358, "update_time_ms": 1.601}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002335665049031377, "cur_lr": 0.0005, "mean_q": -0.020099278539419174, "min_q": -0.2543325126171112, "max_q": 0.0035405419766902924, "mean_td_error": -0.0038818304892629385}}, "num_steps_sampled": 122000, "num_steps_trained": 968032, "last_target_update_ts": 121960, "num_target_updates": 241}, "done": false, "episodes_total": 72, "training_iteration": 122, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-56-09", "timestamp": 1619873769, "time_this_iter_s": 13.287917375564575, "time_total_s": 1577.3814878463745, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b4510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1577.3814878463745, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 20.61578947368421, "ram_util_percent": 58.28421052631578}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8593923611111111, "episode_len_mean": 1685.4444444444443, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8593923611111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6852654477626245, "mean_raw_obs_processing_ms": 1.5842615285436814, "mean_inference_ms": 2.138920816499942, "mean_action_processing_ms": 0.07293547885280531}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 123000, "timers": {"learn_time_ms": 16.72, "learn_throughput": 1913.847, "update_time_ms": 2.284}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001622345531359315, "cur_lr": 0.0005, "mean_q": -0.018465174362063408, "min_q": -0.040548890829086304, "max_q": -0.0006927736103534698, "mean_td_error": -0.003549607703462243}}, "num_steps_sampled": 123000, "num_steps_trained": 976032, "last_target_update_ts": 122968, "num_target_updates": 243}, "done": false, "episodes_total": 72, "training_iteration": 123, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-56-21", "timestamp": 1619873781, "time_this_iter_s": 11.76210618019104, "time_total_s": 1589.1435940265656, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1589.1435940265656, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 20.817647058823532, "ram_util_percent": 58.311764705882354}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8593923611111111, "episode_len_mean": 1685.4444444444443, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8593923611111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6852654477626245, "mean_raw_obs_processing_ms": 1.5842615285436814, "mean_inference_ms": 2.138920816499942, "mean_action_processing_ms": 0.07293547885280531}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124000, "timers": {"learn_time_ms": 18.791, "learn_throughput": 1702.955, "update_time_ms": 2.509}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020020254887640476, "cur_lr": 0.0005, "mean_q": -0.003770271083340049, "min_q": -0.03362136706709862, "max_q": 0.028393074870109558, "mean_td_error": -0.0020233357790857553}}, "num_steps_sampled": 124000, "num_steps_trained": 984032, "last_target_update_ts": 123976, "num_target_updates": 245}, "done": false, "episodes_total": 72, "training_iteration": 124, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-56-33", "timestamp": 1619873793, "time_this_iter_s": 12.51380467414856, "time_total_s": 1601.657398700714, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b4d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465fae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1601.657398700714, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 19.450000000000003, "ram_util_percent": 58.266666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8613184931506849, "episode_len_mean": 1699.6027397260275, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8613184931506849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0], "episode_lengths": [2719, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6856523956800527, "mean_raw_obs_processing_ms": 1.5840959858244803, "mean_inference_ms": 2.1393492542291863, "mean_action_processing_ms": 0.07294751278733448}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 125000, "timers": {"learn_time_ms": 14.91, "learn_throughput": 2146.237, "update_time_ms": 2.341}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0025328684132546186, "cur_lr": 0.0005, "mean_q": -0.011864842846989632, "min_q": -0.18719007074832916, "max_q": 0.02452549897134304, "mean_td_error": -0.01268988661468029}}, "num_steps_sampled": 125000, "num_steps_trained": 992032, "last_target_update_ts": 124984, "num_target_updates": 247}, "done": false, "episodes_total": 73, "training_iteration": 125, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-56-46", "timestamp": 1619873806, "time_this_iter_s": 12.213940620422363, "time_total_s": 1613.8713393211365, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b48c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a4510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1613.8713393211365, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 21.882352941176475, "ram_util_percent": 58.23529411764705}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8613184931506849, "episode_len_mean": 1699.6027397260275, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8613184931506849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6856523956800529, "mean_raw_obs_processing_ms": 1.58409598582448, "mean_inference_ms": 2.1393492542291868, "mean_action_processing_ms": 0.07294751278733447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 126000, "timers": {"learn_time_ms": 15.813, "learn_throughput": 2023.64, "update_time_ms": 2.244}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003354487009346485, "cur_lr": 0.0005, "mean_q": -0.009982669726014137, "min_q": -0.09750290215015411, "max_q": 0.010917800478637218, "mean_td_error": -0.008126947097480297}}, "num_steps_sampled": 126000, "num_steps_trained": 1000032, "last_target_update_ts": 125992, "num_target_updates": 249}, "done": false, "episodes_total": 73, "training_iteration": 126, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-56-59", "timestamp": 1619873819, "time_this_iter_s": 12.94785475730896, "time_total_s": 1626.8191940784454, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1626.8191940784454, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.442105263157895, "ram_util_percent": 58.39473684210526}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8613184931506849, "episode_len_mean": 1699.6027397260275, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8613184931506849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6856523956800529, "mean_raw_obs_processing_ms": 1.58409598582448, "mean_inference_ms": 2.1393492542291868, "mean_action_processing_ms": 0.07294751278733447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 127000, "timers": {"learn_time_ms": 18.92, "learn_throughput": 1691.324, "update_time_ms": 2.605}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0022657185327261686, "cur_lr": 0.0005, "mean_q": -0.007183630019426346, "min_q": -0.12615446746349335, "max_q": 0.020380381494760513, "mean_td_error": 0.002658840734511614}}, "num_steps_sampled": 127000, "num_steps_trained": 1008032, "last_target_update_ts": 127000, "num_target_updates": 251}, "done": false, "episodes_total": 73, "training_iteration": 127, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-57-12", "timestamp": 1619873832, "time_this_iter_s": 13.402125597000122, "time_total_s": 1640.2213196754456, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a4d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a4158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1640.2213196754456, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 21.01578947368421, "ram_util_percent": 58.31578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8631283783783783, "episode_len_mean": 1728.3513513513512, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8631283783783783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99525, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [3827, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719], "policy_pol_reward": [-0.99525, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6860437556095509, "mean_raw_obs_processing_ms": 1.583949052391402, "mean_inference_ms": 2.1397847080828525, "mean_action_processing_ms": 0.0729602923542012}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 128000, "timers": {"learn_time_ms": 20.349, "learn_throughput": 1572.553, "update_time_ms": 2.899}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027355682104825974, "cur_lr": 0.0005, "mean_q": -0.00898565910756588, "min_q": -0.01894048973917961, "max_q": 0.0029807277023792267, "mean_td_error": -0.006752885412424803}}, "num_steps_sampled": 128000, "num_steps_trained": 1016032, "last_target_update_ts": 127504, "num_target_updates": 252}, "done": false, "episodes_total": 74, "training_iteration": 128, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-57-26", "timestamp": 1619873846, "time_this_iter_s": 13.802523136138916, "time_total_s": 1654.0238428115845, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1654.0238428115845, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.999999999999996, "ram_util_percent": 58.30499999999999}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8631283783783783, "episode_len_mean": 1728.3513513513512, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8631283783783783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525]}, "sampler_perf": {"mean_env_wait_ms": 1.686043755609551, "mean_raw_obs_processing_ms": 1.583949052391402, "mean_inference_ms": 2.1397847080828525, "mean_action_processing_ms": 0.0729602923542012}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 129000, "timers": {"learn_time_ms": 20.84, "learn_throughput": 1535.528, "update_time_ms": 2.581}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017024553380906582, "cur_lr": 0.0005, "mean_q": -0.007435919716954231, "min_q": -0.09234683960676193, "max_q": 0.014434311538934708, "mean_td_error": -0.0045981635339558125}}, "num_steps_sampled": 129000, "num_steps_trained": 1024032, "last_target_update_ts": 128512, "num_target_updates": 254}, "done": false, "episodes_total": 74, "training_iteration": 129, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-57-39", "timestamp": 1619873859, "time_this_iter_s": 13.184247016906738, "time_total_s": 1667.2080898284912, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46436a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643b70>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1667.2080898284912, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 19.663157894736845, "ram_util_percent": 58.27894736842105}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8631283783783783, "episode_len_mean": 1728.3513513513512, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8631283783783783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525]}, "sampler_perf": {"mean_env_wait_ms": 1.686043755609551, "mean_raw_obs_processing_ms": 1.583949052391402, "mean_inference_ms": 2.1397847080828525, "mean_action_processing_ms": 0.0729602923542012}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 130000, "timers": {"learn_time_ms": 20.198, "learn_throughput": 1584.337, "update_time_ms": 2.424}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002660602331161499, "cur_lr": 0.0005, "mean_q": -0.008487917482852936, "min_q": -0.17995813488960266, "max_q": 0.015353308990597725, "mean_td_error": 0.01911027356982231}}, "num_steps_sampled": 130000, "num_steps_trained": 1032032, "last_target_update_ts": 129520, "num_target_updates": 256}, "done": false, "episodes_total": 74, "training_iteration": 130, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-57-53", "timestamp": 1619873873, "time_this_iter_s": 13.498992919921875, "time_total_s": 1680.707082748413, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b5d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1680.707082748413, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 21.626315789473683, "ram_util_percent": 58.305263157894736}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8631283783783783, "episode_len_mean": 1728.3513513513512, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8631283783783783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525]}, "sampler_perf": {"mean_env_wait_ms": 1.686043755609551, "mean_raw_obs_processing_ms": 1.583949052391402, "mean_inference_ms": 2.1397847080828525, "mean_action_processing_ms": 0.0729602923542012}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 131000, "timers": {"learn_time_ms": 18.76, "learn_throughput": 1705.725, "update_time_ms": 2.314}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036354439798742533, "cur_lr": 0.0005, "mean_q": -0.007534407079219818, "min_q": -0.14359889924526215, "max_q": 0.03519720956683159, "mean_td_error": -0.010885894298553467}}, "num_steps_sampled": 131000, "num_steps_trained": 1040032, "last_target_update_ts": 130528, "num_target_updates": 258}, "done": false, "episodes_total": 74, "training_iteration": 131, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-58-05", "timestamp": 1619873885, "time_this_iter_s": 12.398530006408691, "time_total_s": 1693.1056127548218, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b58c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a4510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1693.1056127548218, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.46666666666667, "ram_util_percent": 58.30555555555556}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8515933333333333, "episode_len_mean": 1758.6666666666667, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8515933333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.002, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525], "episode_lengths": [4002, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827], "policy_pol_reward": [0.002, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525]}, "sampler_perf": {"mean_env_wait_ms": 1.6864457395870562, "mean_raw_obs_processing_ms": 1.5837665831903653, "mean_inference_ms": 2.1402370608532983, "mean_action_processing_ms": 0.07297342740135736}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"learn_time_ms": 18.151, "learn_throughput": 1762.965, "update_time_ms": 2.326}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0062396470457315445, "cur_lr": 0.0005, "mean_q": 0.016095861792564392, "min_q": -0.13575559854507446, "max_q": 0.05686812847852707, "mean_td_error": 0.030438195914030075}}, "num_steps_sampled": 132000, "num_steps_trained": 1048032, "last_target_update_ts": 131536, "num_target_updates": 260}, "done": false, "episodes_total": 75, "training_iteration": 132, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-58-19", "timestamp": 1619873899, "time_this_iter_s": 13.475953102111816, "time_total_s": 1706.5815658569336, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414990d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1706.5815658569336, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 20.089473684210528, "ram_util_percent": 58.26315789473684}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.853546052631579, "episode_len_mean": 1742.8684210526317, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.853546052631579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002], "episode_lengths": [558, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002]}, "sampler_perf": {"mean_env_wait_ms": 1.6868438241220387, "mean_raw_obs_processing_ms": 1.5835922547540349, "mean_inference_ms": 2.1406843688167285, "mean_action_processing_ms": 0.07298638143625022}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 133000, "timers": {"learn_time_ms": 18.114, "learn_throughput": 1766.604, "update_time_ms": 2.333}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019021861953660846, "cur_lr": 0.0005, "mean_q": 0.02192501723766327, "min_q": -0.14000293612480164, "max_q": 0.0602383092045784, "mean_td_error": -0.006751193664968014}}, "num_steps_sampled": 133000, "num_steps_trained": 1056032, "last_target_update_ts": 132544, "num_target_updates": 262}, "done": false, "episodes_total": 76, "training_iteration": 133, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-58-33", "timestamp": 1619873913, "time_this_iter_s": 13.630544662475586, "time_total_s": 1720.2121105194092, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a4c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a4598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1720.2121105194092, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 16.363157894736847, "ram_util_percent": 58.34210526315788}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8535460526315788, "episode_len_mean": 1742.8684210526317, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8535460526315788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.686843824122039, "mean_raw_obs_processing_ms": 1.5835922547540349, "mean_inference_ms": 2.1406843688167285, "mean_action_processing_ms": 0.07298638143625022}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 134000, "timers": {"learn_time_ms": 17.752, "learn_throughput": 1802.63, "update_time_ms": 2.159}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002670209389179945, "cur_lr": 0.0005, "mean_q": 0.02580859884619713, "min_q": -0.08234074711799622, "max_q": 0.08744615316390991, "mean_td_error": -0.00794927030801773}}, "num_steps_sampled": 134000, "num_steps_trained": 1064032, "last_target_update_ts": 133552, "num_target_updates": 264}, "done": false, "episodes_total": 76, "training_iteration": 134, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-58-46", "timestamp": 1619873926, "time_this_iter_s": 12.979520320892334, "time_total_s": 1733.1916308403015, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1733.1916308403015, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.66842105263158, "ram_util_percent": 58.326315789473675}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8535460526315788, "episode_len_mean": 1742.8684210526317, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8535460526315788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.686843824122039, "mean_raw_obs_processing_ms": 1.5835922547540349, "mean_inference_ms": 2.1406843688167285, "mean_action_processing_ms": 0.07298638143625022}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 135000, "timers": {"learn_time_ms": 14.792, "learn_throughput": 2163.263, "update_time_ms": 2.497}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011473254999145865, "cur_lr": 0.0005, "mean_q": 0.04403890669345856, "min_q": -0.1110805869102478, "max_q": 0.09914922714233398, "mean_td_error": -0.0055349161848425865}}, "num_steps_sampled": 135000, "num_steps_trained": 1072032, "last_target_update_ts": 134560, "num_target_updates": 266}, "done": false, "episodes_total": 76, "training_iteration": 135, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-58-59", "timestamp": 1619873939, "time_this_iter_s": 13.116678476333618, "time_total_s": 1746.3083093166351, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46438c8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1746.3083093166351, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.24736842105263, "ram_util_percent": 58.23684210526316}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8572820512820513, "episode_len_mean": 1740.1538461538462, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8572820512820513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0], "episode_lengths": [2977, 297, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558], "policy_pol_reward": [-0.9985, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6876411727965785, "mean_raw_obs_processing_ms": 1.583225853908492, "mean_inference_ms": 2.1415629709086956, "mean_action_processing_ms": 0.07301201880277446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 136000, "timers": {"learn_time_ms": 19.273, "learn_throughput": 1660.36, "update_time_ms": 2.329}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003154759295284748, "cur_lr": 0.0005, "mean_q": 0.031057752668857574, "min_q": 0.004713531583547592, "max_q": 0.07028830796480179, "mean_td_error": -0.005181192886084318}}, "num_steps_sampled": 136000, "num_steps_trained": 1080032, "last_target_update_ts": 135568, "num_target_updates": 268}, "done": false, "episodes_total": 78, "training_iteration": 136, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-59-12", "timestamp": 1619873952, "time_this_iter_s": 13.206409215927124, "time_total_s": 1759.5147185325623, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b9d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b9488>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1759.5147185325623, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 18.405263157894737, "ram_util_percent": 58.20000000000001}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8572820512820513, "episode_len_mean": 1740.1538461538462, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8572820512820513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6876411727965785, "mean_raw_obs_processing_ms": 1.5832258539084918, "mean_inference_ms": 2.141562970908696, "mean_action_processing_ms": 0.07301201880277446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 137000, "timers": {"learn_time_ms": 18.636, "learn_throughput": 1717.081, "update_time_ms": 2.351}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0033356021158397198, "cur_lr": 0.0005, "mean_q": 0.037274569272994995, "min_q": 0.002571394667029381, "max_q": 0.10333782434463501, "mean_td_error": -0.0039987023919820786}}, "num_steps_sampled": 137000, "num_steps_trained": 1088032, "last_target_update_ts": 136576, "num_target_updates": 270}, "done": false, "episodes_total": 78, "training_iteration": 137, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-59-25", "timestamp": 1619873965, "time_this_iter_s": 12.802721738815308, "time_total_s": 1772.3174402713776, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4474d06378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1772.3174402713776, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 16.82222222222222, "ram_util_percent": 58.14444444444445}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8572820512820513, "episode_len_mean": 1740.1538461538462, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8572820512820513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6876411727965785, "mean_raw_obs_processing_ms": 1.5832258539084918, "mean_inference_ms": 2.141562970908696, "mean_action_processing_ms": 0.07301201880277446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 138000, "timers": {"learn_time_ms": 18.264, "learn_throughput": 1752.096, "update_time_ms": 2.893}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005025216843932867, "cur_lr": 0.0005, "mean_q": 0.040922071784734726, "min_q": -0.17122483253479004, "max_q": 0.09961395710706711, "mean_td_error": 0.021247072145342827}}, "num_steps_sampled": 138000, "num_steps_trained": 1096032, "last_target_update_ts": 137584, "num_target_updates": 272}, "done": false, "episodes_total": 78, "training_iteration": 138, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-59-38", "timestamp": 1619873978, "time_this_iter_s": 13.179558038711548, "time_total_s": 1785.496998310089, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1785.496998310089, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.91578947368421, "ram_util_percent": 58.08947368421053}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8572820512820513, "episode_len_mean": 1740.1538461538462, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8572820512820513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6876411727965785, "mean_raw_obs_processing_ms": 1.5832258539084918, "mean_inference_ms": 2.141562970908696, "mean_action_processing_ms": 0.07301201880277446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 139000, "timers": {"learn_time_ms": 19.876, "learn_throughput": 1610.007, "update_time_ms": 2.632}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0022403798066079617, "cur_lr": 0.0005, "mean_q": 0.032815203070640564, "min_q": -0.13791730999946594, "max_q": 0.09771791845560074, "mean_td_error": 0.01590750738978386}}, "num_steps_sampled": 139000, "num_steps_trained": 1104032, "last_target_update_ts": 138592, "num_target_updates": 274}, "done": false, "episodes_total": 78, "training_iteration": 139, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_21-59-51", "timestamp": 1619873991, "time_this_iter_s": 13.01140832901001, "time_total_s": 1798.5084066390991, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414990d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1798.5084066390991, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.855555555555558, "ram_util_percent": 58.03888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8608062500000001, "episode_len_mean": 1746.525, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8608062500000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9965, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0], "episode_lengths": [3795, 195, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297], "policy_pol_reward": [-0.9965, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6884049224197237, "mean_raw_obs_processing_ms": 1.5828333219367372, "mean_inference_ms": 2.1423907013704357, "mean_action_processing_ms": 0.07303615107856512}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 140000, "timers": {"learn_time_ms": 17.082, "learn_throughput": 1873.361, "update_time_ms": 2.419}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.010300626046955585, "cur_lr": 0.0005, "mean_q": 0.05645947903394699, "min_q": -0.051580220460891724, "max_q": 0.12372487038373947, "mean_td_error": 0.03534268960356712}}, "num_steps_sampled": 140000, "num_steps_trained": 1112032, "last_target_update_ts": 139600, "num_target_updates": 276}, "done": false, "episodes_total": 80, "training_iteration": 140, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-00-04", "timestamp": 1619874004, "time_this_iter_s": 13.105490684509277, "time_total_s": 1811.6138973236084, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8378>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1811.6138973236084, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.994736842105265, "ram_util_percent": 58.06315789473683}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8608062499999999, "episode_len_mean": 1746.525, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8608062499999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6884049224197237, "mean_raw_obs_processing_ms": 1.5828333219367372, "mean_inference_ms": 2.1423907013704357, "mean_action_processing_ms": 0.07303615107856512}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 141000, "timers": {"learn_time_ms": 14.96, "learn_throughput": 2139.01, "update_time_ms": 2.677}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00363143440335989, "cur_lr": 0.0005, "mean_q": 0.0542076975107193, "min_q": -0.06268927454948425, "max_q": 0.11750530451536179, "mean_td_error": -0.005812354385852814}}, "num_steps_sampled": 141000, "num_steps_trained": 1120032, "last_target_update_ts": 140608, "num_target_updates": 278}, "done": false, "episodes_total": 80, "training_iteration": 141, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-00-18", "timestamp": 1619874018, "time_this_iter_s": 13.268996715545654, "time_total_s": 1824.882894039154, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b86a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1824.882894039154, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 23.605263157894736, "ram_util_percent": 58.099999999999994}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8608062499999999, "episode_len_mean": 1746.525, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8608062499999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6884049224197237, "mean_raw_obs_processing_ms": 1.5828333219367372, "mean_inference_ms": 2.1423907013704357, "mean_action_processing_ms": 0.07303615107856512}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 142000, "timers": {"learn_time_ms": 15.576, "learn_throughput": 2054.401, "update_time_ms": 1.993}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0031200714875012636, "cur_lr": 0.0005, "mean_q": 0.05343318358063698, "min_q": -0.019223684445023537, "max_q": 0.11192609369754791, "mean_td_error": -0.0047499798238277435}}, "num_steps_sampled": 142000, "num_steps_trained": 1128032, "last_target_update_ts": 141616, "num_target_updates": 280}, "done": false, "episodes_total": 80, "training_iteration": 142, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-00-30", "timestamp": 1619874030, "time_this_iter_s": 12.641502618789673, "time_total_s": 1837.5243966579437, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1837.5243966579437, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 18.638888888888886, "ram_util_percent": 58.022222222222226}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8658042168674699, "episode_len_mean": 1716.120481927711, "episodes_this_iter": 3, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8658042168674699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99725, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0], "episode_lengths": [2314, 115, 287, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195], "policy_pol_reward": [-0.99725, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6894428492831772, "mean_raw_obs_processing_ms": 1.582436782928793, "mean_inference_ms": 2.143531383902292, "mean_action_processing_ms": 0.07306869666331063}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 143000, "timers": {"learn_time_ms": 18.832, "learn_throughput": 1699.268, "update_time_ms": 2.243}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0005728286341764033, "cur_lr": 0.0005, "mean_q": 0.052000079303979874, "min_q": -0.06547443568706512, "max_q": 0.11762687563896179, "mean_td_error": -0.0024428977631032467}}, "num_steps_sampled": 143000, "num_steps_trained": 1136032, "last_target_update_ts": 142624, "num_target_updates": 282}, "done": false, "episodes_total": 83, "training_iteration": 143, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-00-44", "timestamp": 1619874044, "time_this_iter_s": 13.170074462890625, "time_total_s": 1850.6944711208344, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1850.6944711208344, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 21.76315789473684, "ram_util_percent": 58.04210526315789}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8658042168674697, "episode_len_mean": 1716.120481927711, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8658042168674697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6894428492831772, "mean_raw_obs_processing_ms": 1.582436782928793, "mean_inference_ms": 2.143531383902292, "mean_action_processing_ms": 0.07306869666331063}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"learn_time_ms": 17.87, "learn_throughput": 1790.699, "update_time_ms": 3.325}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0032524580601602793, "cur_lr": 0.0005, "mean_q": 0.04091699421405792, "min_q": -0.18731313943862915, "max_q": 0.0890476182103157, "mean_td_error": 0.014324062503874302}}, "num_steps_sampled": 144000, "num_steps_trained": 1144032, "last_target_update_ts": 143632, "num_target_updates": 284}, "done": false, "episodes_total": 83, "training_iteration": 144, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-00-57", "timestamp": 1619874057, "time_this_iter_s": 13.420848608016968, "time_total_s": 1864.1153197288513, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414971268>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1864.1153197288513, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 20.715789473684207, "ram_util_percent": 58.026315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8658042168674697, "episode_len_mean": 1716.120481927711, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8658042168674697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6894428492831772, "mean_raw_obs_processing_ms": 1.582436782928793, "mean_inference_ms": 2.143531383902292, "mean_action_processing_ms": 0.07306869666331063}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 145000, "timers": {"learn_time_ms": 18.366, "learn_throughput": 1742.345, "update_time_ms": 2.599}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0059249429032206535, "cur_lr": 0.0005, "mean_q": 0.05753844603896141, "min_q": -0.1599348783493042, "max_q": 0.11963391304016113, "mean_td_error": 0.027079174295067787}}, "num_steps_sampled": 145000, "num_steps_trained": 1152032, "last_target_update_ts": 144640, "num_target_updates": 286}, "done": false, "episodes_total": 83, "training_iteration": 145, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-01-10", "timestamp": 1619874070, "time_this_iter_s": 13.38001799583435, "time_total_s": 1877.4953377246857, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46438c8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1877.4953377246857, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 19.26842105263158, "ram_util_percent": 58.06842105263158}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8689176470588235, "episode_len_mean": 1710.2470588235294, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8689176470588235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99625, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0], "episode_lengths": [2882, 51, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287], "policy_pol_reward": [-0.99625, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6901005772970847, "mean_raw_obs_processing_ms": 1.582297297651027, "mean_inference_ms": 2.144269026981777, "mean_action_processing_ms": 0.07308941088207511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 146000, "timers": {"learn_time_ms": 18.582, "learn_throughput": 1722.093, "update_time_ms": 2.625}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0037849179934710264, "cur_lr": 0.0005, "mean_q": 0.054126642644405365, "min_q": -0.15814852714538574, "max_q": 0.14139682054519653, "mean_td_error": 0.0023563820868730545}}, "num_steps_sampled": 146000, "num_steps_trained": 1160032, "last_target_update_ts": 145648, "num_target_updates": 288}, "done": false, "episodes_total": 85, "training_iteration": 146, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-01-24", "timestamp": 1619874084, "time_this_iter_s": 13.332728862762451, "time_total_s": 1890.8280665874481, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46437b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8048>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1890.8280665874481, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 20.942105263157895, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.874808988764045, "episode_len_mean": 1647.887640449438, "episodes_this_iter": 4, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.874808988764045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0], "episode_lengths": [787, 470, 17, 17, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6913339807113974, "mean_raw_obs_processing_ms": 1.5821044965518611, "mean_inference_ms": 2.1456538273279224, "mean_action_processing_ms": 0.07312818082171214}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 147000, "timers": {"learn_time_ms": 17.984, "learn_throughput": 1779.403, "update_time_ms": 2.254}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00461982749402523, "cur_lr": 0.0005, "mean_q": 0.0454174280166626, "min_q": -0.08845403790473938, "max_q": 0.10550517588853836, "mean_td_error": 0.013035411015152931}}, "num_steps_sampled": 147000, "num_steps_trained": 1168032, "last_target_update_ts": 146656, "num_target_updates": 290}, "done": false, "episodes_total": 89, "training_iteration": 147, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-01-37", "timestamp": 1619874097, "time_this_iter_s": 13.402251720428467, "time_total_s": 1904.2303183078766, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b82f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1904.2303183078766, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 58.16842105263158}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8762000000000001, "episode_len_mean": 1639.1333333333334, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8762000000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [860, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6916193608946142, "mean_raw_obs_processing_ms": 1.5820693898656455, "mean_inference_ms": 2.145973674712149, "mean_action_processing_ms": 0.07313711867865078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148000, "timers": {"learn_time_ms": 19.196, "learn_throughput": 1667.057, "update_time_ms": 2.291}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001620422350242734, "cur_lr": 0.0005, "mean_q": 0.06588283181190491, "min_q": 0.03750850260257721, "max_q": 0.11083097010850906, "mean_td_error": 0.0019477951573207974}}, "num_steps_sampled": 148000, "num_steps_trained": 1176032, "last_target_update_ts": 147664, "num_target_updates": 292}, "done": false, "episodes_total": 90, "training_iteration": 148, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-01-50", "timestamp": 1619874110, "time_this_iter_s": 12.728265047073364, "time_total_s": 1916.95858335495, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a5bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1916.95858335495, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 20.326315789473682, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8762000000000001, "episode_len_mean": 1639.1333333333334, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8762000000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6916193608946144, "mean_raw_obs_processing_ms": 1.5820693898656455, "mean_inference_ms": 2.1459736747121494, "mean_action_processing_ms": 0.07313711867865076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 149000, "timers": {"learn_time_ms": 17.323, "learn_throughput": 1847.218, "update_time_ms": 2.561}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0012809188337996602, "cur_lr": 0.0005, "mean_q": 0.0644671842455864, "min_q": -0.06481011211872101, "max_q": 0.1416425257921219, "mean_td_error": -0.0028843977488577366}}, "num_steps_sampled": 149000, "num_steps_trained": 1184032, "last_target_update_ts": 148672, "num_target_updates": 294}, "done": false, "episodes_total": 90, "training_iteration": 149, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-02-03", "timestamp": 1619874123, "time_this_iter_s": 12.451972723007202, "time_total_s": 1929.4105560779572, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a5b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a5598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1929.4105560779572, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 19.05294117647059, "ram_util_percent": 58.029411764705884}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8775274725274724, "episode_len_mean": 1639.2307692307693, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8775274725274724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.997, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1648, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860], "policy_pol_reward": [-0.997, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6918933684590058, "mean_raw_obs_processing_ms": 1.5820520073246802, "mean_inference_ms": 2.146279356732019, "mean_action_processing_ms": 0.07314560410222805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 150000, "timers": {"learn_time_ms": 18.792, "learn_throughput": 1702.873, "update_time_ms": 2.739}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0029127555899322033, "cur_lr": 0.0005, "mean_q": 0.057623326778411865, "min_q": 0.002463478595018387, "max_q": 0.12169325351715088, "mean_td_error": -0.007582518272101879}}, "num_steps_sampled": 150000, "num_steps_trained": 1192032, "last_target_update_ts": 149680, "num_target_updates": 296}, "done": false, "episodes_total": 91, "training_iteration": 150, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-02-16", "timestamp": 1619874136, "time_this_iter_s": 13.516920328140259, "time_total_s": 1942.9274764060974, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b6510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1942.9274764060974, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 20.8, "ram_util_percent": 58.06499999999998}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8775274725274725, "episode_len_mean": 1639.2307692307693, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8775274725274725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6918933684590058, "mean_raw_obs_processing_ms": 1.5820520073246802, "mean_inference_ms": 2.1462793567320193, "mean_action_processing_ms": 0.07314560410222806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 151000, "timers": {"learn_time_ms": 19.292, "learn_throughput": 1658.75, "update_time_ms": 2.35}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005130313336849213, "cur_lr": 0.0005, "mean_q": 0.0305965393781662, "min_q": -0.09610670804977417, "max_q": 0.09452350437641144, "mean_td_error": -0.016162177547812462}}, "num_steps_sampled": 151000, "num_steps_trained": 1200032, "last_target_update_ts": 150688, "num_target_updates": 298}, "done": false, "episodes_total": 91, "training_iteration": 151, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-02-29", "timestamp": 1619874149, "time_this_iter_s": 12.813079118728638, "time_total_s": 1955.740555524826, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1955.740555524826, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 19.28888888888889, "ram_util_percent": 58.15555555555555}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8775274725274725, "episode_len_mean": 1639.2307692307693, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8775274725274725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6918933684590058, "mean_raw_obs_processing_ms": 1.5820520073246802, "mean_inference_ms": 2.1462793567320193, "mean_action_processing_ms": 0.07314560410222806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 152000, "timers": {"learn_time_ms": 20.159, "learn_throughput": 1587.357, "update_time_ms": 2.269}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0021294113248586655, "cur_lr": 0.0005, "mean_q": 0.053028129041194916, "min_q": 0.011800084263086319, "max_q": 0.13004930317401886, "mean_td_error": 0.003411973128095269}}, "num_steps_sampled": 152000, "num_steps_trained": 1208032, "last_target_update_ts": 151696, "num_target_updates": 300}, "done": false, "episodes_total": 91, "training_iteration": 152, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-02-42", "timestamp": 1619874162, "time_this_iter_s": 12.99526834487915, "time_total_s": 1968.7358238697052, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b6d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4474d06378>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1968.7358238697052, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 22.19473684210526, "ram_util_percent": 58.078947368421055}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787989130434781, "episode_len_mean": 1657.2826086956522, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8787989130434781}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9945, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997], "episode_lengths": [3300, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648], "policy_pol_reward": [-0.9945, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.692143568742786, "mean_raw_obs_processing_ms": 1.5820616569610113, "mean_inference_ms": 2.146555231392713, "mean_action_processing_ms": 0.07315312967765154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 153000, "timers": {"learn_time_ms": 17.566, "learn_throughput": 1821.707, "update_time_ms": 2.286}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.009226617403328419, "cur_lr": 0.0005, "mean_q": 0.03583269566297531, "min_q": -0.05172302573919296, "max_q": 0.2453511655330658, "mean_td_error": 0.05368594452738762}}, "num_steps_sampled": 153000, "num_steps_trained": 1216032, "last_target_update_ts": 152704, "num_target_updates": 302}, "done": false, "episodes_total": 92, "training_iteration": 153, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-02-54", "timestamp": 1619874174, "time_this_iter_s": 11.936935424804688, "time_total_s": 1980.67275929451, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b6840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1980.67275929451, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 18.247058823529414, "ram_util_percent": 57.98823529411764}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787989130434783, "episode_len_mean": 1657.2826086956522, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8787989130434783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6921435687427862, "mean_raw_obs_processing_ms": 1.5820616569610113, "mean_inference_ms": 2.146555231392714, "mean_action_processing_ms": 0.07315312967765154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 154000, "timers": {"learn_time_ms": 15.545, "learn_throughput": 2058.541, "update_time_ms": 3.072}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018202195642516017, "cur_lr": 0.0005, "mean_q": 0.021786430850625038, "min_q": -0.012360829859972, "max_q": 0.07736457884311676, "mean_td_error": -0.0015233635203912854}}, "num_steps_sampled": 154000, "num_steps_trained": 1224032, "last_target_update_ts": 153712, "num_target_updates": 304}, "done": false, "episodes_total": 92, "training_iteration": 154, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-03-08", "timestamp": 1619874188, "time_this_iter_s": 13.479793548583984, "time_total_s": 1994.1525528430939, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bfbf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 1994.1525528430939, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 15.999999999999996, "ram_util_percent": 58.04210526315789}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787989130434783, "episode_len_mean": 1657.2826086956522, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8787989130434783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6921435687427862, "mean_raw_obs_processing_ms": 1.5820616569610113, "mean_inference_ms": 2.146555231392714, "mean_action_processing_ms": 0.07315312967765154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 155000, "timers": {"learn_time_ms": 18.316, "learn_throughput": 1747.14, "update_time_ms": 2.734}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0010988955618813634, "cur_lr": 0.0005, "mean_q": 0.03886537253856659, "min_q": -0.08450087159872055, "max_q": 0.09946945309638977, "mean_td_error": -0.0047412752173841}}, "num_steps_sampled": 155000, "num_steps_trained": 1232032, "last_target_update_ts": 154720, "num_target_updates": 306}, "done": false, "episodes_total": 92, "training_iteration": 155, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-03-21", "timestamp": 1619874201, "time_this_iter_s": 13.389354467391968, "time_total_s": 2007.5419073104858, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2007.5419073104858, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 19.431578947368422, "ram_util_percent": 58.02105263157894}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787989130434783, "episode_len_mean": 1657.2826086956522, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8787989130434783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6921435687427862, "mean_raw_obs_processing_ms": 1.5820616569610113, "mean_inference_ms": 2.146555231392714, "mean_action_processing_ms": 0.07315312967765154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"learn_time_ms": 19.242, "learn_throughput": 1663.025, "update_time_ms": 2.354}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004611982498317957, "cur_lr": 0.0005, "mean_q": 0.024974271655082703, "min_q": -0.013293050229549408, "max_q": 0.11677341163158417, "mean_td_error": 0.005368205718696117}}, "num_steps_sampled": 156000, "num_steps_trained": 1240032, "last_target_update_ts": 155728, "num_target_updates": 308}, "done": false, "episodes_total": 92, "training_iteration": 156, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-03-34", "timestamp": 1619874214, "time_this_iter_s": 12.94256591796875, "time_total_s": 2020.4844732284546, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2020.4844732284546, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 18.089473684210525, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8706835106382977, "episode_len_mean": 1668.159574468085, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8706835106382977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005250000000000003, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945], "episode_lengths": [4002, 335, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300], "policy_pol_reward": [0.005250000000000003, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945]}, "sampler_perf": {"mean_env_wait_ms": 1.6926322257529351, "mean_raw_obs_processing_ms": 1.5821493175149497, "mean_inference_ms": 2.1470798279680903, "mean_action_processing_ms": 0.07316733981457789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 157000, "timers": {"learn_time_ms": 20.254, "learn_throughput": 1579.947, "update_time_ms": 2.496}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013035007286816835, "cur_lr": 0.0005, "mean_q": 0.025230199098587036, "min_q": -0.17908264696598053, "max_q": 0.07476092129945755, "mean_td_error": -0.006064861547201872}}, "num_steps_sampled": 157000, "num_steps_trained": 1248032, "last_target_update_ts": 156736, "num_target_updates": 310}, "done": false, "episodes_total": 94, "training_iteration": 157, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-03-48", "timestamp": 1619874228, "time_this_iter_s": 13.456706285476685, "time_total_s": 2033.9411795139313, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46436a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2033.9411795139313, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 16.97894736842105, "ram_util_percent": 57.99473684210527}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8720447368421053, "episode_len_mean": 1656.5684210526315, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8720447368421053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0], "episode_lengths": [567, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.692861420012368, "mean_raw_obs_processing_ms": 1.582192395645771, "mean_inference_ms": 2.1473245757785233, "mean_action_processing_ms": 0.0731739378946544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 158000, "timers": {"learn_time_ms": 16.982, "learn_throughput": 1884.324, "update_time_ms": 2.259}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002901756437495351, "cur_lr": 0.0005, "mean_q": -0.006985827349126339, "min_q": -0.1994367390871048, "max_q": 0.046749092638492584, "mean_td_error": -0.010425624437630177}}, "num_steps_sampled": 158000, "num_steps_trained": 1256032, "last_target_update_ts": 157744, "num_target_updates": 312}, "done": false, "episodes_total": 95, "training_iteration": 158, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-04-00", "timestamp": 1619874240, "time_this_iter_s": 12.34557294845581, "time_total_s": 2046.286752462387, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465fae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2046.286752462387, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 18.038888888888888, "ram_util_percent": 58.016666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8733776041666665, "episode_len_mean": 1653.9479166666667, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8733776041666665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0], "episode_lengths": [1405, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6930856699721477, "mean_raw_obs_processing_ms": 1.5822479246718661, "mean_inference_ms": 2.1475629220910033, "mean_action_processing_ms": 0.07318035102921876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 159000, "timers": {"learn_time_ms": 19.098, "learn_throughput": 1675.533, "update_time_ms": 2.267}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003221290884539485, "cur_lr": 0.0005, "mean_q": 0.013709574937820435, "min_q": -0.09051018953323364, "max_q": 0.0640881210565567, "mean_td_error": -0.008072230964899063}}, "num_steps_sampled": 159000, "num_steps_trained": 1264032, "last_target_update_ts": 158752, "num_target_updates": 314}, "done": false, "episodes_total": 96, "training_iteration": 159, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-04-13", "timestamp": 1619874253, "time_this_iter_s": 13.233784914016724, "time_total_s": 2059.520537376404, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2059.520537376404, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 18.066666666666666, "ram_util_percent": 58.03888888888888}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8746829896907216, "episode_len_mean": 1647.3505154639174, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8746829896907216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0], "episode_lengths": [1014, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6933032131690715, "mean_raw_obs_processing_ms": 1.582301755020814, "mean_inference_ms": 2.147788948446755, "mean_action_processing_ms": 0.0731863620864699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 160000, "timers": {"learn_time_ms": 14.152, "learn_throughput": 2261.191, "update_time_ms": 2.243}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005166868679225445, "cur_lr": 0.0005, "mean_q": 0.011831680312752724, "min_q": -0.2889256179332733, "max_q": 0.07347875088453293, "mean_td_error": 0.015309487469494343}}, "num_steps_sampled": 160000, "num_steps_trained": 1272032, "last_target_update_ts": 159760, "num_target_updates": 316}, "done": false, "episodes_total": 97, "training_iteration": 160, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-04-26", "timestamp": 1619874266, "time_this_iter_s": 12.501162052154541, "time_total_s": 2072.0216994285583, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bfbf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2072.0216994285583, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 15.394444444444442, "ram_util_percent": 58.01111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8746829896907217, "episode_len_mean": 1647.3505154639174, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8746829896907217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6933032131690715, "mean_raw_obs_processing_ms": 1.582301755020814, "mean_inference_ms": 2.147788948446755, "mean_action_processing_ms": 0.0731863620864699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 161000, "timers": {"learn_time_ms": 18.604, "learn_throughput": 1720.076, "update_time_ms": 2.533}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002516489941626787, "cur_lr": 0.0005, "mean_q": 0.02303723618388176, "min_q": -0.06703557074069977, "max_q": 0.08802805840969086, "mean_td_error": 6.084563210606575e-06}}, "num_steps_sampled": 161000, "num_steps_trained": 1280032, "last_target_update_ts": 160768, "num_target_updates": 318}, "done": false, "episodes_total": 97, "training_iteration": 161, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-04-39", "timestamp": 1619874279, "time_this_iter_s": 13.465753078460693, "time_total_s": 2085.487452507019, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2085.487452507019, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 18.895, "ram_util_percent": 58.04}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8746829896907217, "episode_len_mean": 1647.3505154639174, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8746829896907217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6933032131690715, "mean_raw_obs_processing_ms": 1.582301755020814, "mean_inference_ms": 2.147788948446755, "mean_action_processing_ms": 0.0731863620864699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 162000, "timers": {"learn_time_ms": 19.5, "learn_throughput": 1640.99, "update_time_ms": 2.402}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007229149341583252, "cur_lr": 0.0005, "mean_q": 0.007374891079962254, "min_q": -0.1857251673936844, "max_q": 0.08230361342430115, "mean_td_error": 0.05401429533958435}}, "num_steps_sampled": 162000, "num_steps_trained": 1288032, "last_target_update_ts": 161776, "num_target_updates": 320}, "done": false, "episodes_total": 97, "training_iteration": 162, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-04-53", "timestamp": 1619874293, "time_this_iter_s": 13.247184991836548, "time_total_s": 2098.7346374988556, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bf840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2098.7346374988556, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 18.621052631578944, "ram_util_percent": 57.96315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8771919191919192, "episode_len_mean": 1645.4444444444443, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8771919191919192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99775, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2945, 161, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014], "policy_pol_reward": [-0.99775, -1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.693742107625879, "mean_raw_obs_processing_ms": 1.5824238713239864, "mean_inference_ms": 2.1482402326079506, "mean_action_processing_ms": 0.07319856239667853}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 163000, "timers": {"learn_time_ms": 18.765, "learn_throughput": 1705.331, "update_time_ms": 2.733}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005036904942244291, "cur_lr": 0.0005, "mean_q": -0.003802284598350525, "min_q": -0.060289137065410614, "max_q": 0.04377814754843712, "mean_td_error": -0.010473049245774746}}, "num_steps_sampled": 163000, "num_steps_trained": 1296032, "last_target_update_ts": 162784, "num_target_updates": 322}, "done": false, "episodes_total": 99, "training_iteration": 163, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-05-06", "timestamp": 1619874306, "time_this_iter_s": 13.135300159454346, "time_total_s": 2111.86993765831, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2111.86993765831, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 20.516666666666666, "ram_util_percent": 57.916666666666664}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8784199999999999, "episode_len_mean": 1637.66, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8784199999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0], "episode_lengths": [867, 2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161], "policy_pol_reward": [-1.0, -0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6939535144929019, "mean_raw_obs_processing_ms": 1.5824928879940399, "mean_inference_ms": 2.148456811264403, "mean_action_processing_ms": 0.07320439889445655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 164000, "timers": {"learn_time_ms": 19.117, "learn_throughput": 1673.886, "update_time_ms": 2.91}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0025488666724413633, "cur_lr": 0.0005, "mean_q": 0.0035306913778185844, "min_q": -0.09848056733608246, "max_q": 0.06626685708761215, "mean_td_error": -0.004828231409192085}}, "num_steps_sampled": 164000, "num_steps_trained": 1304032, "last_target_update_ts": 163792, "num_target_updates": 324}, "done": false, "episodes_total": 100, "training_iteration": 164, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-05-19", "timestamp": 1619874319, "time_this_iter_s": 13.111804962158203, "time_total_s": 2124.981742620468, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2124.981742620468, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 19.931578947368422, "ram_util_percent": 57.95789473684209}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.87842, "episode_len_mean": 1637.66, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.87842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0], "episode_lengths": [2587, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867], "policy_pol_reward": [-0.9985, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6939535144929019, "mean_raw_obs_processing_ms": 1.5824928879940399, "mean_inference_ms": 2.148456811264403, "mean_action_processing_ms": 0.07320439889445655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 165000, "timers": {"learn_time_ms": 18.225, "learn_throughput": 1755.855, "update_time_ms": 2.405}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016985987313091755, "cur_lr": 0.0005, "mean_q": 0.012743081897497177, "min_q": -0.13554058969020844, "max_q": 0.0660499632358551, "mean_td_error": -0.007199013605713844}}, "num_steps_sampled": 165000, "num_steps_trained": 1312032, "last_target_update_ts": 164800, "num_target_updates": 326}, "done": false, "episodes_total": 100, "training_iteration": 165, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-05-31", "timestamp": 1619874331, "time_this_iter_s": 11.78607702255249, "time_total_s": 2136.7678196430206, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465fae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2136.7678196430206, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 17.61764705882353, "ram_util_percent": 58.0529411764706}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8784049999999999, "episode_len_mean": 1633.43, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8784049999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.997, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0], "episode_lengths": [2164, 76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867], "policy_pol_reward": [-0.997, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.6960481038823487, "mean_raw_obs_processing_ms": 1.5833027910852564, "mean_inference_ms": 2.150770170756518, "mean_action_processing_ms": 0.07327135552638601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 166000, "timers": {"learn_time_ms": 17.56, "learn_throughput": 1822.296, "update_time_ms": 2.194}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002918282290920615, "cur_lr": 0.0005, "mean_q": -0.01166553981602192, "min_q": -0.30830609798431396, "max_q": 0.062223367393016815, "mean_td_error": -0.006348641589283943}}, "num_steps_sampled": 166000, "num_steps_trained": 1320032, "last_target_update_ts": 165808, "num_target_updates": 328}, "done": false, "episodes_total": 101, "training_iteration": 166, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-05-44", "timestamp": 1619874344, "time_this_iter_s": 13.203500747680664, "time_total_s": 2149.9713203907013, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46438c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2149.9713203907013, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 16.910526315789472, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8784049999999999, "episode_len_mean": 1633.43, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8784049999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997], "episode_lengths": [76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6960481038823487, "mean_raw_obs_processing_ms": 1.5833027910852564, "mean_inference_ms": 2.150770170756518, "mean_action_processing_ms": 0.07327135552638601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 167000, "timers": {"learn_time_ms": 19.457, "learn_throughput": 1644.648, "update_time_ms": 2.832}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001292863511480391, "cur_lr": 0.0005, "mean_q": -0.0019560903310775757, "min_q": -0.159982830286026, "max_q": 0.05703691393136978, "mean_td_error": -0.005007545463740826}}, "num_steps_sampled": 167000, "num_steps_trained": 1328032, "last_target_update_ts": 166816, "num_target_updates": 330}, "done": false, "episodes_total": 101, "training_iteration": 167, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-05-57", "timestamp": 1619874357, "time_this_iter_s": 13.302581310272217, "time_total_s": 2163.2739017009735, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414990d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2163.2739017009735, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 17.742105263157896, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8784049999999999, "episode_len_mean": 1633.43, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8784049999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997], "episode_lengths": [76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6960481038823487, "mean_raw_obs_processing_ms": 1.5833027910852564, "mean_inference_ms": 2.150770170756518, "mean_action_processing_ms": 0.07327135552638601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"learn_time_ms": 19.184, "learn_throughput": 1668.016, "update_time_ms": 2.405}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019311746582388878, "cur_lr": 0.0005, "mean_q": -0.019286666065454483, "min_q": -0.3076358437538147, "max_q": 0.05095658451318741, "mean_td_error": -0.012540866620838642}}, "num_steps_sampled": 168000, "num_steps_trained": 1336032, "last_target_update_ts": 167824, "num_target_updates": 332}, "done": false, "episodes_total": 101, "training_iteration": 168, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-06-10", "timestamp": 1619874370, "time_this_iter_s": 12.636488437652588, "time_total_s": 2175.910390138626, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2175.910390138626, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 18.572222222222223, "ram_util_percent": 58.088888888888896}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8784049999999999, "episode_len_mean": 1633.43, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8784049999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997], "episode_lengths": [76, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6960481038823487, "mean_raw_obs_processing_ms": 1.5833027910852564, "mean_inference_ms": 2.150770170756518, "mean_action_processing_ms": 0.07327135552638601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 169000, "timers": {"learn_time_ms": 18.8, "learn_throughput": 1702.16, "update_time_ms": 2.722}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0005137724219821393, "cur_lr": 0.0005, "mean_q": 0.01591990515589714, "min_q": -0.058676764369010925, "max_q": 0.0643736869096756, "mean_td_error": -0.001510772155597806}}, "num_steps_sampled": 169000, "num_steps_trained": 1344032, "last_target_update_ts": 168832, "num_target_updates": 334}, "done": false, "episodes_total": 101, "training_iteration": 169, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-06-23", "timestamp": 1619874383, "time_this_iter_s": 13.154252052307129, "time_total_s": 2189.0646421909332, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2189.0646421909332, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 18.52105263157895, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8783225, "episode_len_mean": 1668.78, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8783225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99175, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997], "episode_lengths": [3611, 79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164], "policy_pol_reward": [-0.99175, -1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.6981424971044248, "mean_raw_obs_processing_ms": 1.584134062399778, "mean_inference_ms": 2.1530772256723023, "mean_action_processing_ms": 0.0733379835685187}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 170000, "timers": {"learn_time_ms": 18.558, "learn_throughput": 1724.335, "update_time_ms": 2.758}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0029047736898064613, "cur_lr": 0.0005, "mean_q": -0.005613054148852825, "min_q": -0.2967461347579956, "max_q": 0.04869460314512253, "mean_td_error": -0.010560009628534317}}, "num_steps_sampled": 170000, "num_steps_trained": 1352032, "last_target_update_ts": 169840, "num_target_updates": 336}, "done": false, "episodes_total": 102, "training_iteration": 170, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-06-36", "timestamp": 1619874396, "time_this_iter_s": 12.627954483032227, "time_total_s": 2201.6925966739655, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2201.6925966739655, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 18.494444444444447, "ram_util_percent": 58.01111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8783225, "episode_len_mean": 1668.78, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8783225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175], "episode_lengths": [79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175]}, "sampler_perf": {"mean_env_wait_ms": 1.698142497104425, "mean_raw_obs_processing_ms": 1.584134062399778, "mean_inference_ms": 2.1530772256723023, "mean_action_processing_ms": 0.0733379835685187}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 171000, "timers": {"learn_time_ms": 17.236, "learn_throughput": 1856.618, "update_time_ms": 2.158}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004596568178385496, "cur_lr": 0.0005, "mean_q": -0.017405711114406586, "min_q": -0.2662966549396515, "max_q": 0.04929571598768234, "mean_td_error": 0.0162648968398571}}, "num_steps_sampled": 171000, "num_steps_trained": 1360032, "last_target_update_ts": 170848, "num_target_updates": 338}, "done": false, "episodes_total": 102, "training_iteration": 171, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-06-49", "timestamp": 1619874409, "time_this_iter_s": 12.66091537475586, "time_total_s": 2214.3535120487213, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2214.3535120487213, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 19.444444444444443, "ram_util_percent": 58.099999999999994}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8783225, "episode_len_mean": 1668.78, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8783225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175], "episode_lengths": [79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175]}, "sampler_perf": {"mean_env_wait_ms": 1.698142497104425, "mean_raw_obs_processing_ms": 1.584134062399778, "mean_inference_ms": 2.1530772256723023, "mean_action_processing_ms": 0.0733379835685187}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172000, "timers": {"learn_time_ms": 18.808, "learn_throughput": 1701.438, "update_time_ms": 2.357}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003766493173316121, "cur_lr": 0.0005, "mean_q": -0.0034584160894155502, "min_q": -0.1700846403837204, "max_q": 0.04795338213443756, "mean_td_error": -0.00906866043806076}}, "num_steps_sampled": 172000, "num_steps_trained": 1368032, "last_target_update_ts": 171856, "num_target_updates": 340}, "done": false, "episodes_total": 102, "training_iteration": 172, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-07-02", "timestamp": 1619874422, "time_this_iter_s": 13.04875922203064, "time_total_s": 2227.402271270752, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2227.402271270752, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 19.310526315789474, "ram_util_percent": 58.06842105263158}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8783225, "episode_len_mean": 1668.78, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8783225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175], "episode_lengths": [79, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175]}, "sampler_perf": {"mean_env_wait_ms": 1.698142497104425, "mean_raw_obs_processing_ms": 1.584134062399778, "mean_inference_ms": 2.1530772256723023, "mean_action_processing_ms": 0.0733379835685187}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 173000, "timers": {"learn_time_ms": 18.465, "learn_throughput": 1732.993, "update_time_ms": 2.319}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002819958608597517, "cur_lr": 0.0005, "mean_q": -0.004169604741036892, "min_q": -0.07989299297332764, "max_q": 0.04055148363113403, "mean_td_error": 0.004493406042456627}}, "num_steps_sampled": 173000, "num_steps_trained": 1376032, "last_target_update_ts": 172864, "num_target_updates": 342}, "done": false, "episodes_total": 102, "training_iteration": 173, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-07-15", "timestamp": 1619874435, "time_this_iter_s": 13.297137260437012, "time_total_s": 2240.699408531189, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa465f598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2240.699408531189, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 20.34736842105263, "ram_util_percent": 58.000000000000014}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682275, "episode_len_mean": 1708.01, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.009500000000000007, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175], "episode_lengths": [4002, 124, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611], "policy_pol_reward": [0.009500000000000007, -1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175]}, "sampler_perf": {"mean_env_wait_ms": 1.700237523621211, "mean_raw_obs_processing_ms": 1.5849818876931872, "mean_inference_ms": 2.1553871707310166, "mean_action_processing_ms": 0.07340480475121139}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 174000, "timers": {"learn_time_ms": 17.919, "learn_throughput": 1785.841, "update_time_ms": 2.448}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036441863048821688, "cur_lr": 0.0005, "mean_q": -0.01863139495253563, "min_q": -0.10938286036252975, "max_q": 0.04463722184300423, "mean_td_error": -0.007222598884254694}}, "num_steps_sampled": 174000, "num_steps_trained": 1384032, "last_target_update_ts": 173872, "num_target_updates": 344}, "done": false, "episodes_total": 103, "training_iteration": 174, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-07-29", "timestamp": 1619874449, "time_this_iter_s": 13.275753498077393, "time_total_s": 2253.9751620292664, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2253.9751620292664, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 24.947368421052634, "ram_util_percent": 57.968421052631584}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682275, "episode_len_mean": 1714.0, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007], "episode_lengths": [723, 101, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007]}, "sampler_perf": {"mean_env_wait_ms": 1.7023357848846499, "mean_raw_obs_processing_ms": 1.5858406741264497, "mean_inference_ms": 2.1577022953511733, "mean_action_processing_ms": 0.0734717528659183}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 175000, "timers": {"learn_time_ms": 19.428, "learn_throughput": 1647.086, "update_time_ms": 2.808}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005553379189223051, "cur_lr": 0.0005, "mean_q": -0.035639822483062744, "min_q": -0.13110166788101196, "max_q": 0.03933921828866005, "mean_td_error": -0.017417725175619125}}, "num_steps_sampled": 175000, "num_steps_trained": 1392032, "last_target_update_ts": 174880, "num_target_updates": 346}, "done": false, "episodes_total": 104, "training_iteration": 175, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-07-42", "timestamp": 1619874462, "time_this_iter_s": 13.725390911102295, "time_total_s": 2267.7005529403687, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2267.7005529403687, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 18.068421052631578, "ram_util_percent": 58.073684210526324}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8681975, "episode_len_mean": 1727.13, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8681975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.997, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0], "episode_lengths": [1414, 590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723], "policy_pol_reward": [-0.997, -1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7044324501485786, "mean_raw_obs_processing_ms": 1.5867039069912996, "mean_inference_ms": 2.160017340456127, "mean_action_processing_ms": 0.07353864719674133}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176000, "timers": {"learn_time_ms": 18.199, "learn_throughput": 1758.362, "update_time_ms": 2.328}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017535118386149406, "cur_lr": 0.0005, "mean_q": -0.012555778957903385, "min_q": -0.11512830853462219, "max_q": 0.04321518540382385, "mean_td_error": -0.005506728310137987}}, "num_steps_sampled": 176000, "num_steps_trained": 1400032, "last_target_update_ts": 175888, "num_target_updates": 348}, "done": false, "episodes_total": 105, "training_iteration": 176, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-07-56", "timestamp": 1619874476, "time_this_iter_s": 13.129044532775879, "time_total_s": 2280.8295974731445, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2280.8295974731445, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 21.173684210526318, "ram_util_percent": 58.07368421052631}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8681974999999998, "episode_len_mean": 1727.13, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8681974999999998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997], "episode_lengths": [590, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414], "policy_pol_reward": [-1.0, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.704432450148579, "mean_raw_obs_processing_ms": 1.5867039069913, "mean_inference_ms": 2.160017340456127, "mean_action_processing_ms": 0.07353864719674132}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 177000, "timers": {"learn_time_ms": 17.441, "learn_throughput": 1834.746, "update_time_ms": 2.329}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027758576907217503, "cur_lr": 0.0005, "mean_q": -0.036505889147520065, "min_q": -0.3319327235221863, "max_q": 0.03809202462434769, "mean_td_error": 0.0054911477491259575}}, "num_steps_sampled": 177000, "num_steps_trained": 1408032, "last_target_update_ts": 176896, "num_target_updates": 350}, "done": false, "episodes_total": 105, "training_iteration": 177, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-08-09", "timestamp": 1619874489, "time_this_iter_s": 12.903428554534912, "time_total_s": 2293.7330260276794, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2293.7330260276794, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 20.061111111111114, "ram_util_percent": 58.02222222222221}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8681849999999999, "episode_len_mean": 1734.52, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8681849999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99875, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997], "episode_lengths": [1329, 1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414], "policy_pol_reward": [-0.99875, -0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997]}, "sampler_perf": {"mean_env_wait_ms": 1.7058566153894963, "mean_raw_obs_processing_ms": 1.586771049706902, "mean_inference_ms": 2.1615717673839976, "mean_action_processing_ms": 0.07358315286092898}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 178000, "timers": {"learn_time_ms": 17.745, "learn_throughput": 1803.316, "update_time_ms": 2.319}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004328911658376455, "cur_lr": 0.0005, "mean_q": -0.008679269813001156, "min_q": -0.1744977980852127, "max_q": 0.040670767426490784, "mean_td_error": 0.01873093470931053}}, "num_steps_sampled": 178000, "num_steps_trained": 1416032, "last_target_update_ts": 177904, "num_target_updates": 352}, "done": false, "episodes_total": 106, "training_iteration": 178, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-08-22", "timestamp": 1619874502, "time_this_iter_s": 12.996589183807373, "time_total_s": 2306.729615211487, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46438c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7d08>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2306.729615211487, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 21.131578947368425, "ram_util_percent": 58.11052631578947}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.868185, "episode_len_mean": 1734.52, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.868185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875], "episode_lengths": [1424, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329], "policy_pol_reward": [-0.99125, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875]}, "sampler_perf": {"mean_env_wait_ms": 1.7058566153894967, "mean_raw_obs_processing_ms": 1.5867710497069014, "mean_inference_ms": 2.161571767383998, "mean_action_processing_ms": 0.073583152860929}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 179000, "timers": {"learn_time_ms": 16.531, "learn_throughput": 1935.722, "update_time_ms": 2.201}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0010464127408340573, "cur_lr": 0.0005, "mean_q": 0.0037543880753219128, "min_q": -0.1810789257287979, "max_q": 0.05050063878297806, "mean_td_error": -0.002589208772405982}}, "num_steps_sampled": 179000, "num_steps_trained": 1424032, "last_target_update_ts": 178912, "num_target_updates": 354}, "done": false, "episodes_total": 106, "training_iteration": 179, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-08-35", "timestamp": 1619874515, "time_this_iter_s": 13.21222472190857, "time_total_s": 2319.9418399333954, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f44a4aec6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2319.9418399333954, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 20.831578947368424, "ram_util_percent": 58.07368421052631}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682625, "episode_len_mean": 1744.4, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.999, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875], "episode_lengths": [2412, 531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329], "policy_pol_reward": [-0.999, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875]}, "sampler_perf": {"mean_env_wait_ms": 1.7068961881126952, "mean_raw_obs_processing_ms": 1.5866176434667851, "mean_inference_ms": 2.1627436610077244, "mean_action_processing_ms": 0.07361690358184941}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"learn_time_ms": 18.35, "learn_throughput": 1743.896, "update_time_ms": 2.361}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020817031618207693, "cur_lr": 0.0005, "mean_q": -0.019173981621861458, "min_q": -0.24868492782115936, "max_q": 0.04632747173309326, "mean_td_error": 0.019679393619298935}}, "num_steps_sampled": 180000, "num_steps_trained": 1432032, "last_target_update_ts": 179920, "num_target_updates": 356}, "done": false, "episodes_total": 107, "training_iteration": 180, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-08-48", "timestamp": 1619874528, "time_this_iter_s": 13.334323167800903, "time_total_s": 2333.2761631011963, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2333.2761631011963, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 18.57894736842105, "ram_util_percent": 58.078947368421055}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682625, "episode_len_mean": 1744.4, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999], "episode_lengths": [531, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999]}, "sampler_perf": {"mean_env_wait_ms": 1.7068961881126956, "mean_raw_obs_processing_ms": 1.586617643466785, "mean_inference_ms": 2.1627436610077244, "mean_action_processing_ms": 0.07361690358184941}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 181000, "timers": {"learn_time_ms": 16.99, "learn_throughput": 1883.506, "update_time_ms": 2.317}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0043417769484221935, "cur_lr": 0.0005, "mean_q": -0.011227852664887905, "min_q": -0.18746459484100342, "max_q": 0.048912812024354935, "mean_td_error": 0.018392954021692276}}, "num_steps_sampled": 181000, "num_steps_trained": 1440032, "last_target_update_ts": 180928, "num_target_updates": 358}, "done": false, "episodes_total": 107, "training_iteration": 181, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-09-01", "timestamp": 1619874541, "time_this_iter_s": 13.127833604812622, "time_total_s": 2346.403996706009, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2346.403996706009, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 19.147368421052633, "ram_util_percent": 57.98947368421052}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682449999999998, "episode_len_mean": 1758.21, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682449999999998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99825, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999], "episode_lengths": [1912, 1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412], "policy_pol_reward": [-0.99825, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999]}, "sampler_perf": {"mean_env_wait_ms": 1.7077283573077289, "mean_raw_obs_processing_ms": 1.5860766097533965, "mean_inference_ms": 2.1636420793814595, "mean_action_processing_ms": 0.07364380181265885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 182000, "timers": {"learn_time_ms": 18.473, "learn_throughput": 1732.219, "update_time_ms": 2.223}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018036687979474664, "cur_lr": 0.0005, "mean_q": -0.006096357945352793, "min_q": -0.09909084439277649, "max_q": 0.028414025902748108, "mean_td_error": -0.004160878714174032}}, "num_steps_sampled": 182000, "num_steps_trained": 1448032, "last_target_update_ts": 181936, "num_target_updates": 360}, "done": false, "episodes_total": 108, "training_iteration": 182, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-09-14", "timestamp": 1619874554, "time_this_iter_s": 12.518830060958862, "time_total_s": 2358.922826766968, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2358.922826766968, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 17.944444444444443, "ram_util_percent": 58.07777777777778}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.868245, "episode_len_mean": 1758.21, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.868245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825], "episode_lengths": [1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825]}, "sampler_perf": {"mean_env_wait_ms": 1.7077283573077289, "mean_raw_obs_processing_ms": 1.5860766097533963, "mean_inference_ms": 2.163642079381459, "mean_action_processing_ms": 0.07364380181265885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 183000, "timers": {"learn_time_ms": 18.566, "learn_throughput": 1723.58, "update_time_ms": 2.192}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0061037191189825535, "cur_lr": 0.0005, "mean_q": -0.011435436084866524, "min_q": -0.10795418918132782, "max_q": 0.020849088206887245, "mean_td_error": -0.011137714609503746}}, "num_steps_sampled": 183000, "num_steps_trained": 1456032, "last_target_update_ts": 182944, "num_target_updates": 362}, "done": false, "episodes_total": 108, "training_iteration": 183, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-09-27", "timestamp": 1619874567, "time_this_iter_s": 12.987048387527466, "time_total_s": 2371.9098751544952, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2371.9098751544952, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.216666666666665, "ram_util_percent": 58.03333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.868245, "episode_len_mean": 1758.21, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.868245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825], "episode_lengths": [1041, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825]}, "sampler_perf": {"mean_env_wait_ms": 1.7077283573077289, "mean_raw_obs_processing_ms": 1.5860766097533963, "mean_inference_ms": 2.163642079381459, "mean_action_processing_ms": 0.07364380181265885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 184000, "timers": {"learn_time_ms": 18.928, "learn_throughput": 1690.578, "update_time_ms": 2.729}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004719750955700874, "cur_lr": 0.0005, "mean_q": -0.00521248672157526, "min_q": -0.12323707342147827, "max_q": 0.0352754145860672, "mean_td_error": 0.007807879243046045}}, "num_steps_sampled": 184000, "num_steps_trained": 1464032, "last_target_update_ts": 183952, "num_target_updates": 364}, "done": false, "episodes_total": 108, "training_iteration": 184, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-09-41", "timestamp": 1619874581, "time_this_iter_s": 13.670945167541504, "time_total_s": 2385.5808203220367, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2385.5808203220367, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 20.455, "ram_util_percent": 57.989999999999995}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682, "episode_len_mean": 1784.4, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9955, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825], "episode_lengths": [3660, 835, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912], "policy_pol_reward": [-0.9955, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825]}, "sampler_perf": {"mean_env_wait_ms": 1.7083802271907342, "mean_raw_obs_processing_ms": 1.5853316836904492, "mean_inference_ms": 2.164310889647957, "mean_action_processing_ms": 0.07366390215055368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 185000, "timers": {"learn_time_ms": 19.008, "learn_throughput": 1683.519, "update_time_ms": 2.255}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004457034636288881, "cur_lr": 0.0005, "mean_q": -0.01509427186101675, "min_q": -0.2207464873790741, "max_q": 0.02891365997493267, "mean_td_error": 0.0065099820494651794}}, "num_steps_sampled": 185000, "num_steps_trained": 1472032, "last_target_update_ts": 184960, "num_target_updates": 366}, "done": false, "episodes_total": 109, "training_iteration": 185, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-09-54", "timestamp": 1619874594, "time_this_iter_s": 13.225073099136353, "time_total_s": 2398.805893421173, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2398.805893421173, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 19.721052631578946, "ram_util_percent": 58.01052631578946}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682, "episode_len_mean": 1781.2, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955], "episode_lengths": [515, 137, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955]}, "sampler_perf": {"mean_env_wait_ms": 1.708849810078142, "mean_raw_obs_processing_ms": 1.5843941539720463, "mean_inference_ms": 2.1647510078516032, "mean_action_processing_ms": 0.07367678944209047}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 186000, "timers": {"learn_time_ms": 16.822, "learn_throughput": 1902.254, "update_time_ms": 2.616}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020617826376110315, "cur_lr": 0.0005, "mean_q": -0.030784307047724724, "min_q": -0.17627307772636414, "max_q": 0.011511154472827911, "mean_td_error": -5.572522059082985e-05}}, "num_steps_sampled": 186000, "num_steps_trained": 1480032, "last_target_update_ts": 185968, "num_target_updates": 368}, "done": false, "episodes_total": 110, "training_iteration": 186, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-10-07", "timestamp": 1619874607, "time_this_iter_s": 13.177613496780396, "time_total_s": 2411.9835069179535, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be378>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2411.9835069179535, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 17.589473684210528, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682, "episode_len_mean": 1792.71, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0], "episode_lengths": [1288, 22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515], "policy_pol_reward": [-1.0, -1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7093202188408179, "mean_raw_obs_processing_ms": 1.5834677592802786, "mean_inference_ms": 2.1651929314451963, "mean_action_processing_ms": 0.073689708834511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 187000, "timers": {"learn_time_ms": 17.486, "learn_throughput": 1830.015, "update_time_ms": 2.481}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016528283013030887, "cur_lr": 0.0005, "mean_q": -0.03666100651025772, "min_q": -0.41302937269210815, "max_q": 0.014415998011827469, "mean_td_error": 0.002023915760219097}}, "num_steps_sampled": 187000, "num_steps_trained": 1488032, "last_target_update_ts": 186976, "num_target_updates": 370}, "done": false, "episodes_total": 111, "training_iteration": 187, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-10-21", "timestamp": 1619874621, "time_this_iter_s": 13.68382215499878, "time_total_s": 2425.6673290729523, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45be598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45af510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2425.6673290729523, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 16.457894736842107, "ram_util_percent": 58.04736842105264}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682, "episode_len_mean": 1792.71, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0], "episode_lengths": [22, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288], "policy_pol_reward": [-1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7093202188408179, "mean_raw_obs_processing_ms": 1.5834677592802786, "mean_inference_ms": 2.165192931445196, "mean_action_processing_ms": 0.073689708834511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 188000, "timers": {"learn_time_ms": 15.409, "learn_throughput": 2076.677, "update_time_ms": 2.085}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005442999769002199, "cur_lr": 0.0005, "mean_q": -0.04518597200512886, "min_q": -0.2578613758087158, "max_q": 0.00650222972035408, "mean_td_error": 0.023317623883485794}}, "num_steps_sampled": 188000, "num_steps_trained": 1496032, "last_target_update_ts": 187984, "num_target_updates": 372}, "done": false, "episodes_total": 111, "training_iteration": 188, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-10-34", "timestamp": 1619874634, "time_this_iter_s": 12.857826948165894, "time_total_s": 2438.525156021118, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bea60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be6a8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2438.525156021118, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.24736842105263, "ram_util_percent": 57.99473684210527}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682, "episode_len_mean": 1805.81, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0], "episode_lengths": [1332, 1454, 1446, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288], "policy_pol_reward": [-1.0, -0.99775, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7097883935001308, "mean_raw_obs_processing_ms": 1.5825598034115718, "mean_inference_ms": 2.165629591328027, "mean_action_processing_ms": 0.07370256297964402}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 189000, "timers": {"learn_time_ms": 20.657, "learn_throughput": 1549.136, "update_time_ms": 2.673}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003647398669272661, "cur_lr": 0.0005, "mean_q": -0.06736091524362564, "min_q": -0.2761359214782715, "max_q": 0.005456918850541115, "mean_td_error": 0.03449565917253494}}, "num_steps_sampled": 189000, "num_steps_trained": 1504032, "last_target_update_ts": 188992, "num_target_updates": 374}, "done": false, "episodes_total": 112, "training_iteration": 189, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-10-47", "timestamp": 1619874647, "time_this_iter_s": 13.15932011604309, "time_total_s": 2451.6844761371613, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45afd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7c80>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2451.6844761371613, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 17.866666666666664, "ram_util_percent": 58.03333333333333}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682025, "episode_len_mean": 1792.73, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.998, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0], "episode_lengths": [1046, 546, 916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332], "policy_pol_reward": [-0.998, -1.0, -1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.710470224385212, "mean_raw_obs_processing_ms": 1.5799992014392845, "mean_inference_ms": 2.1660797163732495, "mean_action_processing_ms": 0.07370660521809418}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 190000, "timers": {"learn_time_ms": 21.222, "learn_throughput": 1507.878, "update_time_ms": 2.411}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00268786633387208, "cur_lr": 0.0005, "mean_q": -0.034688837826251984, "min_q": -0.1145160123705864, "max_q": 0.004316249862313271, "mean_td_error": 0.005548194982111454}}, "num_steps_sampled": 190000, "num_steps_trained": 1512032, "last_target_update_ts": 190000, "num_target_updates": 376}, "done": false, "episodes_total": 114, "training_iteration": 190, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-11-00", "timestamp": 1619874660, "time_this_iter_s": 13.27079701423645, "time_total_s": 2464.9552731513977, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45be400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f44149712f0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2464.9552731513977, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 18.573684210526316, "ram_util_percent": 57.994736842105254}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682025, "episode_len_mean": 1792.73, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0], "episode_lengths": [916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546], "policy_pol_reward": [-1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.710470224385212, "mean_raw_obs_processing_ms": 1.5799992014392843, "mean_inference_ms": 2.1660797163732495, "mean_action_processing_ms": 0.07370660521809418}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 191000, "timers": {"learn_time_ms": 19.393, "learn_throughput": 1650.109, "update_time_ms": 2.316}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0038609025068581104, "cur_lr": 0.0005, "mean_q": -0.05559033900499344, "min_q": -0.3337419629096985, "max_q": 0.017287829890847206, "mean_td_error": -0.009443414397537708}}, "num_steps_sampled": 191000, "num_steps_trained": 1520032, "last_target_update_ts": 190504, "num_target_updates": 377}, "done": false, "episodes_total": 114, "training_iteration": 191, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-11-14", "timestamp": 1619874674, "time_this_iter_s": 13.024575233459473, "time_total_s": 2477.979848384857, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643e18>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2477.979848384857, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 17.221052631578946, "ram_util_percent": 58.03157894736843}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682025, "episode_len_mean": 1792.73, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0], "episode_lengths": [916, 3345, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546], "policy_pol_reward": [-1.0, -0.99275, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.710470224385212, "mean_raw_obs_processing_ms": 1.5799992014392843, "mean_inference_ms": 2.1660797163732495, "mean_action_processing_ms": 0.07370660521809418}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"learn_time_ms": 19.113, "learn_throughput": 1674.262, "update_time_ms": 2.271}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001304555800743401, "cur_lr": 0.0005, "mean_q": -0.03572819009423256, "min_q": -0.14476019144058228, "max_q": 0.003572864457964897, "mean_td_error": -0.00033881753915920854}}, "num_steps_sampled": 192000, "num_steps_trained": 1528032, "last_target_update_ts": 191512, "num_target_updates": 379}, "done": false, "episodes_total": 114, "training_iteration": 192, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-11-26", "timestamp": 1619874686, "time_this_iter_s": 12.70914602279663, "time_total_s": 2490.688994407654, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643f28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be0d0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2490.688994407654, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 18.888888888888893, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682500000000001, "episode_len_mean": 1781.24, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682500000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9975, -1.0, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0], "episode_lengths": [2371, 741, 215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546], "policy_pol_reward": [-0.9975, -1.0, -1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7111805649174983, "mean_raw_obs_processing_ms": 1.5783207131511068, "mean_inference_ms": 2.1666464217538244, "mean_action_processing_ms": 0.07371993774225208}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 193000, "timers": {"learn_time_ms": 18.448, "learn_throughput": 1734.624, "update_time_ms": 2.444}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004251786042004824, "cur_lr": 0.0005, "mean_q": -0.060293108224868774, "min_q": -0.6473994851112366, "max_q": 0.009392587468028069, "mean_td_error": 0.02429955266416073}}, "num_steps_sampled": 193000, "num_steps_trained": 1536032, "last_target_update_ts": 192520, "num_target_updates": 381}, "done": false, "episodes_total": 116, "training_iteration": 193, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-11-40", "timestamp": 1619874700, "time_this_iter_s": 13.356319189071655, "time_total_s": 2504.0453135967255, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45beae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45af510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2504.0453135967255, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 16.75263157894737, "ram_util_percent": 58.05263157894737}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682500000000001, "episode_len_mean": 1781.24, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682500000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0], "episode_lengths": [215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741], "policy_pol_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7111805649174985, "mean_raw_obs_processing_ms": 1.5783207131511068, "mean_inference_ms": 2.166646421753825, "mean_action_processing_ms": 0.07371993774225208}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 194000, "timers": {"learn_time_ms": 19.241, "learn_throughput": 1663.076, "update_time_ms": 2.277}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003130105324089527, "cur_lr": 0.0005, "mean_q": -0.04820738360285759, "min_q": -0.22070220112800598, "max_q": 0.008322378620505333, "mean_td_error": -0.004765253514051437}}, "num_steps_sampled": 194000, "num_steps_trained": 1544032, "last_target_update_ts": 193528, "num_target_updates": 383}, "done": false, "episodes_total": 116, "training_iteration": 194, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-11-53", "timestamp": 1619874713, "time_this_iter_s": 12.884193897247314, "time_total_s": 2516.929507493973, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45afbf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2516.929507493973, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 17.373684210526317, "ram_util_percent": 57.96315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682500000000001, "episode_len_mean": 1781.24, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682500000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0], "episode_lengths": [215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741], "policy_pol_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7111805649174985, "mean_raw_obs_processing_ms": 1.5783207131511068, "mean_inference_ms": 2.166646421753825, "mean_action_processing_ms": 0.07371993774225208}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 195000, "timers": {"learn_time_ms": 11.681, "learn_throughput": 2739.434, "update_time_ms": 1.681}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011068173917010427, "cur_lr": 0.0005, "mean_q": -0.043967105448246, "min_q": -0.21883559226989746, "max_q": 0.019524291157722473, "mean_td_error": -0.006947488058358431}}, "num_steps_sampled": 195000, "num_steps_trained": 1552032, "last_target_update_ts": 194536, "num_target_updates": 385}, "done": false, "episodes_total": 116, "training_iteration": 195, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-12-04", "timestamp": 1619874724, "time_this_iter_s": 11.791794776916504, "time_total_s": 2528.7213022708893, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45afb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45af598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2528.7213022708893, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 20.523529411764706, "ram_util_percent": 57.95882352941177}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682500000000001, "episode_len_mean": 1781.24, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682500000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0], "episode_lengths": [215, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741], "policy_pol_reward": [-1.0, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7111805649174985, "mean_raw_obs_processing_ms": 1.5783207131511068, "mean_inference_ms": 2.166646421753825, "mean_action_processing_ms": 0.07371993774225208}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196000, "timers": {"learn_time_ms": 19.014, "learn_throughput": 1683.002, "update_time_ms": 2.684}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020570375490933657, "cur_lr": 0.0005, "mean_q": -0.03386860713362694, "min_q": -0.19043636322021484, "max_q": 0.029385952278971672, "mean_td_error": -0.0030869552865624428}}, "num_steps_sampled": 196000, "num_steps_trained": 1560032, "last_target_update_ts": 195544, "num_target_updates": 387}, "done": false, "episodes_total": 116, "training_iteration": 196, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-12-17", "timestamp": 1619874737, "time_this_iter_s": 12.449857711791992, "time_total_s": 2541.1711599826813, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465fae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2541.1711599826813, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 57.99411764705883}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8682075, "episode_len_mean": 1815.03, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8682075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99575, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0], "episode_lengths": [3594, 4002, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741], "policy_pol_reward": [-0.99575, 0.007750000000000005, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.71155702708918, "mean_raw_obs_processing_ms": 1.5775891715194053, "mean_inference_ms": 2.166998408154293, "mean_action_processing_ms": 0.07372964471726196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 197000, "timers": {"learn_time_ms": 16.695, "learn_throughput": 1916.785, "update_time_ms": 2.167}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004072248470038176, "cur_lr": 0.0005, "mean_q": -0.0705123245716095, "min_q": -0.616931140422821, "max_q": -0.020090751349925995, "mean_td_error": -0.00740880286321044}}, "num_steps_sampled": 197000, "num_steps_trained": 1568032, "last_target_update_ts": 196552, "num_target_updates": 389}, "done": false, "episodes_total": 117, "training_iteration": 197, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-12-30", "timestamp": 1619874750, "time_this_iter_s": 12.949544191360474, "time_total_s": 2554.1207041740417, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46437b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2554.1207041740417, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 18.489473684210523, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8782850000000001, "episode_len_mean": 1786.14, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8782850000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575], "episode_lengths": [1113, 1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594], "policy_pol_reward": [-1.0, -1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575]}, "sampler_perf": {"mean_env_wait_ms": 1.7119218439062864, "mean_raw_obs_processing_ms": 1.5771133061770635, "mean_inference_ms": 2.1673962404316955, "mean_action_processing_ms": 0.07374045015931067}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 198000, "timers": {"learn_time_ms": 19.069, "learn_throughput": 1678.084, "update_time_ms": 2.209}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.001607885817065835, "cur_lr": 0.0005, "mean_q": -0.02568027190864086, "min_q": -0.12728533148765564, "max_q": 0.007031742483377457, "mean_td_error": -0.0026619562413543463}}, "num_steps_sampled": 198000, "num_steps_trained": 1576032, "last_target_update_ts": 197560, "num_target_updates": 391}, "done": false, "episodes_total": 118, "training_iteration": 198, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-12-43", "timestamp": 1619874763, "time_this_iter_s": 12.86379361152649, "time_total_s": 2566.9844977855682, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414990d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2566.9844977855682, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 15.727777777777776, "ram_util_percent": 58.06111111111112}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8782850000000001, "episode_len_mean": 1786.14, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8782850000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0], "episode_lengths": [1246, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113], "policy_pol_reward": [-1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7119218439062864, "mean_raw_obs_processing_ms": 1.5771133061770632, "mean_inference_ms": 2.167396240431695, "mean_action_processing_ms": 0.07374045015931067}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 199000, "timers": {"learn_time_ms": 17.165, "learn_throughput": 1864.241, "update_time_ms": 2.243}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003981770481914282, "cur_lr": 0.0005, "mean_q": -0.03700815141201019, "min_q": -0.14214423298835754, "max_q": -0.0008644014596939087, "mean_td_error": -0.010992931202054024}}, "num_steps_sampled": 199000, "num_steps_trained": 1584032, "last_target_update_ts": 198568, "num_target_updates": 393}, "done": false, "episodes_total": 118, "training_iteration": 199, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-12-56", "timestamp": 1619874776, "time_this_iter_s": 12.985206842422485, "time_total_s": 2579.9697046279907, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b8840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2579.9697046279907, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 19.84736842105263, "ram_util_percent": 58.0}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8782850000000001, "episode_len_mean": 1794.84, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8782850000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0], "episode_lengths": [2116, 3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113], "policy_pol_reward": [-1.0, -0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7122602759819088, "mean_raw_obs_processing_ms": 1.5767414926704049, "mean_inference_ms": 2.1677829005043994, "mean_action_processing_ms": 0.07375172391320098}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 200000, "timers": {"learn_time_ms": 16.292, "learn_throughput": 1964.154, "update_time_ms": 2.627}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0021470237988978624, "cur_lr": 0.0005, "mean_q": -0.045688316226005554, "min_q": -0.18232831358909607, "max_q": -0.001994788646697998, "mean_td_error": -0.009526681154966354}}, "num_steps_sampled": 200000, "num_steps_trained": 1592032, "last_target_update_ts": 199576, "num_target_updates": 395}, "done": false, "episodes_total": 119, "training_iteration": 200, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-13-09", "timestamp": 1619874789, "time_this_iter_s": 13.224997520446777, "time_total_s": 2593.1947021484375, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46439d8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2593.1947021484375, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 16.242105263157892, "ram_util_percent": 58.026315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8782850000000001, "episode_len_mean": 1794.84, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8782850000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0], "episode_lengths": [3900, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116], "policy_pol_reward": [-0.99575, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7122602759819088, "mean_raw_obs_processing_ms": 1.5767414926704046, "mean_inference_ms": 2.1677829005043994, "mean_action_processing_ms": 0.07375172391320098}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 201000, "timers": {"learn_time_ms": 20.603, "learn_throughput": 1553.164, "update_time_ms": 2.361}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0073525854386389256, "cur_lr": 0.0005, "mean_q": -0.03797391802072525, "min_q": -0.23475217819213867, "max_q": -0.004708172753453255, "mean_td_error": 0.024515673518180847}}, "num_steps_sampled": 201000, "num_steps_trained": 1600032, "last_target_update_ts": 200584, "num_target_updates": 397}, "done": false, "episodes_total": 119, "training_iteration": 201, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-13-23", "timestamp": 1619874803, "time_this_iter_s": 13.840447664260864, "time_total_s": 2607.0351498126984, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2607.0351498126984, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 18.115, "ram_util_percent": 58.019999999999996}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.878265, "episode_len_mean": 1771.64, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.878265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99375, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0], "episode_lengths": [1580, 4002, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116], "policy_pol_reward": [-0.99375, 0.0022500000000000003, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.712587385354251, "mean_raw_obs_processing_ms": 1.5766128428151986, "mean_inference_ms": 2.168146378826032, "mean_action_processing_ms": 0.07376355386689407}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 202000, "timers": {"learn_time_ms": 17.82, "learn_throughput": 1795.769, "update_time_ms": 2.237}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002326769521459937, "cur_lr": 0.0005, "mean_q": -0.013201631605625153, "min_q": -0.08683902025222778, "max_q": 0.03482503071427345, "mean_td_error": -0.0004935974720865488}}, "num_steps_sampled": 202000, "num_steps_trained": 1608032, "last_target_update_ts": 201592, "num_target_updates": 399}, "done": false, "episodes_total": 120, "training_iteration": 202, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-13-36", "timestamp": 1619874816, "time_this_iter_s": 13.189740180969238, "time_total_s": 2620.2248899936676, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2620.2248899936676, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 16.805555555555557, "ram_util_percent": 57.97222222222222}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8882750000000001, "episode_len_mean": 1745.55, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8882750000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99875, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375], "episode_lengths": [1393, 393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580], "policy_pol_reward": [-0.99875, -1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375]}, "sampler_perf": {"mean_env_wait_ms": 1.7128537575612157, "mean_raw_obs_processing_ms": 1.5767383817318323, "mean_inference_ms": 2.168472234696557, "mean_action_processing_ms": 0.07377455586201048}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 203000, "timers": {"learn_time_ms": 19.587, "learn_throughput": 1633.753, "update_time_ms": 2.266}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0068821231834590435, "cur_lr": 0.0005, "mean_q": -0.044437531381845474, "min_q": -0.3243844509124756, "max_q": 0.01300983875989914, "mean_td_error": -0.02227131836116314}}, "num_steps_sampled": 203000, "num_steps_trained": 1616032, "last_target_update_ts": 202600, "num_target_updates": 401}, "done": false, "episodes_total": 121, "training_iteration": 203, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-13-50", "timestamp": 1619874830, "time_this_iter_s": 13.337968826293945, "time_total_s": 2633.5628588199615, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643c80>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2633.5628588199615, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 18.580000000000002, "ram_util_percent": 58.00999999999999}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8882750000000001, "episode_len_mean": 1745.55, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8882750000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875], "episode_lengths": [393, 4002, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393], "policy_pol_reward": [-1.0, 0.0015, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875]}, "sampler_perf": {"mean_env_wait_ms": 1.7128537575612157, "mean_raw_obs_processing_ms": 1.5767383817318321, "mean_inference_ms": 2.168472234696557, "mean_action_processing_ms": 0.07377455586201048}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"learn_time_ms": 18.648, "learn_throughput": 1715.962, "update_time_ms": 2.352}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0032369429245591164, "cur_lr": 0.0005, "mean_q": -0.0155909713357687, "min_q": -0.08177375048398972, "max_q": 0.023460805416107178, "mean_td_error": 0.0040857684798538685}}, "num_steps_sampled": 204000, "num_steps_trained": 1624032, "last_target_update_ts": 203608, "num_target_updates": 403}, "done": false, "episodes_total": 121, "training_iteration": 204, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-14-03", "timestamp": 1619874843, "time_this_iter_s": 12.98518991470337, "time_total_s": 2646.548048734665, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2646.548048734665, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 17.466666666666665, "ram_util_percent": 58.016666666666666}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982775000000001, "episode_len_mean": 1720.68, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982775000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99875, -1.0, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875], "episode_lengths": [1838, 70, 1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393], "policy_pol_reward": [-0.99875, -1.0, -1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875]}, "sampler_perf": {"mean_env_wait_ms": 1.7133143104362747, "mean_raw_obs_processing_ms": 1.577204604476975, "mean_inference_ms": 2.1690101166020788, "mean_action_processing_ms": 0.07379313336671578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 205000, "timers": {"learn_time_ms": 19.55, "learn_throughput": 1636.828, "update_time_ms": 2.865}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00805511325597763, "cur_lr": 0.0005, "mean_q": -0.04514199495315552, "min_q": -0.3167875111103058, "max_q": 0.005184557288885117, "mean_td_error": 0.011780820786952972}}, "num_steps_sampled": 205000, "num_steps_trained": 1632032, "last_target_update_ts": 204616, "num_target_updates": 405}, "done": false, "episodes_total": 123, "training_iteration": 205, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-14-17", "timestamp": 1619874857, "time_this_iter_s": 13.651440620422363, "time_total_s": 2660.1994893550873, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2660.1994893550873, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 17.794999999999998, "ram_util_percent": 57.93500000000002}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982775000000001, "episode_len_mean": 1720.68, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982775000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0], "episode_lengths": [1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70], "policy_pol_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7133143104362745, "mean_raw_obs_processing_ms": 1.577204604476975, "mean_inference_ms": 2.1690101166020788, "mean_action_processing_ms": 0.07379313336671578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 206000, "timers": {"learn_time_ms": 18.299, "learn_throughput": 1748.777, "update_time_ms": 2.492}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0010672840289771557, "cur_lr": 0.0005, "mean_q": -0.03516888618469238, "min_q": -0.10030738264322281, "max_q": 4.9639493227005005e-06, "mean_td_error": 0.0002771633444353938}}, "num_steps_sampled": 206000, "num_steps_trained": 1640032, "last_target_update_ts": 205624, "num_target_updates": 407}, "done": false, "episodes_total": 123, "training_iteration": 206, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-14-30", "timestamp": 1619874870, "time_this_iter_s": 13.418774366378784, "time_total_s": 2673.618263721466, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643950>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2673.618263721466, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 21.642105263157895, "ram_util_percent": 57.90526315789474}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982775000000001, "episode_len_mean": 1720.68, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982775000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0], "episode_lengths": [1625, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70], "policy_pol_reward": [-1.0, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7133143104362745, "mean_raw_obs_processing_ms": 1.577204604476975, "mean_inference_ms": 2.1690101166020788, "mean_action_processing_ms": 0.07379313336671578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 207000, "timers": {"learn_time_ms": 18.896, "learn_throughput": 1693.452, "update_time_ms": 2.429}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002188292797654867, "cur_lr": 0.0005, "mean_q": -0.035657431930303574, "min_q": -0.20229104161262512, "max_q": -0.006516816094517708, "mean_td_error": -0.005946172866970301}}, "num_steps_sampled": 207000, "num_steps_trained": 1648032, "last_target_update_ts": 206632, "num_target_updates": 409}, "done": false, "episodes_total": 123, "training_iteration": 207, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-14-43", "timestamp": 1619874883, "time_this_iter_s": 13.398740530014038, "time_total_s": 2687.01700425148, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45c1c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2687.01700425148, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 18.93157894736842, "ram_util_percent": 58.026315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982600000000001, "episode_len_mean": 1735.15, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982600000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99825, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0], "episode_lengths": [3072, 211, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70], "policy_pol_reward": [-0.99825, -1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7135221885873007, "mean_raw_obs_processing_ms": 1.577563564775417, "mean_inference_ms": 2.1692330434265554, "mean_action_processing_ms": 0.07380155785299541}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timers": {"learn_time_ms": 17.773, "learn_throughput": 1800.476, "update_time_ms": 2.379}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0034661833196878433, "cur_lr": 0.0005, "mean_q": -0.03404713422060013, "min_q": -0.2543715834617615, "max_q": 0.001947246491909027, "mean_td_error": -0.014176265336573124}}, "num_steps_sampled": 208000, "num_steps_trained": 1656032, "last_target_update_ts": 207640, "num_target_updates": 411}, "done": false, "episodes_total": 124, "training_iteration": 208, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-14-56", "timestamp": 1619874896, "time_this_iter_s": 12.89789605140686, "time_total_s": 2699.914900302887, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414382510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2699.914900302887, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 16.47222222222222, "ram_util_percent": 58.02777777777778}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982600000000001, "episode_len_mean": 1744.03, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982600000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825], "episode_lengths": [1099, 58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072], "policy_pol_reward": [-1.0, -0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825]}, "sampler_perf": {"mean_env_wait_ms": 1.7137322861156483, "mean_raw_obs_processing_ms": 1.577913338877635, "mean_inference_ms": 2.16945626674762, "mean_action_processing_ms": 0.07380995630468233}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 209000, "timers": {"learn_time_ms": 19.003, "learn_throughput": 1683.923, "update_time_ms": 2.942}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0026051218155771494, "cur_lr": 0.0005, "mean_q": -0.0442361906170845, "min_q": -0.2616726756095886, "max_q": -0.015610788017511368, "mean_td_error": -0.009046953171491623}}, "num_steps_sampled": 209000, "num_steps_trained": 1664032, "last_target_update_ts": 208648, "num_target_updates": 413}, "done": false, "episodes_total": 125, "training_iteration": 209, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-15-09", "timestamp": 1619874909, "time_this_iter_s": 12.913392066955566, "time_total_s": 2712.8282923698425, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2712.8282923698425, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 17.30526315789474, "ram_util_percent": 57.93157894736842}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.89826, "episode_len_mean": 1744.03, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.89826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0], "episode_lengths": [58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099], "policy_pol_reward": [-0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7137322861156483, "mean_raw_obs_processing_ms": 1.577913338877635, "mean_inference_ms": 2.16945626674762, "mean_action_processing_ms": 0.07380995630468234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 210000, "timers": {"learn_time_ms": 20.017, "learn_throughput": 1598.675, "update_time_ms": 2.752}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.006215943489223719, "cur_lr": 0.0005, "mean_q": -0.028681203722953796, "min_q": -0.22711198031902313, "max_q": 0.02761058881878853, "mean_td_error": 0.022829469293355942}}, "num_steps_sampled": 210000, "num_steps_trained": 1672032, "last_target_update_ts": 209656, "num_target_updates": 415}, "done": false, "episodes_total": 125, "training_iteration": 210, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-15-23", "timestamp": 1619874923, "time_this_iter_s": 13.341164588928223, "time_total_s": 2726.1694569587708, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bed90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7ae8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2726.1694569587708, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 17.510526315789473, "ram_util_percent": 58.06315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.89826, "episode_len_mean": 1744.03, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.89826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0], "episode_lengths": [58, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099], "policy_pol_reward": [-0.99925, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7137322861156483, "mean_raw_obs_processing_ms": 1.577913338877635, "mean_inference_ms": 2.16945626674762, "mean_action_processing_ms": 0.07380995630468234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 211000, "timers": {"learn_time_ms": 19.176, "learn_throughput": 1668.727, "update_time_ms": 2.168}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018651457503437996, "cur_lr": 0.0005, "mean_q": -0.025542519986629486, "min_q": -0.277456134557724, "max_q": 0.028617387637495995, "mean_td_error": 0.0010864944197237492}}, "num_steps_sampled": 211000, "num_steps_trained": 1680032, "last_target_update_ts": 210664, "num_target_updates": 417}, "done": false, "episodes_total": 125, "training_iteration": 211, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-15-36", "timestamp": 1619874936, "time_this_iter_s": 12.879114389419556, "time_total_s": 2739.0485713481903, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45be840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2739.0485713481903, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 18.833333333333332, "ram_util_percent": 57.98888888888889}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982499999999999, "episode_len_mean": 1770.4, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982499999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99825, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0], "episode_lengths": [2695, 2274, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099], "policy_pol_reward": [-0.99825, -0.9985, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7139479747398607, "mean_raw_obs_processing_ms": 1.5782566225053685, "mean_inference_ms": 2.1696821289429646, "mean_action_processing_ms": 0.07381836665558952}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 212000, "timers": {"learn_time_ms": 20.071, "learn_throughput": 1594.376, "update_time_ms": 2.62}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0006480286247096956, "cur_lr": 0.0005, "mean_q": -0.061944231390953064, "min_q": -0.7315351963043213, "max_q": -0.003198547288775444, "mean_td_error": -0.0007923385128378868}}, "num_steps_sampled": 212000, "num_steps_trained": 1688032, "last_target_update_ts": 211672, "num_target_updates": 419}, "done": false, "episodes_total": 126, "training_iteration": 212, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-15-49", "timestamp": 1619874949, "time_this_iter_s": 13.160282850265503, "time_total_s": 2752.208854198456, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643f28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643a60>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2752.208854198456, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 17.968421052631584, "ram_util_percent": 57.978947368421046}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.898265, "episode_len_mean": 1761.69, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.898265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825], "episode_lengths": [1403, 2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695], "policy_pol_reward": [-1.0, -1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825]}, "sampler_perf": {"mean_env_wait_ms": 1.7141562943085713, "mean_raw_obs_processing_ms": 1.578615263512056, "mean_inference_ms": 2.169891470971208, "mean_action_processing_ms": 0.0738253934272726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 213000, "timers": {"learn_time_ms": 19.88, "learn_throughput": 1609.663, "update_time_ms": 2.79}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027378711383789778, "cur_lr": 0.0005, "mean_q": -0.03578419238328934, "min_q": -0.16792213916778564, "max_q": 0.004686376079916954, "mean_td_error": 0.019419318065047264}}, "num_steps_sampled": 213000, "num_steps_trained": 1696032, "last_target_update_ts": 212680, "num_target_updates": 421}, "done": false, "episodes_total": 127, "training_iteration": 213, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-16-02", "timestamp": 1619874962, "time_this_iter_s": 13.232439041137695, "time_total_s": 2765.4412932395935, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a3c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2765.4412932395935, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 17.000000000000004, "ram_util_percent": 58.021052631578954}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982649999999999, "episode_len_mean": 1761.69, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982649999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0], "episode_lengths": [2587, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403], "policy_pol_reward": [-1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7141562943085713, "mean_raw_obs_processing_ms": 1.578615263512056, "mean_inference_ms": 2.169891470971208, "mean_action_processing_ms": 0.07382539342727258}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 214000, "timers": {"learn_time_ms": 15.304, "learn_throughput": 2090.951, "update_time_ms": 2.111}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004726438783109188, "cur_lr": 0.0005, "mean_q": -0.025639671832323074, "min_q": -0.07541139423847198, "max_q": 0.008449645712971687, "mean_td_error": 0.029446285218000412}}, "num_steps_sampled": 214000, "num_steps_trained": 1704032, "last_target_update_ts": 213688, "num_target_updates": 423}, "done": false, "episodes_total": 127, "training_iteration": 214, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-16-16", "timestamp": 1619874976, "time_this_iter_s": 13.194574356079102, "time_total_s": 2778.6358675956726, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2778.6358675956726, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 17.76842105263158, "ram_util_percent": 58.07368421052631}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.8982649999999999, "episode_len_mean": 1749.73, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.8982649999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0], "episode_lengths": [1391, 4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403], "policy_pol_reward": [-1.0, 0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7143439811985757, "mean_raw_obs_processing_ms": 1.579093277004019, "mean_inference_ms": 2.1700933658299717, "mean_action_processing_ms": 0.07383221034964528}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 215000, "timers": {"learn_time_ms": 18.206, "learn_throughput": 1757.644, "update_time_ms": 2.812}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004072684794664383, "cur_lr": 0.0005, "mean_q": -0.037372708320617676, "min_q": -0.20707404613494873, "max_q": -0.004439115524291992, "mean_td_error": 0.019292660057544708}}, "num_steps_sampled": 215000, "num_steps_trained": 1712032, "last_target_update_ts": 214696, "num_target_updates": 425}, "done": false, "episodes_total": 128, "training_iteration": 215, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-16-29", "timestamp": 1619874989, "time_this_iter_s": 13.447040796279907, "time_total_s": 2792.0829083919525, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643f28>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2792.0829083919525, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 18.252631578947366, "ram_util_percent": 57.93684210526315}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.898265, "episode_len_mean": 1749.73, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.898265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0], "episode_lengths": [4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391], "policy_pol_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7143439811985755, "mean_raw_obs_processing_ms": 1.5790932770040191, "mean_inference_ms": 2.1700933658299717, "mean_action_processing_ms": 0.07383221034964527}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"learn_time_ms": 20.44, "learn_throughput": 1565.552, "update_time_ms": 2.504}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002099111210554838, "cur_lr": 0.0005, "mean_q": -0.01823597401380539, "min_q": -0.13634172081947327, "max_q": 0.028324086219072342, "mean_td_error": -0.0011707571102306247}}, "num_steps_sampled": 216000, "num_steps_trained": 1720032, "last_target_update_ts": 215704, "num_target_updates": 427}, "done": false, "episodes_total": 128, "training_iteration": 216, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-16-42", "timestamp": 1619875002, "time_this_iter_s": 13.299792289733887, "time_total_s": 2805.3827006816864, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414382510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2805.3827006816864, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 16.863157894736844, "ram_util_percent": 57.96315789473685}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.898265, "episode_len_mean": 1749.73, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.898265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0], "episode_lengths": [4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391], "policy_pol_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7143439811985755, "mean_raw_obs_processing_ms": 1.5790932770040191, "mean_inference_ms": 2.1700933658299717, "mean_action_processing_ms": 0.07383221034964527}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 217000, "timers": {"learn_time_ms": 20.357, "learn_throughput": 1571.951, "update_time_ms": 2.67}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004560778848826885, "cur_lr": 0.0005, "mean_q": -0.017581932246685028, "min_q": -0.14590592682361603, "max_q": 0.040848568081855774, "mean_td_error": 0.030767500400543213}}, "num_steps_sampled": 217000, "num_steps_trained": 1728032, "last_target_update_ts": 216712, "num_target_updates": 429}, "done": false, "episodes_total": 128, "training_iteration": 217, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-16-55", "timestamp": 1619875015, "time_this_iter_s": 12.418248176574707, "time_total_s": 2817.800948858261, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b3840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2817.800948858261, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 22.355555555555558, "ram_util_percent": 57.916666666666664}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.898265, "episode_len_mean": 1749.73, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.898265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0], "episode_lengths": [4002, 491, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391], "policy_pol_reward": [0.006000000000000004, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7143439811985755, "mean_raw_obs_processing_ms": 1.5790932770040191, "mean_inference_ms": 2.1700933658299717, "mean_action_processing_ms": 0.07383221034964527}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 218000, "timers": {"learn_time_ms": 17.221, "learn_throughput": 1858.184, "update_time_ms": 2.624}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011417469941079617, "cur_lr": 0.0005, "mean_q": -0.017912721261382103, "min_q": -0.1252451092004776, "max_q": 0.010471992194652557, "mean_td_error": -0.004833760671317577}}, "num_steps_sampled": 218000, "num_steps_trained": 1736032, "last_target_update_ts": 217720, "num_target_updates": 431}, "done": false, "episodes_total": 128, "training_iteration": 218, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-17-08", "timestamp": 1619875028, "time_this_iter_s": 13.041680574417114, "time_total_s": 2830.842629432678, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44a4aec6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2830.842629432678, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 17.763157894736842, "ram_util_percent": 57.97894736842106}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.89831, "episode_len_mean": 1748.6, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.89831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0015, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0], "episode_lengths": [4002, 378, 1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391], "policy_pol_reward": [0.0015, -1.0, -0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7146829676412931, "mean_raw_obs_processing_ms": 1.5799620996005217, "mean_inference_ms": 2.170451917715112, "mean_action_processing_ms": 0.07384295388666862}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 219000, "timers": {"learn_time_ms": 14.644, "learn_throughput": 2185.17, "update_time_ms": 1.889}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0002458230301272124, "cur_lr": 0.0005, "mean_q": -0.021394696086645126, "min_q": -0.08465749770402908, "max_q": 0.002610510215163231, "mean_td_error": -0.00022939476184546947}}, "num_steps_sampled": 219000, "num_steps_trained": 1744032, "last_target_update_ts": 218728, "num_target_updates": 433}, "done": false, "episodes_total": 130, "training_iteration": 219, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-17-21", "timestamp": 1619875041, "time_this_iter_s": 13.27577543258667, "time_total_s": 2844.118404865265, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a3b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a3598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2844.118404865265, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 16.99473684210526, "ram_util_percent": 58.05263157894737}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.89831, "episode_len_mean": 1748.6, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.89831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0], "episode_lengths": [1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378], "policy_pol_reward": [-0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7146829676412936, "mean_raw_obs_processing_ms": 1.5799620996005215, "mean_inference_ms": 2.170451917715112, "mean_action_processing_ms": 0.0738429538866686}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220000, "timers": {"learn_time_ms": 19.255, "learn_throughput": 1661.923, "update_time_ms": 2.49}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004943140782415867, "cur_lr": 0.0005, "mean_q": -0.04139607772231102, "min_q": -0.6788123846054077, "max_q": 0.02255089394748211, "mean_td_error": 0.014142372645437717}}, "num_steps_sampled": 220000, "num_steps_trained": 1752032, "last_target_update_ts": 219736, "num_target_updates": 435}, "done": false, "episodes_total": 130, "training_iteration": 220, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-17-35", "timestamp": 1619875055, "time_this_iter_s": 13.545056104660034, "time_total_s": 2857.663460969925, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45af510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2857.663460969925, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 19.357894736842105, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.89831, "episode_len_mean": 1748.6, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.89831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0], "episode_lengths": [1362, 3333, 4002, 1036, 1878, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378], "policy_pol_reward": [-0.9995, -1.0, 0.0, -1.0, -0.9995, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7146829676412936, "mean_raw_obs_processing_ms": 1.5799620996005215, "mean_inference_ms": 2.170451917715112, "mean_action_processing_ms": 0.0738429538866686}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 221000, "timers": {"learn_time_ms": 18.999, "learn_throughput": 1684.309, "update_time_ms": 2.276}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0043867784552276134, "cur_lr": 0.0005, "mean_q": -0.03358226269483566, "min_q": -0.4566001296043396, "max_q": 0.025089692324399948, "mean_td_error": 0.015345689840614796}}, "num_steps_sampled": 221000, "num_steps_trained": 1760032, "last_target_update_ts": 220744, "num_target_updates": 437}, "done": false, "episodes_total": 130, "training_iteration": 221, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-17-48", "timestamp": 1619875068, "time_this_iter_s": 13.38857388496399, "time_total_s": 2871.052034854889, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa46438c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2871.052034854889, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 17.04736842105263, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.9083025, "episode_len_mean": 1661.11, "episodes_this_iter": 5, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.9083025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99825, -1.0, -1.0, -1.0, -1.0, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0], "episode_lengths": [2426, 53, 18, 173, 192, 96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378], "policy_pol_reward": [-0.99825, -1.0, -1.0, -1.0, -1.0, -0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7152250509108677, "mean_raw_obs_processing_ms": 1.5823233051510612, "mean_inference_ms": 2.1708850739319376, "mean_action_processing_ms": 0.07384384653222335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 222000, "timers": {"learn_time_ms": 15.75, "learn_throughput": 2031.798, "update_time_ms": 2.809}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002448540646582842, "cur_lr": 0.0005, "mean_q": -0.016791485249996185, "min_q": -0.203095942735672, "max_q": 0.009379134513437748, "mean_td_error": -0.009161127731204033}}, "num_steps_sampled": 222000, "num_steps_trained": 1768032, "last_target_update_ts": 221752, "num_target_updates": 439}, "done": false, "episodes_total": 135, "training_iteration": 222, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-18-01", "timestamp": 1619875081, "time_this_iter_s": 13.114855766296387, "time_total_s": 2884.1668906211853, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45afd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4413be7d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2884.1668906211853, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 16.563157894736843, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.9083025, "episode_len_mean": 1661.11, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.9083025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [96, 1306, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192], "policy_pol_reward": [-0.99725, -0.9975, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7152250509108675, "mean_raw_obs_processing_ms": 1.5823233051510612, "mean_inference_ms": 2.170885073931938, "mean_action_processing_ms": 0.07384384653222337}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 223000, "timers": {"learn_time_ms": 15.126, "learn_throughput": 2115.557, "update_time_ms": 2.176}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003540673293173313, "cur_lr": 0.0005, "mean_q": -0.05502965673804283, "min_q": -0.7283836603164673, "max_q": 0.015451587736606598, "mean_td_error": 0.001226645428687334}}, "num_steps_sampled": 223000, "num_steps_trained": 1776032, "last_target_update_ts": 222760, "num_target_updates": 441}, "done": false, "episodes_total": 135, "training_iteration": 223, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-18-15", "timestamp": 1619875095, "time_this_iter_s": 13.713499069213867, "time_total_s": 2897.880389690399, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45af840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2897.880389690399, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 18.439999999999998, "ram_util_percent": 57.964999999999996}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.90833, "episode_len_mean": 1669.39, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.90833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9975, -1.0, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1921, 309, 3775, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192], "policy_pol_reward": [-0.9975, -1.0, -1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7153792805571249, "mean_raw_obs_processing_ms": 1.5833585709556632, "mean_inference_ms": 2.17099413685697, "mean_action_processing_ms": 0.07384216809496526}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 224000, "timers": {"learn_time_ms": 17.913, "learn_throughput": 1786.373, "update_time_ms": 2.238}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013558551436290145, "cur_lr": 0.0005, "mean_q": -0.020840691402554512, "min_q": -0.096520334482193, "max_q": 0.012621372938156128, "mean_td_error": 0.0018072495004162192}}, "num_steps_sampled": 224000, "num_steps_trained": 1784032, "last_target_update_ts": 223768, "num_target_updates": 443}, "done": false, "episodes_total": 137, "training_iteration": 224, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-18-29", "timestamp": 1619875109, "time_this_iter_s": 13.400609970092773, "time_total_s": 2911.280999660492, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa46439d8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2911.280999660492, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 17.826315789473682, "ram_util_percent": 58.04210526315789}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.010500000000000008, "episode_reward_min": -1.0, "episode_reward_mean": -0.90833, "episode_len_mean": 1644.63, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.010500000000000008}, "policy_reward_mean": {"pol": -0.90833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0], "episode_lengths": [1299, 4002, 2939, 4002, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309], "policy_pol_reward": [-1.0, 0.006000000000000004, -0.9945, 0.010500000000000008, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7154261567828744, "mean_raw_obs_processing_ms": 1.5838866390527016, "mean_inference_ms": 2.171025053874509, "mean_action_processing_ms": 0.07384102629425933}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 225000, "timers": {"learn_time_ms": 14.955, "learn_throughput": 2139.757, "update_time_ms": 2.312}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0009942562319338322, "cur_lr": 0.0005, "mean_q": -0.0006616450846195221, "min_q": -0.06510435789823532, "max_q": 0.020780187100172043, "mean_td_error": -0.0005789679125882685}}, "num_steps_sampled": 225000, "num_steps_trained": 1792032, "last_target_update_ts": 224776, "num_target_updates": 445}, "done": false, "episodes_total": 138, "training_iteration": 225, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-18-42", "timestamp": 1619875122, "time_this_iter_s": 13.210393190383911, "time_total_s": 2924.491392850876, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bec80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45be158>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2924.491392850876, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 17.46842105263158, "ram_util_percent": 57.994736842105254}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.92855, "episode_len_mean": 1544.05, "episodes_this_iter": 3, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.92855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0], "episode_lengths": [60, 58, 767, 4002, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299], "policy_pol_reward": [-1.0, -1.0, -1.0, 0.0037500000000000016, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7154942638691058, "mean_raw_obs_processing_ms": 1.585310680526693, "mean_inference_ms": 2.170933238383978, "mean_action_processing_ms": 0.0738321682213515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 226000, "timers": {"learn_time_ms": 19.144, "learn_throughput": 1671.541, "update_time_ms": 2.685}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0010647006565704942, "cur_lr": 0.0005, "mean_q": -0.003371722064912319, "min_q": -0.15489210188388824, "max_q": 0.03873898833990097, "mean_td_error": -0.004860682412981987}}, "num_steps_sampled": 226000, "num_steps_trained": 1800032, "last_target_update_ts": 225784, "num_target_updates": 447}, "done": false, "episodes_total": 141, "training_iteration": 226, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-18-56", "timestamp": 1619875136, "time_this_iter_s": 13.622005701065063, "time_total_s": 2938.113398551941, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa465f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2938.113398551941, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 18.09473684210526, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385874999999999, "episode_len_mean": 1507.27, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385874999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [324, 339, 2513, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7155260844486029, "mean_raw_obs_processing_ms": 1.5857339622108784, "mean_inference_ms": 2.170914079676768, "mean_action_processing_ms": 0.0738297906595358}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 227000, "timers": {"learn_time_ms": 12.406, "learn_throughput": 2579.324, "update_time_ms": 1.851}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0015842041466385126, "cur_lr": 0.0005, "mean_q": -0.013557661324739456, "min_q": -0.21215945482254028, "max_q": 0.017906522378325462, "mean_td_error": -0.008622231893241405}}, "num_steps_sampled": 227000, "num_steps_trained": 1808032, "last_target_update_ts": 226792, "num_target_updates": 449}, "done": false, "episodes_total": 142, "training_iteration": 227, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-19-09", "timestamp": 1619875149, "time_this_iter_s": 13.22719120979309, "time_total_s": 2951.340589761734, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa4643620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643730>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2951.340589761734, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 20.731578947368423, "ram_util_percent": 57.95263157894736}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385875000000001, "episode_len_mean": 1494.03, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385875000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [1386, 142, 2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324], "policy_pol_reward": [-1.0, -1.0, -0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7155875520012658, "mean_raw_obs_processing_ms": 1.5866175938600477, "mean_inference_ms": 2.1708746098708556, "mean_action_processing_ms": 0.0738252605406919}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"learn_time_ms": 20.304, "learn_throughput": 1576.03, "update_time_ms": 2.397}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00379363214597106, "cur_lr": 0.0005, "mean_q": -0.018438680097460747, "min_q": -0.13945725560188293, "max_q": -0.0019503943622112274, "mean_td_error": 0.02361164800822735}}, "num_steps_sampled": 228000, "num_steps_trained": 1816032, "last_target_update_ts": 227800, "num_target_updates": 451}, "done": false, "episodes_total": 144, "training_iteration": 228, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-19-22", "timestamp": 1619875162, "time_this_iter_s": 12.948614835739136, "time_total_s": 2964.289204597473, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f4414990d90>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2964.289204597473, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 19.21578947368421, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385875, "episode_len_mean": 1494.03, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142], "policy_pol_reward": [-0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7155875520012651, "mean_raw_obs_processing_ms": 1.5866175938600475, "mean_inference_ms": 2.1708746098708556, "mean_action_processing_ms": 0.0738252605406919}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 229000, "timers": {"learn_time_ms": 18.212, "learn_throughput": 1757.115, "update_time_ms": 2.283}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003507839050143957, "cur_lr": 0.0005, "mean_q": -0.029227228835225105, "min_q": -0.28430604934692383, "max_q": 0.020470092073082924, "mean_td_error": -0.016086064279079437}}, "num_steps_sampled": 229000, "num_steps_trained": 1824032, "last_target_update_ts": 228808, "num_target_updates": 453}, "done": false, "episodes_total": 144, "training_iteration": 229, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-19-35", "timestamp": 1619875175, "time_this_iter_s": 13.37911057472229, "time_total_s": 2977.6683151721954, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4474d06378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f44149710d0>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2977.6683151721954, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 17.63157894736842, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385875, "episode_len_mean": 1494.03, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2465, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142], "policy_pol_reward": [-0.99475, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7155875520012651, "mean_raw_obs_processing_ms": 1.5866175938600475, "mean_inference_ms": 2.1708746098708556, "mean_action_processing_ms": 0.0738252605406919}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 230000, "timers": {"learn_time_ms": 17.884, "learn_throughput": 1789.348, "update_time_ms": 2.992}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027803853154182434, "cur_lr": 0.0005, "mean_q": -0.04082921892404556, "min_q": -0.18760162591934204, "max_q": 0.014013923704624176, "mean_td_error": -0.013773826882243156}}, "num_steps_sampled": 230000, "num_steps_trained": 1832032, "last_target_update_ts": 229816, "num_target_updates": 455}, "done": false, "episodes_total": 144, "training_iteration": 230, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-19-48", "timestamp": 1619875188, "time_this_iter_s": 12.460960626602173, "time_total_s": 2990.1292757987976, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f44149712f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7378>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 2990.1292757987976, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 16.811764705882354, "ram_util_percent": 57.98235294117647}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385725, "episode_len_mean": 1497.93, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99325, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [2855, 3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142], "policy_pol_reward": [-0.99325, -0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.715609499212201, "mean_raw_obs_processing_ms": 1.5870453323053013, "mean_inference_ms": 2.1708453658547517, "mean_action_processing_ms": 0.0738228436157619}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 231000, "timers": {"learn_time_ms": 20.362, "learn_throughput": 1571.535, "update_time_ms": 2.45}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0036496352404356003, "cur_lr": 0.0005, "mean_q": -0.037842925637960434, "min_q": -0.1908714920282364, "max_q": -0.009227756410837173, "mean_td_error": -0.011641904711723328}}, "num_steps_sampled": 231000, "num_steps_trained": 1840032, "last_target_update_ts": 230824, "num_target_updates": 457}, "done": false, "episodes_total": 145, "training_iteration": 231, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-20-01", "timestamp": 1619875201, "time_this_iter_s": 13.00534439086914, "time_total_s": 3003.1346201896667, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d08>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3003.1346201896667, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 17.736842105263158, "ram_util_percent": 58.00526315789473}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385724999999999, "episode_len_mean": 1497.93, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385724999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325], "episode_lengths": [3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855], "policy_pol_reward": [-0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325]}, "sampler_perf": {"mean_env_wait_ms": 1.715609499212201, "mean_raw_obs_processing_ms": 1.587045332305301, "mean_inference_ms": 2.1708453658547517, "mean_action_processing_ms": 0.07382284361576191}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 232000, "timers": {"learn_time_ms": 15.824, "learn_throughput": 2022.277, "update_time_ms": 2.247}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027969249058514833, "cur_lr": 0.0005, "mean_q": -0.009411536157131195, "min_q": -0.18024089932441711, "max_q": 0.02368350699543953, "mean_td_error": 0.001690052216872573}}, "num_steps_sampled": 232000, "num_steps_trained": 1848032, "last_target_update_ts": 231832, "num_target_updates": 459}, "done": false, "episodes_total": 145, "training_iteration": 232, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-20-13", "timestamp": 1619875213, "time_this_iter_s": 12.114305019378662, "time_total_s": 3015.2489252090454, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bf510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3015.2489252090454, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 17.829411764705885, "ram_util_percent": 58.04117647058823}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385724999999999, "episode_len_mean": 1497.93, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385724999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325], "episode_lengths": [3508, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855], "policy_pol_reward": [-0.99025, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325]}, "sampler_perf": {"mean_env_wait_ms": 1.715609499212201, "mean_raw_obs_processing_ms": 1.587045332305301, "mean_inference_ms": 2.1708453658547517, "mean_action_processing_ms": 0.07382284361576191}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 233000, "timers": {"learn_time_ms": 17.999, "learn_throughput": 1777.829, "update_time_ms": 2.741}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020110076293349266, "cur_lr": 0.0005, "mean_q": -0.042396366596221924, "min_q": -0.1118299812078476, "max_q": -0.0173597764223814, "mean_td_error": -0.004346497356891632}}, "num_steps_sampled": 233000, "num_steps_trained": 1856032, "last_target_update_ts": 232840, "num_target_updates": 461}, "done": false, "episodes_total": 145, "training_iteration": 233, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-20-27", "timestamp": 1619875227, "time_this_iter_s": 13.614583015441895, "time_total_s": 3028.8635082244873, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45bfbf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3028.8635082244873, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 17.29, "ram_util_percent": 58.004999999999995}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9385899999999999, "episode_len_mean": 1495.4, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9385899999999999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.992, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325], "episode_lengths": [3255, 2974, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855], "policy_pol_reward": [-0.992, -0.99675, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325]}, "sampler_perf": {"mean_env_wait_ms": 1.7156353291526603, "mean_raw_obs_processing_ms": 1.5874359755773413, "mean_inference_ms": 2.17082536744184, "mean_action_processing_ms": 0.07382093202807012}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 234000, "timers": {"learn_time_ms": 18.012, "learn_throughput": 1776.556, "update_time_ms": 2.348}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004094292875379324, "cur_lr": 0.0005, "mean_q": -0.023531939834356308, "min_q": -0.2069719433784485, "max_q": 0.010713353753089905, "mean_td_error": 0.028266768902540207}}, "num_steps_sampled": 234000, "num_steps_trained": 1864032, "last_target_update_ts": 233848, "num_target_updates": 463}, "done": false, "episodes_total": 146, "training_iteration": 234, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-20-40", "timestamp": 1619875240, "time_this_iter_s": 13.023427486419678, "time_total_s": 3041.886935710907, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bfc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3041.886935710907, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 19.85, "ram_util_percent": 58.044444444444444}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9386225000000001, "episode_len_mean": 1467.53, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9386225000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992], "episode_lengths": [187, 18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992]}, "sampler_perf": {"mean_env_wait_ms": 1.7156780727333145, "mean_raw_obs_processing_ms": 1.5877899123376287, "mean_inference_ms": 2.1708169286487733, "mean_action_processing_ms": 0.0738195286602644}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 235000, "timers": {"learn_time_ms": 19.406, "learn_throughput": 1648.956, "update_time_ms": 2.635}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017085801810026169, "cur_lr": 0.0005, "mean_q": -0.0055157095193862915, "min_q": -0.06997861713171005, "max_q": 0.017072759568691254, "mean_td_error": 0.002915876917541027}}, "num_steps_sampled": 235000, "num_steps_trained": 1872032, "last_target_update_ts": 234856, "num_target_updates": 465}, "done": false, "episodes_total": 147, "training_iteration": 235, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-20-53", "timestamp": 1619875253, "time_this_iter_s": 13.312931537628174, "time_total_s": 3055.199867248535, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45bf048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3055.199867248535, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 17.3, "ram_util_percent": 58.0578947368421}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9386225, "episode_len_mean": 1467.53, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9386225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0], "episode_lengths": [18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7156780727333145, "mean_raw_obs_processing_ms": 1.5877899123376287, "mean_inference_ms": 2.1708169286487733, "mean_action_processing_ms": 0.0738195286602644}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 236000, "timers": {"learn_time_ms": 16.997, "learn_throughput": 1882.645, "update_time_ms": 2.874}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013381718890741467, "cur_lr": 0.0005, "mean_q": -0.0057217031717300415, "min_q": -0.12887492775917053, "max_q": 0.029878532513976097, "mean_td_error": -0.006976489908993244}}, "num_steps_sampled": 236000, "num_steps_trained": 1880032, "last_target_update_ts": 235864, "num_target_updates": 467}, "done": false, "episodes_total": 147, "training_iteration": 236, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-21-06", "timestamp": 1619875266, "time_this_iter_s": 12.596971988677979, "time_total_s": 3067.796839237213, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414990d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b1bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3067.796839237213, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 16.97222222222222, "ram_util_percent": 58.02222222222221}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9386225, "episode_len_mean": 1467.53, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9386225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0], "episode_lengths": [18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7156780727333145, "mean_raw_obs_processing_ms": 1.5877899123376287, "mean_inference_ms": 2.1708169286487733, "mean_action_processing_ms": 0.0738195286602644}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 237000, "timers": {"learn_time_ms": 18.03, "learn_throughput": 1774.81, "update_time_ms": 2.313}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0007997663924470544, "cur_lr": 0.0005, "mean_q": -0.002609106944873929, "min_q": -0.08195272833108902, "max_q": 0.02096947468817234, "mean_td_error": -9.373470675200224e-05}}, "num_steps_sampled": 237000, "num_steps_trained": 1888032, "last_target_update_ts": 236872, "num_target_updates": 469}, "done": false, "episodes_total": 147, "training_iteration": 237, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-21-19", "timestamp": 1619875279, "time_this_iter_s": 13.043018102645874, "time_total_s": 3080.839857339859, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b1b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3080.839857339859, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 17.368421052631582, "ram_util_percent": 58.031578947368416}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9386225, "episode_len_mean": 1467.53, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9386225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0], "episode_lengths": [18, 17, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7156780727333145, "mean_raw_obs_processing_ms": 1.5877899123376287, "mean_inference_ms": 2.1708169286487733, "mean_action_processing_ms": 0.0738195286602644}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 238000, "timers": {"learn_time_ms": 18.765, "learn_throughput": 1705.303, "update_time_ms": 2.347}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.002362828701734543, "cur_lr": 0.0005, "mean_q": -0.02473841980099678, "min_q": -0.27183493971824646, "max_q": 0.02454502508044243, "mean_td_error": -0.01747201569378376}}, "num_steps_sampled": 238000, "num_steps_trained": 1896032, "last_target_update_ts": 237880, "num_target_updates": 471}, "done": false, "episodes_total": 147, "training_iteration": 238, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-21-32", "timestamp": 1619875292, "time_this_iter_s": 13.153335571289062, "time_total_s": 3093.993192911148, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b10d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3093.993192911148, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 21.742105263157892, "ram_util_percent": 57.95789473684211}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9285725, "episode_len_mean": 1510.27, "episodes_this_iter": 2, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9285725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005000000000000003, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0], "episode_lengths": [4002, 307, 17, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187], "policy_pol_reward": [0.005000000000000003, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7157668363532586, "mean_raw_obs_processing_ms": 1.5884898772643012, "mean_inference_ms": 2.1707996967740515, "mean_action_processing_ms": 0.07381682318655375}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 239000, "timers": {"learn_time_ms": 19.332, "learn_throughput": 1655.29, "update_time_ms": 2.505}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004608514718711376, "cur_lr": 0.0005, "mean_q": -0.00468180188909173, "min_q": -0.03404253348708153, "max_q": 0.024317247793078423, "mean_td_error": -0.009671458974480629}}, "num_steps_sampled": 239000, "num_steps_trained": 1904032, "last_target_update_ts": 238888, "num_target_updates": 473}, "done": false, "episodes_total": 149, "training_iteration": 239, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-21-45", "timestamp": 1619875305, "time_this_iter_s": 13.106429100036621, "time_total_s": 3107.0996220111847, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b7bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3107.0996220111847, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 19.00526315789474, "ram_util_percent": 58.04210526315789}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9285725, "episode_len_mean": 1517.98, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9285725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0], "episode_lengths": [788, 19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307], "policy_pol_reward": [-1.0, -1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7158115012782376, "mean_raw_obs_processing_ms": 1.5888379953382248, "mean_inference_ms": 2.170791563608698, "mean_action_processing_ms": 0.07381547259177808}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"learn_time_ms": 18.583, "learn_throughput": 1722.038, "update_time_ms": 2.891}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0035742444451898336, "cur_lr": 0.0005, "mean_q": -0.007162244059145451, "min_q": -0.16665343940258026, "max_q": 0.0270596444606781, "mean_td_error": -0.011559519916772842}}, "num_steps_sampled": 240000, "num_steps_trained": 1912032, "last_target_update_ts": 239896, "num_target_updates": 475}, "done": false, "episodes_total": 150, "training_iteration": 240, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-21-59", "timestamp": 1619875319, "time_this_iter_s": 13.211219310760498, "time_total_s": 3120.310841321945, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643d08>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3120.310841321945, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 17.384210526315787, "ram_util_percent": 58.03684210526315}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9285725, "episode_len_mean": 1517.98, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9285725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0], "episode_lengths": [19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7158115012782376, "mean_raw_obs_processing_ms": 1.588837995338225, "mean_inference_ms": 2.170791563608698, "mean_action_processing_ms": 0.07381547259177808}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 241000, "timers": {"learn_time_ms": 18.54, "learn_throughput": 1726.033, "update_time_ms": 2.289}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.005557992961257696, "cur_lr": 0.0005, "mean_q": -0.004742081742733717, "min_q": -0.2320006787776947, "max_q": 0.07825198769569397, "mean_td_error": 0.020383385941386223}}, "num_steps_sampled": 241000, "num_steps_trained": 1920032, "last_target_update_ts": 240904, "num_target_updates": 477}, "done": false, "episodes_total": 150, "training_iteration": 241, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-22-12", "timestamp": 1619875332, "time_this_iter_s": 13.399798154830933, "time_total_s": 3133.710639476776, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45b7048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3133.710639476776, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 19.873684210526314, "ram_util_percent": 57.95263157894736}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9285725, "episode_len_mean": 1517.98, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9285725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0], "episode_lengths": [19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7158115012782376, "mean_raw_obs_processing_ms": 1.588837995338225, "mean_inference_ms": 2.170791563608698, "mean_action_processing_ms": 0.07381547259177808}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 242000, "timers": {"learn_time_ms": 18.039, "learn_throughput": 1773.917, "update_time_ms": 2.243}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.007190650328993797, "cur_lr": 0.0005, "mean_q": -0.024612490087747574, "min_q": -0.23935872316360474, "max_q": 0.023929376155138016, "mean_td_error": -0.029985200613737106}}, "num_steps_sampled": 242000, "num_steps_trained": 1928032, "last_target_update_ts": 241912, "num_target_updates": 479}, "done": false, "episodes_total": 150, "training_iteration": 242, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-22-26", "timestamp": 1619875346, "time_this_iter_s": 13.522293090820312, "time_total_s": 3147.2329325675964, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4414971510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45c1bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3147.2329325675964, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 15.763157894736844, "ram_util_percent": 58.084210526315786}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9285725, "episode_len_mean": 1517.98, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9285725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0], "episode_lengths": [19, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788], "policy_pol_reward": [-1.0, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.7158115012782376, "mean_raw_obs_processing_ms": 1.588837995338225, "mean_inference_ms": 2.170791563608698, "mean_action_processing_ms": 0.07381547259177808}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 243000, "timers": {"learn_time_ms": 18.303, "learn_throughput": 1748.332, "update_time_ms": 2.28}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.004074013791978359, "cur_lr": 0.0005, "mean_q": -0.01862087845802307, "min_q": -0.2592753469944, "max_q": 0.02502327784895897, "mean_td_error": -0.02131558023393154}}, "num_steps_sampled": 243000, "num_steps_trained": 1936032, "last_target_update_ts": 242920, "num_target_updates": 481}, "done": false, "episodes_total": 150, "training_iteration": 243, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-22-39", "timestamp": 1619875359, "time_this_iter_s": 13.204877614974976, "time_total_s": 3160.4378101825714, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45c1b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643598>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3160.4378101825714, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 18.231578947368423, "ram_util_percent": 58.02105263157894}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9185525000000001, "episode_len_mean": 1557.81, "episodes_this_iter": 1, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9185525000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.002, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0], "episode_lengths": [4002, 17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788], "policy_pol_reward": [0.002, -1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0]}, "sampler_perf": {"mean_env_wait_ms": 1.715860832256964, "mean_raw_obs_processing_ms": 1.5891861800759093, "mean_inference_ms": 2.1707879476218412, "mean_action_processing_ms": 0.07381427166194181}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244000, "timers": {"learn_time_ms": 20.076, "learn_throughput": 1593.916, "update_time_ms": 2.479}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.00933034811168909, "cur_lr": 0.0005, "mean_q": -0.03215523809194565, "min_q": -0.24001473188400269, "max_q": 0.04019246622920036, "mean_td_error": 0.06422071158885956}}, "num_steps_sampled": 244000, "num_steps_trained": 1944032, "last_target_update_ts": 243928, "num_target_updates": 483}, "done": false, "episodes_total": 151, "training_iteration": 244, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-22-52", "timestamp": 1619875372, "time_this_iter_s": 12.761171340942383, "time_total_s": 3173.198981523514, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45c11e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a5510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3173.198981523514, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 19.299999999999997, "ram_util_percent": 57.96111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9185525000000001, "episode_len_mean": 1557.81, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9185525000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002], "episode_lengths": [17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788, 4002], "policy_pol_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002]}, "sampler_perf": {"mean_env_wait_ms": 1.715860832256964, "mean_raw_obs_processing_ms": 1.589186180075909, "mean_inference_ms": 2.1707879476218412, "mean_action_processing_ms": 0.07381427166194182}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 245000, "timers": {"learn_time_ms": 18.201, "learn_throughput": 1758.16, "update_time_ms": 2.536}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0014991984935477376, "cur_lr": 0.0005, "mean_q": -0.012572740204632282, "min_q": -0.11543646454811096, "max_q": 0.017253179103136063, "mean_td_error": -0.007783972658216953}}, "num_steps_sampled": 245000, "num_steps_trained": 1952032, "last_target_update_ts": 244936, "num_target_updates": 485}, "done": false, "episodes_total": 151, "training_iteration": 245, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-23-04", "timestamp": 1619875384, "time_this_iter_s": 12.505446910858154, "time_total_s": 3185.704428434372, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f4413be7d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45a5bf8>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3185.704428434372, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 16.47222222222222, "ram_util_percent": 58.099999999999994}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9185525000000001, "episode_len_mean": 1557.81, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9185525000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002], "episode_lengths": [17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788, 4002], "policy_pol_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002]}, "sampler_perf": {"mean_env_wait_ms": 1.715860832256964, "mean_raw_obs_processing_ms": 1.589186180075909, "mean_inference_ms": 2.1707879476218412, "mean_action_processing_ms": 0.07381427166194182}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 246000, "timers": {"learn_time_ms": 16.195, "learn_throughput": 1975.891, "update_time_ms": 2.216}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.003992566838860512, "cur_lr": 0.0005, "mean_q": -0.0247771218419075, "min_q": -0.17001751065254211, "max_q": 0.027034349739551544, "mean_td_error": 0.017791710793972015}}, "num_steps_sampled": 246000, "num_steps_trained": 1960032, "last_target_update_ts": 245944, "num_target_updates": 487}, "done": false, "episodes_total": 151, "training_iteration": 246, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-23-17", "timestamp": 1619875397, "time_this_iter_s": 12.670363664627075, "time_total_s": 3198.374792098999, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a5b70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa4643840>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3198.374792098999, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 19.02777777777778, "ram_util_percent": 58.01111111111111}, "trial_id": "dfed9_00000"}
{"episode_reward_max": 0.009500000000000007, "episode_reward_min": -1.0, "episode_reward_mean": -0.9185525000000001, "episode_len_mean": 1557.81, "episodes_this_iter": 0, "policy_reward_min": {"pol": -1.0}, "policy_reward_max": {"pol": 0.009500000000000007}, "policy_reward_mean": {"pol": -0.9185525000000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002], "episode_lengths": [17, 17, 1626, 4002, 1804, 1187, 1487, 1317, 4002, 58, 3324, 759, 1785, 2727, 2322, 18, 1066, 1989, 473, 2767, 1286, 2719, 3827, 4002, 558, 2977, 297, 3795, 195, 2314, 115, 287, 2882, 51, 787, 470, 17, 17, 860, 1648, 3300, 4002, 335, 567, 1405, 1014, 2945, 161, 867, 2164, 3611, 4002, 723, 1414, 1329, 2412, 1912, 3660, 515, 1288, 1332, 1046, 546, 2371, 741, 3594, 1113, 2116, 1580, 1393, 1838, 70, 3072, 1099, 2695, 1403, 1391, 4002, 378, 2426, 53, 18, 173, 192, 1921, 309, 1299, 60, 58, 767, 324, 1386, 142, 2855, 3255, 187, 4002, 307, 788, 4002], "policy_pol_reward": [-1.0, -1.0, -0.99725, 0.007250000000000005, -0.9975, -1.0, -0.999, -1.0, 0.0, -1.0, -0.99525, -1.0, -1.0, -0.99575, -0.9965, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -0.99525, 0.002, -1.0, -0.9985, -1.0, -0.9965, -1.0, -0.99725, -1.0, -1.0, -0.99625, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.997, -0.9945, 0.005250000000000003, -1.0, -1.0, -1.0, -1.0, -0.99775, -1.0, -1.0, -0.997, -0.99175, 0.009500000000000007, -1.0, -0.997, -0.99875, -0.999, -0.99825, -0.9955, -1.0, -1.0, -1.0, -0.998, -1.0, -0.9975, -1.0, -0.99575, -1.0, -1.0, -0.99375, -0.99875, -0.99875, -1.0, -0.99825, -1.0, -0.99825, -1.0, -1.0, 0.0015, -1.0, -0.99825, -1.0, -1.0, -1.0, -1.0, -0.9975, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.99325, -0.992, -1.0, 0.005000000000000003, -1.0, -1.0, 0.002]}, "sampler_perf": {"mean_env_wait_ms": 1.715860832256964, "mean_raw_obs_processing_ms": 1.589186180075909, "mean_inference_ms": 2.1707879476218412, "mean_action_processing_ms": 0.07381427166194182}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 247000, "timers": {"learn_time_ms": 19.34, "learn_throughput": 1654.639, "update_time_ms": 2.307}, "info": {"learner": {"pol": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016744739841669798, "cur_lr": 0.0005, "mean_q": -0.002509312005713582, "min_q": -0.05211791396141052, "max_q": 0.032591454684734344, "mean_td_error": -0.0004442729987204075}}, "num_steps_sampled": 247000, "num_steps_trained": 1968032, "last_target_update_ts": 246952, "num_target_updates": 489}, "done": false, "episodes_total": 151, "training_iteration": 247, "experiment_id": "88c2e95b72a64ddda0c4f50226ba5ef6", "date": "2021-05-01_22-23-30", "timestamp": 1619875410, "time_this_iter_s": 13.20292067527771, "time_total_s": 3211.5777127742767, "pid": 7943, "hostname": "Hinton", "node_ip": "143.248.157.211", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 32, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"agent": {"globalScaling": 1, "acc": 0.3, "max_speed": 1.5, "color": [0, 125, 0, 1]}, "target": {"globalScaling": 2, "acc": 0.2, "max_speed": 2, "color": [0, 0, 125, 1]}, "obstacle": {"globalScaling": 20, "color": [125, 125, 125, 1], "acc": 0.0001, "max_speed": 2}, "num_agents": 1, "num_obstacles": 10, "num_targets": 1, "map_size": 4, "max_timestep": 4000, "curriculum_learning": 1, "observation_range": 2, "cnn_size": 10, "phase": 4}, "env": "FollowTemplateRay", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f3aa45a5048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"pol": ["<class 'ray.rllib.policy.policy_template.DQNTorchPolicy'>", "Box(-inf, inf, (10, 10), float32)", "Discrete(5)", {}]}, "policy_mapping_fn": "<function <lambda> at 0x7f3aa45b8510>", "policies_to_train": ["pol"], "observation_fn": "<function Observation_CNN.observation_fn_3 at 0x7f44148151e0>", "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "target_network_update_freq": 500, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "final_prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "prioritized_replay_eps": 1e-06, "before_learn_on_batch": null, "training_intensity": null, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "learning_starts": 1000, "worker_side_prioritization": false}, "time_since_restore": 3211.5777127742767, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 17.036842105263162, "ram_util_percent": 58.026315789473685}, "trial_id": "dfed9_00000"}
